ANVL version 8.80.1.28 (Linux). Copyright (c) (2020) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197464 kB RAM. Free Memory 5749316 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecah ipsec-ah 1-9.1 9.3-10 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecah.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/IPSEC-AH/IPSECAHpostsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
IPSec AH Anti Replay Window Size         32                  # (0x00000020)
IPSec AH DUT Supports Configurable Lifetime True
IPSec AH SA Lifetime Seconds             120                 # (0x00000078)
IPSec AH SA Lifetime Bytes               1024                # (0x00000400)
IPSec AH DUT Supports Transport Mode     True
IPSec DUT Supports Configurable Outbound SPD True
IPSec DUT Supports Anti Replay           True
IPSec Wait Time                          10                  # (0x0000000A)
IPSec DUT Supports Configurable Inbound SPD True
IPSec DUT Supports Explicit Congestion Notification True
IPSec AH Suite Setup Command             "./DocScriptQ35/IPSEC-AH/ipsec-ah-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec AH Reset IP Security Command       "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec AH Reset SA with Anti Replay Command "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec AH Set SA Lifetime Bytes Command   "./DocScriptQ35/IPSEC-AH/ipsec-ah-set-sa-lifetime-bytes-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec AH Set SA Lifetime Seconds Command "./DocScriptQ35/IPSEC-AH/ipsec-ah-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec AH DUT Mode Configure Command      "./DocScriptQ35/IPSEC-AH/ipsec-ah-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec DUT ECN Configure Command          "./DocScriptQ35/IPSEC-AH/ipsec-dut-ecn-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Outbound SPD for ICMP Type And Code Command "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-icmp-type-and-code-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Add Outbound SPD Policy for Host Command "./DocScriptQ35/IPSEC-AH/ipsec-add-outbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec DUT Verify Audit Log for Bad SPI Command "./DocScriptQ35/IPSEC-AH/ipsec-verify-audit-bad-spi-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Inbound SPD for Protocol and Port Command "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Outbound SPD for Protocol Command "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Inbound SPD for Host Command   "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Inbound SPD for Protocol Command "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Add Inbound SPD Policy for Subnet Command "./DocScriptQ35/IPSEC-AH/ipsec-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Add Inbound SPD Policy for Host Command "./DocScriptQ35/IPSEC-AH/ipsec-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set DF Bit processing Command      "./DocScriptQ35/IPSEC-AH/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Reset DF Bit processing Command    "./DocScriptQ35/IPSEC-AH/ipsec-reset-df-bit-processing-command.exp $ANVL_DUTHOSTNAME"
IPSec DUT Send Ping Command              "./DocScriptQ35/IPSEC-AH/ipsec-dut-send-ping-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Outbound SPD for Host Command  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Add Outbound SPD Policy for Subnet Command "./DocScriptQ35/IPSEC-AH/ipsec-add-outbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Outbound SPD for Protocol and Port Command "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Remove ANVL from SA Command        "./DocScriptQ35/IPSEC-AH/ipsec-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ANVL Clear SPD Command             ""
IPSec ANVL Clear SA Command              ""
IPSec DF Bit Processing                  COPY
IPSec DUT Supports Configurable DF Bit   True
IPSec Check Mode Command                 "./DocScriptQ35/IPSEC-AH/ipsec-check-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Listen Time                          10                  # (0x0000000A)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecah.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           30.1.1.5
  IP ANVL Address                          30.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     30.1.1.255

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           40.1.1.5
  IP ANVL Address                          40.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     40.1.1.255

IPSec Interface                          eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:00:00:00:00:00
  IPSec IP Remote Host Address             30.1.1.150
  IPSec IP Local Host Address              40.1.1.150
  IPSec IP Encapsulation                   v4Ov4
  IPSec Configuration                      Manual
  IPSec IPv6 Remote Host Address           3ffe:1111::1111
  IPSec IPv6 Local Host Address            3ffe:2222::1111
  IPSec ANVL SPI                           768               # (0x00000300)
  IPSec DUT SPI                            770               # (0x00000302)
  IPSec AH Authentication Algorithm        HMAC_MD5_96
  IPSec AH Authentication Key              66306630663066306630663066302222
  IKE ISAKMP SA Encryption Algorithm       DES_CBC
  IKE ISAKMP SA Hashing Algorithm          MD5
  IKE ISAKMP SA Authentication Method      PRESHARED_KEY
  IKE ISAKMP SA Group Description          MODP768
  IKE IPSec SA Transform ID                AH_MD5
  IKE IPSec SA Group Description           MODP1024
  IKE IPSec SA Authentication Algorithm    HMAC_MD5
  IKE Pre-Shared Key                       abcdefghijklmnopqrstuvwx

# Configuration File End.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet.AcceptSourceRoute "1"
sysvar: ipnet.inet.AcceptSourceRoute=1 ok
-> cmd ipd kill iprip
ipd: kill iprip ok
-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet add 30.1.1.5 netmask 255.255.255.0 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet add 40.1.1.5 netmask 255.255.255.0 up
-> cmd ifconfig -a
lo0	Link type:Local loopback
	inet 127.0.0.1  mask 255.255.255.255
	inet6 unicast fe80::1%lo0  prefixlen 64  automatic
	inet6 unicast ::1  prefixlen 128
	UP RUNNING LOOPBACK MULTICAST NOARP ALLMULTI 
	MTU:1500  metric:1  VR:0  ifindex:1
	RX packets:439873 mcast:3395 errors:0 dropped:0
	TX packets:439873 mcast:3395 errors:0
	collisions:0 unsupported proto:0
	RX bytes:32447537 (32 M)  TX bytes:32447537 (32 M)

gei2	Link type:Ethernet  HWaddr 00:25:90:04:e2:de
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet 128.224.166.238  mask 255.255.254.0  broadcast 128.224.167.255
	inet6 unicast fe80::225:90ff:fe04:e2de%gei2  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:2
	RX packets:668747 mcast:21910 errors:0 dropped:2057
	TX packets:28058 mcast:1126 errors:0
	collisions:0 unsupported proto:0
	RX bytes:49653904 (49 M)  TX bytes:2589648 (2589 k)

gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  tentative  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:31
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:1 mcast:1 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:90

gei1	Link type:Ethernet  HWaddr 00:15:17:c8:90:29
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9029%gei1  prefixlen 64  tentative  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1300  metric:1  VR:0  ifindex:32
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:1 mcast:1 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:90

-> exit
Au revoir!
Connection closed by foreign host.
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5


! Couldn't find DUT at 30.1.1.5
! Some tests may fail because of this
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BB ARP Req 40.1.1.5

FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BB ARP Req 40.1.1.5

00:1B:21:7D:57:BB < 00:15:17:C8:90:29 ARP Rsp 40.1.1.150

Device Under Test found at 40.1.1.5 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite IPSec Authentication Header
RFC 4301: 'Security Architecture for the Internet Protocol'
(S. Ken BBN Corp, December 2005)
RFC 4302: 'IP Authentication Header'
(S. Ken BBN Corp, December 2005)

ANVL Test Suite Required Setup:
This suite expects to be running against an IPSec gateway. The
testing requires that the ANVL machine is connected to two
interfaces that are connected to the Device Under Test.

The ANVL config file must define 2 IP interfaces
with an IPSec interface configured on one of the 2 ports.
The DUT should be configured exactly as it is indicated in the
configuration file. There are a number of parameters
controlling this suite that need to be setup for a completely
automated run.


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IPSEC-AH-1.1
TEST_DESCRIPTION
IPSec MUST accept properly authenticated incoming IP datagrams
TEST_REFERENCE
RFC 4302 s3.4.4 p20 Integrity Check Value Verification
TEST_METHOD
- ANVL: Send an authenticated ICMP Echo-request from Remote Host
-  DUT: Forward the corresponding plain ICMP Echo-request (unsecured)
        to the Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=2  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=3  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=4  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=5  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[4] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[5] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[3] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[6] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0003 (3)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3BD4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 30 49 76 80 26 3D D0 DB 24 76 58 2A               0Iv.&=..$vX*
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0001 (1)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDF9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0001 (1)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0001 (1)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x32A3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDF9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0001 (1)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received expected IP packet on interface eth4 (40.1.1.150)
(Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-1.1: Passed

>> IPSEC-AH-1.2
TEST_DESCRIPTION
IPSec MUST discard an incoming IP datagram with an incorrect ICV 
in the AH
TEST_REFERENCE
NEGATIVE: RFC 4302 s3.4.4 p20 Integrity Check Value Verification
TEST_METHOD
- ANVL: Send an authenticated ICMP Echo-request containing an
        incorrectly computed ICV in the AH from Remote Host
-  DUT: Do not forward any ICMP Echo-request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=6  pid=0x1014a30
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=7  pid=0x1014a30
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=8  pid=0x1014a30
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=9  pid=0x1014a30
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=10  pid=0x1014a30
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[8] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[9] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[7] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[10] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0006 (6)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3BD1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 00 FB 59 06 7D FD 02 E9 24 C4 51 36               ..Y.}...$.Q6
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0004 (4)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDF8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0002 (2)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150)(Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-1.2: Passed

>> IPSEC-AH-1.3
TEST_DESCRIPTION
The Reserved field of the AH MUST be set to "zero." 
by the sender, and it SHOULD be ignored by the recipient.(Note that the value is included in the Authentication Data
calculation, but is otherwise ignored by the recipient.)
This test checks that DUT ignores the Reserved field
and accepts the packet
TEST_REFERENCE
RFC 4302 s2.3 p6 Reserved 
TEST_METHOD
- ANVL: Send an authenticated ICMP Echo-request containing a
        non-zero value in the Reserved field of the AH from
        Remote Host
-  DUT: Ignore the Reserved field of the AH
-  DUT: Forward the corresponding plain ICMP Echo-request (unsecured)
        to the Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=11  pid=0x1014a30
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=12  pid=0x1014a30
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=13  pid=0x1014a30
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=14  pid=0x1014a30
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=15  pid=0x1014a30
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[12] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[13] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[11] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[14] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0009 (9)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3BCE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 4 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7D 18 0E 75 B4 49 1A 91 90 E6 CC 35               }..u.I.....5
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0007 (7)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x319D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDF7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0003 (3)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0007 (7)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x329D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDF7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0003 (3)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT correctly forwarded unauthenticated ICMP Echo Request packet
on interface eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-1.3: Passed

>> IPSEC-AH-1.4
TEST_DESCRIPTION
IPSec MUST discard an incoming IPv4 datagram if the Protocol
field of the IPv4 header contains a value other than AH (51)
TEST_REFERENCE
NEGATIVE: RFC 4302 s2 p4 Authentication Header Format
TEST_METHOD
- ANVL: Send an authenticated ICMP Echo-request containing the value
        <proto> in the Protocol field of the IPv4 header from Remote
        Host
-  DUT: Do not forward the ICMP Echo-request to Local Host
- CASE: <proto> = 50
- CASE: <proto> = 52
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=16  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=17  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=18  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=19  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=20  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[16] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[17] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[15] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[18] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 1: set the Protocol 50 in Outer IP
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x000C (12)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BCC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x04040000 
ESP: Sequence Number          = 0x00000300 
ESP:
ESP: --- Bad Encrypted Payload Data [48 bytes] ---
ESP:  00 00 00 04 F6 92 6B 0E 93 06 01 86 E0 BB 38 2E   ......k.......8.
ESP:  45 00 00 2C 00 0A 00 00 40 01 31 9A 1E 01 01 96   E..,....@.1.....
ESP:  28 01 01 96 08 00 ED F6 00 04 00 00 41 4E 56 4C   (...........ANVL
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  20 54 45 53 54 20 44 41 54 41 20 20                TEST DATA  
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IP Packet
Case 1: Correctly, did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)


Case 2: set the Protocol 52 in Outer IP
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x000F (15)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = *UNKNOWN* (52)
IP: Header Checksum        = 0x3BC7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
IP: --- Trailing Data [68 bytes] ---
IP:  04 04 00 00 00 00 03 00 00 00 00 05 8C 92 60 3D   ..............`=
IP:  19 CE 54 49 0F 3F C8 8C 45 00 00 2C 00 0D 00 00   ..TI.?..E..,....
IP:  40 01 31 97 1E 01 01 96 28 01 01 96 08 00 ED F5   @.1.....(.......
IP:  00 05 00 00 41 4E 56 4C 20 54 45 53 54 20 44 41   ....ANVL TEST DA
IP:  54 41 20 20                                       TA  
IP: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IP Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 116 bytes
IP: Identification         = 0x8620 (34336)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xB5C6 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 3 (Destination Unreachable)
ICMP: Code             = 2 (Protocol Unreachable)
ICMP: Checksum         = 0xC341 (Correct)
ICMP:
ICMP: ---- ICMP Data ----
ICMP:
ICMP: Unused           = 0x00000000
ICMP:
ICMP: IP: ---- IP Packet ----
ICMP: IP:
ICMP: IP: Version                = 4
ICMP: IP: Internet Header Length = 5 (20 bytes)
ICMP: IP: Type Of Service        = 0x00
ICMP: IP:  |01234567
ICMP: IP:  |000.....             = Precedence (Routine)
ICMP: IP:  |...0....             = Normal Delay
ICMP: IP:  |....0...             = Normal Throughput
ICMP: IP:  |.....0..             = Normal Reliability
ICMP: IP:  |......0.             = Normal Monetary Cost
ICMP: IP:  |.......0             = Must Be Zero 
ICMP: IP: Total Length           = 88 bytes
ICMP: IP: Identification         = 0x000F (15)
ICMP: IP: Flags                  = 0
ICMP: IP:  |012
ICMP: IP:  |0..                  = Reserved 
ICMP: IP:  |.0.                  = May Fragment
ICMP: IP:  |..0                  = Last Fragment
ICMP: IP: Fragment Offset        = 0x0000 (0 bytes)
ICMP: IP: Time to Live           = 64
ICMP: IP: Protocol               = *UNKNOWN* (52)
ICMP: IP: Header Checksum        = 0x3BC7 (Correct)
ICMP: IP: Source Address         = 30.1.1.150
ICMP: IP: Destination Address    = 30.1.1.5
ICMP: IP:
ICMP: IP: ---- End of IP Header ----
ICMP: IP:
ICMP: IP: --- 64 bits of datagram [8 bytes] ---
ICMP: IP:  04 04 00 00 00 00 03 00                           ........
ICMP: IP: --- 64 bits of datagram End ---
ICMP: --- Trailing Data [60 bytes] ---
ICMP:  00 00 00 05 8C 92 60 3D 19 CE 54 49 0F 3F C8 8C   ......`=..TI.?..
ICMP:  45 00 00 2C 00 0D 00 00 40 01 31 97 1E 01 01 96   E..,....@.1.....
ICMP:  28 01 01 96 08 00 ED F5 00 05 00 00 41 4E 56 4C   (...........ANVL
ICMP:  20 54 45 53 54 20 44 41 54 41 20 20                TEST DATA  
ICMP: --- Trailing Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Case 2: Correctly, did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-1.4: Passed

>> IPSEC-AH-1.5
TEST_DESCRIPTION
IPSec MUST discard an incoming IP datagram containing a Payload Length
other than 4 in the AH, in an example case of 96 bit
authentication value plus the 3 32-bit word fixed portion for any
non-null authentication algorithm
TEST_REFERENCE
NEGATIVE: RFC 4302 s2.2 p5 Payload Length
TEST_METHOD
- ANVL: Send an authenticated ICMP Echo-request containing the value
        <length> in the Payload Length field of the AH from Remote
        Host
-  DUT: Do not forward the ICMP Echo-request to Local Host
- CASE: <length> = 0
- CASE: <length> = 1
- CASE: <length> = 2
- CASE: <length> = 3
- CASE: <length> = 5
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=21  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=22  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=23  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=24  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=25  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[20] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[21] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[19] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[22] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 1: set Payload Length to 0 in AH
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0012 (18)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3BC5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 0 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000006 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C7 DE AB DE 65 A7 C6 A4 90 68 70 AC               ....e....hp.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 0
IP: Internet Header Length = 0 (0 bytes *Should be >= 20*)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 6 bytes (*Should be >= 20*)
IP: Identification         = 0xC7DE (51166)
IP: Flags                  = 5
IP:  |012
IP:  |1..                  = Reserved (*Should be 0*)
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0BDE (24304 bytes)
IP: Time to Live           = 101
IP: Protocol               = *UNKNOWN* (167)
IP: Header Checksum        = 0xC6A4 *Should be 0xFFFF*
IP: Source Address         = 144.104.112.172
IP: Destination Address    = 69.0.0.44
IP:

Waiting (up to 10.000 seconds) for IP Packet
Case 1: Correctly, did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)


Case 2: set Payload Length to 1 in AH
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0015 (21)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3BC2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 1 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: CD 7D 29 EA AF 4F 11 5B CB 21 8D 0D               .})..O.[.!..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 12
IP: Internet Header Length = 13 (52 bytes)
IP: Type Of Service        = 0x7D
IP:  |01234567
IP:  |011.....             = Precedence (Flash)
IP:  |...1....             = Low Delay
IP:  |....1...             = High Throughput
IP:  |.....1..             = High Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......1             = Must Be Zero (*Should be 0*)
IP: Total Length           = 10730 bytes
IP: Identification         = 0xAF4F (44879)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x115B (35544 bytes)
IP: Time to Live           = 203
IP: Protocol               = *UNKNOWN* (33)
IP: Header Checksum        = 0x8D0D *Should be 0xF12C*
IP: Source Address         = 69.0.0.44
IP: Destination Address    = 0.19.0.0
IP: --- Padding [32 bytes] ---
IP:  40 01 31 91 1E 01 01 96 28 01 01 96 08 00 ED F3   @.1.....(.......
IP:  00 07 00 00 41 4E 56 4C 20 54 45 53 54 20 44 41   ....ANVL TEST DA
IP:
IP: --- Trailing Data [4 bytes] ---
IP:  54 41 20 20                                       TA  
IP: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IP Packet
Case 2: Correctly, did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)


Case 3: set Payload Length to 2 in AH
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0018 (24)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3BBF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 2 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8F 31 E3 96 8A BE CA 76 49 E3 72 8D               .1.....vI.r.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 8
IP: Internet Header Length = 10 (40 bytes)
IP: Type Of Service        = 0xBE
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...1....             = Low Delay
IP:  |....1...             = High Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 51830 bytes
IP: Identification         = 0x49E3 (18915)
IP: Flags                  = 3
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x128D (37992 bytes)
IP: Time to Live           = 69
IP: Protocol               = *UNKNOWN* (0)
IP: Header Checksum        = 0x002C *Should be 0x60F0*
IP: Source Address         = 0.22.0.0
IP: Destination Address    = 64.1.49.142
IP: --- Padding [20 bytes] ---
IP:  1E 01 01 96 28 01 01 96 08 00 ED F2 00 08 00 00   ....(...........
IP:  41 4E 56 4C                                       ANVL
IP:
IP: --- Trailing Data [12 bytes] ---
IP:  20 54 45 53 54 20 44 41 54 41 20 20                TEST DATA  
IP: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IP Packet
Case 3: Correctly, did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)


Case 4: set Payload Length to 3 in AH
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x001B (27)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3BBC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 3 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000009 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 24 00 0F ED 8D 4B 18 20 7E 15 7F F8               $....K. ~...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 7
IP: Internet Header Length = 14 (56 bytes)
IP: Type Of Service        = 0x15
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...1....             = Low Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......1             = Must Be Zero (*Should be 0*)
IP: Total Length           = 32760 bytes
IP: Identification         = 0x4500 (17664)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x002C (352 bytes)
IP: Time to Live           = 0
IP: Protocol               = *UNKNOWN* (25)
IP: Header Checksum        = 0x0000 *Should be 0x01F2*
IP: Source Address         = 64.1.49.139
IP: Destination Address    = 30.1.1.150
IP: --- Padding [36 bytes] ---
IP:  28 01 01 96 08 00 ED F1 00 09 00 00 41 4E 56 4C   (...........ANVL
IP:  20 54 45 53 54 20 44 41 54 41 20 20 00 00 00 00    TEST DATA  ....
IP:  00 00 00 00                                       ....
IP:
IP: --- Trailing Data [32704 bytes] ---
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 4F 70 65 72 61 74 69 6F 6E 20 6E 6F 74 20   ..Operation not 
IP:  70 65 72 6D 69 74 74 65 64 00 00 00 00 00 00 00   permitted.......
IP:  00 00 4E 6F 20 73 75 63 68 20 66 69 6C 65 20 6F   ..No such file o
IP:  72 20 64 69 72 65 63 74 6F 72 79 00 00 00 00 00   r directory.....
IP:  00 00 4E 6F 20 73 75 63 68 20 70 72 6F 63 65 73   ..No such proces
IP:  73 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   s...............
IP:  00 00 49 6E 74 65 72 72 75 70 74 65 64 20 73 79   ..Interrupted sy
IP:  73 74 65 6D 20 63 61 6C 6C 00 00 00 00 00 00 00   stem call.......
IP:  00 00 49 6E 70 75 74 2F 6F 75 74 70 75 74 20 65   ..Input/output e
IP:  72 72 6F 72 00 00 00 00 00 00 00 00 00 00 00 00   rror............
IP:  00 00 4E 6F 20 73 75 63 68 20 64 65 76 69 63 65   ..No such device
IP:  20 6F 72 20 61 64 64 72 65 73 73 00 00 00 00 00    or address.....
IP:  00 00 41 72 67 75 6D 65 6E 74 20 6C 69 73 74 20   ..Argument list 
IP:  74 6F 6F 20 6C 6F 6E 67 00 00 00 00 00 00 00 00   too long........
IP:  00 00 45 78 65 63 20 66 6F 72 6D 61 74 20 65 72   ..Exec format er
IP:  72 6F 72 00 00 00 00 00 00 00 00 00 00 00 00 00   ror.............
IP:  00 00 42 61 64 20 66 69 6C 65 20 64 65 73 63 72   ..Bad file descr
IP:  69 70 74 6F 72 00 00 00 00 00 00 00 00 00 00 00   iptor...........
IP:  00 00 4E 6F 20 63 68 69 6C 64 20 70 72 6F 63 65   ..No child proce
IP:  73 73 65 73 00 00 00 00 00 00 00 00 00 00 00 00   sses............
IP:  00 00 52 65 73 6F 75 72 63 65 20 74 65 6D 70 6F   ..Resource tempo
IP:  72 61 72 69 6C 79 20 75 6E 61 76 61 69 6C 61 62   rarily unavailab
IP:  6C 00 43 61 6E 6E 6F 74 20 61 6C 6C 6F 63 61 74   l.Cannot allocat
IP:  65 20 6D 65 6D 6F 72 79 00 00 00 00 00 00 00 00   e memory........
IP:  00 00 50 65 72 6D 69 73 73 69 6F 6E 20 64 65 6E   ..Permission den
IP:  69 65 64 00 00 00 00 00 00 00 00 00 00 00 00 00   ied.............
IP:  00 00 42 61 64 20 61 64 64 72 65 73 73 00 00 00   ..Bad address...
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 42 6C 6F 63 6B 20 64 65 76 69 63 65 20 72   ..Block device r
IP:  65 71 75 69 72 65 64 00 00 00 00 00 00 00 00 00   equired.........
IP:  00 00 44 65 76 69 63 65 20 6F 72 20 72 65 73 6F   ..Device or reso
IP:  75 72 63 65 20 62 75 73 79 00 00 00 00 00 00 00   urce busy.......
IP:  00 00 46 69 6C 65 20 65 78 69 73 74 73 00 00 00   ..File exists...
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 49 6E 76 61 6C 69 64 20 63 72 6F 73 73 2D   ..Invalid cross-
IP:  64 65 76 69 63 65 20 6C 69 6E 6B 00 00 00 00 00   device link.....
IP:  00 00 4E 6F 20 73 75 63 68 20 64 65 76 69 63 65   ..No such device
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 4E 6F 74 20 61 20 64 69 72 65 63 74 6F 72   ..Not a director
IP:  79 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   y...............
IP:  00 00 49 73 20 61 20 64 69 72 65 63 74 6F 72 79   ..Is a directory
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 49 6E 76 61 6C 69 64 20 61 72 67 75 6D 65   ..Invalid argume
IP:  6E 74 00 00 00 00 00 00 00 00 00 00 00 00 00 00   nt..............
IP:  00 00 54 6F 6F 20 6D 61 6E 79 20 6F 70 65 6E 20   ..Too many open 
IP:  66 69 6C 65 73 20 69 6E 20 73 79 73 74 65 6D 00   files in system.
IP:  00 00 54 6F 6F 20 6D 61 6E 79 20 6F 70 65 6E 20   ..Too many open 
IP:  66 69 6C 65 73 00 00 00 00 00 00 00 00 00 00 00   files...........
IP:  00 00 49 6E 61 70 70 72 6F 70 72 69 61 74 65 20   ..Inappropriate 
IP:  69 6F 63 74 6C 20 66 6F 72 20 64 65 76 69 63 65   ioctl for device
IP:  00 00 54 65 78 74 20 66 69 6C 65 20 62 75 73 79   ..Text file busy
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 46 69 6C 65 20 74 6F 6F 20 6C 61 72 67 65   ..File too large
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 4E 6F 20 73 70 61 63 65 20 6C 65 66 74 20   ..No space left 
IP:  6F 6E 20 64 65 76 69 63 65 00 00 00 00 00 00 00   on device.......
IP:  00 00 49 6C 6C 65 67 61 6C 20 73 65 65 6B 00 00   ..Illegal seek..
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 52 65 61 64 2D 6F 6E 6C 79 20 66 69 6C 65   ..Read-only file
IP:  20 73 79 73 74 65 6D 00 00 00 00 00 00 00 00 00    system.........
IP:  00 00 54 6F 6F 20 6D 61 6E 79 20 6C 69 6E 6B 73   ..Too many links
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 42 72 6F 6B 65 6E 20 70 69 70 65 00 00 00   ..Broken pipe...
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 4E 75 6D 65 72 69 63 61 6C 20 61 72 67 75   ..Numerical argu
IP:  6D 65 6E 74 20 6F 75 74 20 6F 66 20 64 6F 6D 61   ment out of doma
IP:  69 00 4E 75 6D 65 72 69 63 61 6C 20 72 65 73 75   i.Numerical resu
IP:  6C 74 20 6F 75 74 20 6F 66 20 72 61 6E 67 65 00   lt out of range.
IP:  00 00 52 65 73 6F 75 72 63 65 20 64 65 61 64 6C   ..Resource deadl
IP:  6F 63 6B 20 61 76 6F 69 64 65 64 00 00 00 00 00   ock avoided.....
IP:  00 00 46 69 6C 65 20 6E 61 6D 65 20 74 6F 6F 20   ..File name too 
IP:  6C 6F 6E 67 00 00 00 00 00 00 00 00 00 00 00 00   long............
IP:  00 00 4E 6F 20 6C 6F 63 6B 73 20 61 76 61 69 6C   ..No locks avail
IP:  61 62 6C 65 00 00 00 00 00 00 00 00 00 00 00 00   able............
IP:  00 00 46 75 6E 63 74 69 6F 6E 20 6E 6F 74 20 69   ..Function not i
IP:  6D 70 6C 65 6D 65 6E 74 65 64 00 00 00 00 00 00   mplemented......
IP:  00 00 44 69 72 65 63 74 6F 72 79 20 6E 6F 74 20   ..Directory not 
IP:  65 6D 70 74 79 00 00 00 00 00 00 00 00 00 00 00   empty...........
IP:  00 00 54 6F 6F 20 6D 61 6E 79 20 6C 65 76 65 6C   ..Too many level
IP:  73 20 6F 66 20 73 79 6D 62 6F 6C 69 63 20 6C 69   s of symbolic li
IP:  6E 00 55 6E 6B 6E 6F 77 6E 20 65 72 72 6F 72 20   n.Unknown error 
IP:  34 31 00 00 00 00 00 00 00 00 00 00 00 00 00 00   41..............
IP:  00 00 4E 6F 20 6D 65 73 73 61 67 65 20 6F 66 20   ..No message of 
IP:  64 65 73 69 72 65 64 20 74 79 70 65 00 00 00 00   desired type....
IP:  00 00 49 64 65 6E 74 69 66 69 65 72 20 72 65 6D   ..Identifier rem
IP:  6F 76 65 64 00 00 00 00 00 00 00 00 00 00 00 00   oved............
IP:  00 00 43 68 61 6E 6E 65 6C 20 6E 75 6D 62 65 72   ..Channel number
IP:  20 6F 75 74 20 6F 66 20 72 61 6E 67 65 00 00 00    out of range...
IP:  00 00 4C 65 76 65 6C 20 32 20 6E 6F 74 20 73 79   ..Level 2 not sy
IP:  6E 63 68 72 6F 6E 69 7A 65 64 00 00 00 00 00 00   nchronized......
IP:  00 00 4C 65 76 65 6C 20 33 20 68 61 6C 74 65 64   ..Level 3 halted
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 4C 65 76 65 6C 20 33 20 72 65 73 65 74 00   ..Level 3 reset.
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 4C 69 6E 6B 20 6E 75 6D 62 65 72 20 6F 75   ..Link number ou
IP:  74 20 6F 66 20 72 61 6E 67 65 00 00 00 00 00 00   t of range......
IP:  00 00 50 72 6F 74 6F 63 6F 6C 20 64 72 69 76 65   ..Protocol drive
IP:  72 20 6E 6F 74 20 61 74 74 61 63 68 65 64 00 00   r not attached..
IP:  00 00 4E 6F 20 43 53 49 20 73 74 72 75 63 74 75   ..No CSI structu
IP:  72 65 20 61 76 61 69 6C 61 62 6C 65 00 00 00 00   re available....
IP:  00 00 4C 65 76 65 6C 20 32 20 68 61 6C 74 65 64   ..Level 2 halted
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 49 6E 76 61 6C 69 64 20 65 78 63 68 61 6E   ..Invalid exchan
IP:  67 65 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ge..............
IP:  00 00 49 6E 76 61 6C 69 64 20 72 65 71 75 65 73   ..Invalid reques
IP:  74 20 64 65 73 63 72 69 70 74 6F 72 00 00 00 00   t descriptor....
IP:  00 00 45 78 63 68 61 6E 67 65 20 66 75 6C 6C 00   ..Exchange full.
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 4E 6F 20 61 6E 6F 64 65 00 00 00 00 00 00   ..No anode......
IP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
IP:  00 00 49 6E 76 61 6C 69 64 20 72 65 71 75 65 73   ..Invalid reques
IP: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IP Packet
Case 4: Correctly, did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)


Case 5: set Payload Length to 5 in AH
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x001E (30)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3BB9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 5 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 4F A3 5E C7 DA 63 FD 80 E2 24 FD 46               O.^..c...$.F
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 0
IP: Internet Header Length = 0 (0 bytes *Should be >= 20*)
IP: Type Of Service        = 0x1C
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...1....             = Low Delay
IP:  |....1...             = High Throughput
IP:  |.....1..             = High Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 0 bytes (*Should be >= 20*)
IP: Identification         = 0x4001 (16385)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x1188 (35904 bytes)
IP: Time to Live           = 30
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0196 *Should be 0xFFFF*
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 8.0.237.240
IP:

Waiting (up to 10.000 seconds) for IP Packet
Case 5: Correctly, did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-1.5: Passed

>> IPSEC-AH-2.1
TEST_DESCRIPTION
IPSec MUST set the Protocol field of the IP header to the
value AH (51) in an authenticated outbound IPv4 datagram
TEST_REFERENCE
RFC 4302 s2 p4 Authentication Header Format
TEST_METHOD
- ANVL: Send an ICMP Echo request from Local Host 
-  DUT: Forward the corresponding authenticated ICMP Echo-request
        containing the value AH(51) in the Protocol field of the IPv4
        datagram to Remote Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=26  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=27  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=28  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=29  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=30  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[24] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[25] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[23] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[26] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x001F (31)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3185 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDEF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000B (11)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xD306 (54022)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x69D0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D9 13 73 F5 27 2A D1 0E EB 7E 7B 13               ..s.'*...~{.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x001F (31)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3285 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDEF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000B (11)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received IP packet with in outer IP protocol: 51
on interface eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-2.1: Passed

>> IPSEC-AH-2.4
TEST_DESCRIPTION
IPSec MUST indicate the correct type of payload in the Next Header
field of the AH in an authenticated outbound IP datagram
TEST_REFERENCE
RFC 4302 s2.1 p5 Next Header
TEST_METHOD
- ANVL: Send an IP datagram containing a payload of type <payld>
        from Local Host through the DUT to Remote Host
-  DUT: Forward the authenticated IP datagram to Remote Host ,
        setting the Next Header field in the AH to the value IP and
        the Protocol field in the inner IP header to <payld>
- CASE: <payld> = ICMP
- CASE: <payld> = TCP
- CASE: <payld> = UDP
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=31  pid=0x1014a30
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=32  pid=0x1014a30
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=33  pid=0x1014a30
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=34  pid=0x1014a30
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=35  pid=0x1014a30
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[28] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[29] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[27] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[30] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 1: sending ICMP packet
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0020 (32)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3184 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDEE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000C (12)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xCC80 (52352)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x7056 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B7 9F D3 DA 27 CF D3 EC E7 2B C2 AE               ....'....+..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0020 (32)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3284 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDEE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000C (12)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Case 1: Correct inner IP Protocol: 1 received on intefcace eth3 (30.1.1.150)
(Remote Host)


Case 2: sending TCP packet
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0021 (33)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x3182 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x229A (8858)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x1A41 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 1D 9C 84 3E 3D 41 0F D9 C3 C8 2F 37               ...>=A..../7
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0021 (33)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x3282 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Case 2: Correct inner IP Protocol: 6 received on intefcace eth3 (30.1.1.150)
(Remote Host)


Case 3: sending UDP packet
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0022 (34)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3182 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x4A56 (19030)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xF290 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 4D 69 28 8C 80 75 56 CF 76 F2 86 76               Mi(..uV.v..v
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0022 (34)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3282 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Case 3: Correct inner IP Protocol: 17 received on intefcace eth3 (30.1.1.150)
(Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-2.4: Passed

>> IPSEC-AH-2.5
TEST_DESCRIPTION
IPSec MUST set the Payload Length field in the AH to the value 4
in an authenticated outbound IP datagram, in case
of 96 bit authentication value plus the 3 32-bit word fixed portion
for any non-null authentication algorithm
TEST_REFERENCE
RFC 4302 s2.2 p5 Payload Length
TEST_METHOD
- ANVL: Send an ICMP Echo-request from Local Host through the DUT
        to Remote Host
-  DUT: Forward the IP datagram with authentication to Remote Host,
        setting the Payload Length field in the AH to the value 4
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=36  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=37  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=38  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=39  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=40  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[32] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[33] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[31] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[34] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0023 (35)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3181 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDED (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000D (13)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x21F5 (8693)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x1AE2 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D5 F5 8E 53 50 47 B9 36 1A 3D 10 A7               ...SPG.6.=..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0023 (35)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3281 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDED (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000D (13)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received AH payload length: 4
on interface eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-2.5: Passed

>> IPSEC-AH-2.6
TEST_DESCRIPTION
IPSec MUST set the Reserved field in the AH to the value 0 in an
authenticated outbound IP datagram
TEST_REFERENCE
RFC 4302 s2.3 p6 Reserved
TEST_METHOD
- ANVL: Send an ICMP Echo-request from Local Host through the DUT
        to Remote Host
-  DUT: Forward the IP datagram with authentication to Remote Host,
        setting the Reserved field in the AH to the value 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=41  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=42  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=43  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=44  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=45  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[36] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[37] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[35] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[38] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0024 (36)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3180 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDEC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000E (14)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x497E (18814)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xF358 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F3 B4 A6 8F 8A 02 83 7C 4F 1A 13 5E               .......|O..^
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0024 (36)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3280 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDEC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000E (14)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correct received AH reserved field: 0
on interface
eth3 (30.1.1.150)  (Remote Host) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-2.6: Passed

>> IPSEC-AH-2.7
TEST_DESCRIPTION
IPSec MUST set the SPI field in the AH of an authenticated outbound IP
datagram to the SPI value associated with the outbound SA
TEST_REFERENCE
RFC 4302 s2.4 p6 Security Parameter Index (SPI)
TEST_METHOD
- ANVL: Send an ICMP Echo-request from Local Host through the DUT
        to Remote Host
-  DUT: Forward the IP datagram to Remote with authentication,
        setting the SPI field in the AH to the SPI value associated
        the outbound SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=46  pid=0xf0d020
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=47  pid=0xf0d020
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=48  pid=0xf0d020
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=49  pid=0xf0d020
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=50  pid=0xf0d020
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[40] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[41] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[39] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[42] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0025 (37)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x317F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDEB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000F (15)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x55C4 (21956)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xE712 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3F A3 40 BA 2A 9D EC 65 F6 04 54 F5               ?.@.*..e..T.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0025 (37)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x327F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDEB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000F (15)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received AH spi value: 770
on interface eth3 (30.1.1.150)  (Remote Host) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-2.7: Passed

>> IPSEC-AH-2.8
TEST_DESCRIPTION
IPSec MUST set the Sequence Number field in the AH to the value 1
in the first authenticated outbound IP datagram
TEST_REFERENCE
RFC 4302 s2.5 p8 Sequence Number
TEST_METHOD
- ANVL: Reset the SA between ANVL and DUT
- ANVL: Send an ICMP Echo-request from Local Host through the DUT
        to Remote Host
-  DUT: Forward the IP datagram with authentication to RemoteHost,
        setting the Sequence Number field in the AH to 1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=51  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=52  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=53  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=54  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=55  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[44] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[45] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[43] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[46] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0026 (38)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x317E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDEA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0010 (16)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x3A9C (15004)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x023B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 93 09 BE 0B 13 83 8F 30 D9 B6 7D 4B               .......0..}K
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0026 (38)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x327E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDEA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0010 (16)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received AH sequence number: 1
in the first authenticated outbound IP datagram)
on interface eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-2.8: Passed

>> IPSEC-AH-2.9
TEST_DESCRIPTION
The TTL in the inner header is decremented by the encapsulator prior to 
forwarding and by the decapsulator if it forards the packet. The 
IPv4 checksum changes when the TTL changes.
TEST_REFERENCE
RFC 4301 s5.1.2.1 p57 IPv4 - Header Construction for Tunnel mode
TEST_METHOD
- ANVL: Send an ICMP Echo-request from Local Host to Remote Host
        through the DUT
-  DUT: Forward the IP datagram to Remote Host, decrementing the
        TTL field in the inner IP header and recomputing the checksum
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=56  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=57  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=58  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=59  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=60  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[48] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[49] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[47] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[50] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0027 (39)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x317D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0011 (17)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x4BC1 (19393)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xF115 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: DD CE B1 A2 8E 68 EF DA 7F CE 84 69               .....h.....i
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0027 (39)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x327D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0011 (17)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received inner IP packet Time to Live field: 63
on interface eth3 (30.1.1.150)  (Remote Host)
Received checksum value of the inner IP packet is correct

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-2.9: Passed

>> IPSEC-AH-2.10
TEST_DESCRIPTION
IPSec on a security gateway MUST set, clear or copy the DF bit flag in
the outer IP header as per its configuration
TEST_REFERENCE
RFC 4301 s5.1.2.1 p58 IPv4 - Header Construction for Tunnel mode
TEST_METHOD
- ANVL: Send an ICMP Echo-request from Local Host through the DUT
        Remote Host, with the DF bit in the inner IP header set
        to <DF>
-  DUT: Forward the IP datagram to Remote Host, and set
        the DF bit flag in the outer IP header to <DF_SETTING>
- CASE: <DF> = 0 and <DF_SETTING> = set
- CASE: <DF> = 0 and <DF_SETTING> = clear
- CASE: <DF> = 0 and <DF_SETTING> = copy
- CASE: <DF> = 1 and <DF_SETTING> = set
- CASE: <DF> = 1 and <DF_SETTING> = clear
- CASE: <DF> = 1 and <DF_SETTING> = copy
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=61  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=62  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=63  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=64  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=65  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[52] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[53] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[51] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[54] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 1: Send a plain IP packet with DF bit set to 0
and DUT is configured to set the DF-Bit in the outer IP header to SET

Configuring IPSec on DUT to set policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=66  pid=0x101c020
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -setdf
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=67  pid=0x101c020
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel setdf 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=68  pid=0x101c020
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -setdf
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=69  pid=0x101c020
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel ingress setdf 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0  -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=70  pid=0x101c020
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0028 (40)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x317C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0012 (18)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xC04C (49228)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3C8A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 79 46 1C C3 E1 19 FD 77 96 08 27 B4               yF.....w..'.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0028 (40)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x327C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0012 (18)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Received expected DF bit in the outer IP Flag field: 1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=71  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=72  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=73  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=74  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=75  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[60] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[61] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[59] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[62] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 2: Send a plain IP packet with DF bit set to 0
and DUT is configured to set the DF-Bit in the outer IP header to CLEAR

Configuring IPSec on DUT to set policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=76  pid=0x10749d0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -clrdf
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=77  pid=0x10749d0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel clrdf 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=78  pid=0x10749d0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -clrdf
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=79  pid=0x10749d0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel ingress clrdf 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0  -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=80  pid=0x10749d0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0029 (41)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x317B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0013 (19)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x8692 (34450)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xB644 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: E4 63 FF 78 00 51 4A 34 C1 B5 D6 87               .c.x.QJ4....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0029 (41)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x327B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0013 (19)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Received expected DF bit in the outer IP Flag field: 0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=81  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=82  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=83  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=84  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=85  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[68] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[69] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[67] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[70] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 3: Send a plain IP packet with DF bit set to 0
and DUT is configured to set the DF-Bit in the outer IP header to COPY

Configuring IPSec on DUT to set policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cguo:WindRiver default with DF=copy
exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x002A (42)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x317A (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0014 (20)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x1622 (5666)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x26B5 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B1 21 63 AB DA 66 D9 31 7C D0 53 9B               .!c..f.1|.S.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x002A (42)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x327A (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0014 (20)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Received expected DF bit in the outer IP Flag field: 0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=86  pid=0x1074a10
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=87  pid=0x1074a10
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=88  pid=0x1074a10
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=89  pid=0x1074a10
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=90  pid=0x1074a10
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[72] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[73] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[71] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[74] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 4: Send a plain IP packet with DF bit set to 1
and DUT is configured to set the DF-Bit in the outer IP header to SET

Configuring IPSec on DUT to set policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=91  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -setdf
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=92  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel setdf 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=93  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -setdf
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=94  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel ingress setdf 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0  -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=95  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x002B (43)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF178 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0015 (21)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xCB30 (52016)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x31A6 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 20 3D 77 F6 2F 1C C9 B4 F1 D5 BA E1                =w./.......
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x002B (43)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF278 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0015 (21)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Received expected DF bit in the outer IP Flag field: 1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=96  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=97  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=98  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=99  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=100  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[80] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[81] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[79] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[82] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 5: Send a plain IP packet with DF bit set to 1
and DUT is configured to set the DF-Bit in the outer IP header to CLEAR

Configuring IPSec on DUT to set policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=101  pid=0x101c020
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -clrdf
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=102  pid=0x101c020
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel clrdf 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=103  pid=0x101c020
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -clrdf
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=104  pid=0x101c020
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel ingress clrdf 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0  -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=105  pid=0x101c020
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x002C (44)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF177 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0016 (22)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x645C (25692)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xD87A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B2 B8 B4 81 E3 67 0E 03 AB 45 AF 1A               .....g...E..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x002C (44)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF277 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0016 (22)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Received expected DF bit in the outer IP Flag field: 0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=106  pid=0xf7d010
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=107  pid=0xf7d010
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=108  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=109  pid=0xf7d010
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=110  pid=0xf7d010
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[88] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[89] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[87] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[90] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 6: Send a plain IP packet with DF bit set to 1
and DUT is configured to set the DF-Bit in the outer IP header to COPY

Configuring IPSec on DUT to set policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cguo:WindRiver default with DF=copy
exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x002D (45)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF176 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0017 (23)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x110C (4364)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xEBCA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 96 42 09 59 4F 5B 95 68 B1 D2 4C 72               .B.YO[.h..Lr
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x002D (45)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF276 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0017 (23)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Received expected DF bit in the outer IP Flag field: 1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=111  pid=0x101cb00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=112  pid=0x101cb00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=113  pid=0x101cb00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=114  pid=0x101cb00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=115  pid=0x101cb00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[92] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[93] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[91] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[94] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring IPSec on DUT to reset policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-reset-df-bit-processing-command.exp $ANVL_DUTHOSTNAME"
ERROR: Invalid number of arguments 
USAGE: ipsec-reset-df-bit-processing-command.exp DUT_HOSTNAME ENCRYPTED_DIFACE_INDEX DF_BIT_DEFAULT


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-2.10: Passed

>> IPSEC-AH-2.11
TEST_DESCRIPTION
IPSec MUST NOT duplicate the Sequence Number field in the AH of an
outbound authenticated IP datagram during the Lifetime of the SA
TEST_REFERENCE
NEGATIVE: RFC 4302 s3.4.3 p19 Sequence Number Verification
TEST_METHOD
- ANVL: Reset the SA between ANVL and DUT with
        Lifetime <LifeTimeSeconds> seconds
- ANVL: Send at most 10 ICMP Echo-requests within the Lifetime of the SA
-  DUT: Forward the corresponding ICMP Echo-requests without
        duplicating the Sequence Number in the AH of any request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=116  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=117  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=118  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=119  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=120  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[96] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[97] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[95] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[98] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 120

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=121  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -lh 120 -bh 1024
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=122  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
    HARD: addtime=120 usetime=0 bytes=1024
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=123  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=24771 usetime=0 bytes=0
    HARD: addtime=120 usetime=0 bytes=1024
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending 10 ICMP plain Packets to DUT
Sending 1-th ICMP plain Packets to DUT
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x002E (46)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3176 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0018 (24)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xF943 (63811)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x4393 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 06 32 90 CC E5 40 13 2D 87 D3 69 3F               .2...@.-..i?
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x002E (46)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3276 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0018 (24)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Sending 2-th ICMP plain Packets to DUT
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x002F (47)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3175 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0019 (25)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xAB85 (43909)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x9151 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 27 74 15 A2 67 58 43 5D 97 64 86 E3               't..gXC].d..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x002F (47)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3275 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0019 (25)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Sending 3-th ICMP plain Packets to DUT
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0030 (48)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3174 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001A (26)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x431D (17181)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xF9B9 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 9F 83 3E AD 46 7C 25 A8 B7 63 CD FE               ..>.F|%..c..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0030 (48)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3274 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001A (26)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Sending 4-th ICMP plain Packets to DUT
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0031 (49)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3173 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001B (27)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xB337 (45879)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x899F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: BB 4E 26 90 9C BE 82 13 96 1D D2 AE               .N&.........
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0031 (49)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3273 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001B (27)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Sending 5-th ICMP plain Packets to DUT
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0032 (50)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3172 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001C (28)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0CE9 (3305)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2FEE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000005 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 49 0B 56 19 4F 32 38 A6 D8 0C F9 96               I.V.O28.....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0032 (50)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3272 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001C (28)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Sending 6-th ICMP plain Packets to DUT
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0033 (51)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3171 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001D (29)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xF79F (63391)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x4537 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000006 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 75 1D DD 90 2A EB 86 23 82 BE 49 8B               u...*..#..I.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0033 (51)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3271 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001D (29)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Sending 7-th ICMP plain Packets to DUT
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0034 (52)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3170 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001E (30)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xBBA9 (48041)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x812D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 90 90 70 86 8F 71 B1 A6 5A 2E 53 EA               ..p..q..Z.S.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0034 (52)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3270 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001E (30)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Sending 8-th ICMP plain Packets to DUT
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0035 (53)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x316F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001F (31)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x4BB8 (19384)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xF11E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: EE 14 B8 96 58 D5 88 F4 3D EE 90 68               ....X...=..h
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0035 (53)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x326F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001F (31)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Sending 9-th ICMP plain Packets to DUT
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0036 (54)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x316E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0020 (32)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xBDA5 (48549)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x7F31 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000009 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 68 B2 F4 11 64 3A 82 41 22 49 5B 35               h...d:.A"I[5
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0036 (54)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x326E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0020 (32)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Sending 10-th ICMP plain Packets to DUT
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0037 (55)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x316D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0021 (33)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x9DC8 (40392)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x9F0E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x0000000A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 9E EF 8C D8 97 7E E1 5A 8F 97 E0 8E               .....~.Z....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0037 (55)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x326D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0021 (33)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

DUT correctly forwarded Authenticated packets without
duplicating sequence number field in AH
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=125  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=126  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=127  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=128  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=129  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[103] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[104] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[102] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[105] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-2.11: Passed

>> IPSEC-AH-2.12
TEST_DESCRIPTION
IPSec MUST set the counter value 1 in the Sequence Number field of AH
in the first authenticated packet sent after re-establishes its SA
TEST_REFERENCE
RFC 4302 s2.5 p8 Sequence Number
TEST_METHOD
-SETUP: Automatic key-management is being used
- ANVL: Send an ICMP Echo request from Local Host
-  DUT: Forward the corresponding authenticated ICMP Echo-request
        packet to Remote Host
- ANVL: Reset the SA between ANVL and DUT
- ANVL: Send an ICMP Echo request from Local Host
-  DUT: Forward the corresponding authenticated ICMP Echo-request
        with Sequence Number set to 1 in the AH using the newly
        established SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=130  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=131  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=132  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=133  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=134  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[107] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[108] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[106] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[109] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0038 (56)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x316C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0022 (34)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xD5CE (54734)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x6708 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 64 F5 7C BB BF 22 29 BF 34 CE AC 7A               d.|..").4..z
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0038 (56)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x326C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0022 (34)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received Authenticated ICMP packet
on interface eth3 (30.1.1.150) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=135  pid=0xf7d010
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=136  pid=0xf7d010
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=137  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=138  pid=0xf7d010
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=139  pid=0xf7d010
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[111] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[112] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[110] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[113] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0039 (57)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x316B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0023 (35)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x17D3 (6099)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2504 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A5 FB D0 1F 94 7D BC 9E 94 AF 99 90               .....}......
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0039 (57)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x326B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0023 (35)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly DUT forwarded authenticated
ICMP Echo Request packet with sequence number 1 in AH

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-2.12: Passed

>> IPSEC-AH-3.1
TEST_DESCRIPTION
Packets that contains sequence numbers lower than the left edge
of the window are rejected.
TEST_REFERENCE
NEGATIVE: RFC 4302 s3.4.3 p19 Sequence Number Verification
TEST_METHOD
- ANVL: Reset new SA with anti-replay enabled and with window size
        set to <window-size>
- ANVL: Send an authenticated ICMP Echo-request containing the
        value 1 in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMP Echo-request
- ANVL: Send an authenticated ICMP Echo-request containing the value
        (<window-size> + 2) in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMP Echo-request
- ANVL: Send an authenticated ICMP Echo-request containing the
        value 2 in the Sequence Number field of the AH
-  DUT: Do not forward ICMP Echo-request
- ANVL: Restore the default SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=140  pid=0xffb760
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=141  pid=0xffb760
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=142  pid=0xffb760
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=143  pid=0xffb760
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=144  pid=0xffb760
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[115] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[116] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[114] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[117] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 32

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending authenticated ICMP Echo-Request with Sequence Number: 1
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x003C (60)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B9B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A0 E2 FC 65 40 91 BB 6F A5 96 0B F9               ...e@..o....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x003A (58)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x316A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0024 (36)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x003A (58)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x326A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0024 (36)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending authenticated ICMP Echo-Request with Sequence Number: 34
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x003F (63)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B98 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000022 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 0D D6 AB D4 47 CD 58 5E 6A 80 D1 19               ....G.X^j...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x003D (61)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3167 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0025 (37)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x003D (61)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3267 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0025 (37)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending authenticated ICMP Echo-Request with Sequence Number: 2
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0042 (66)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B95 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 15 78 6A 42 60 D0 36 62 47 D7 8F 70               .xjB`.6bG..p
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0040 (64)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3164 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0026 (38)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly, no IP packet received on interface eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-3.1: Passed

>> IPSEC-AH-3.2
TEST_DESCRIPTION
IPSec MUST accept all IP datagrams containing distinct Sequence Numbers
in the AH that fall within the anti-replay window
TEST_REFERENCE
RFC 4302 s3.4.3 p20 Sequence Number Verification
TEST_METHOD
- ANVL: Reset new SA with anti-replay enabled and with window size
        set to <window-size>
- ANVL: Send an authenticated ICMP Echo-request containing the
        value 1 in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMP Echo-request
- ANVL: Send an authenticated ICMP Echo-request containing the value
        <window-size> in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMP Echo-request
- ANVL: Send (<window-size> - 2) authenticated ICMP Echo-requests,
        with Sequence Numbers from 2 to (<window-size> - 1)
-  DUT: Forward all the corresponding ICMP Echo-requests
- ANVL: Restore the default SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=145  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=146  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=147  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=148  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=149  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[119] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[120] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[118] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[121] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 32

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending authenticated ICMP Echo-Request with Sequence Number: 1
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0045 (69)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B92 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 10 FA DD 24 27 BF 73 2B AB 15 21 51               ...$'.s+..!Q
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0043 (67)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3161 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0027 (39)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0043 (67)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3261 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0027 (39)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending authenticated ICMP Echo-Request with Sequence Number: 32
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0048 (72)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B8F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000020 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 91 86 21 9E 39 1D D1 73 87 1E 21 DF               ..!.9..s..!.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0046 (70)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x315E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0028 (40)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0046 (70)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x325E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0028 (40)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending Authenticated ICMP Echo-Request with Sequence Number: 2
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x004B (75)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B8C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D4 08 75 6E 62 59 F0 65 E1 5B 49 D8               ..unbY.e.[I.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0049 (73)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x315B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0029 (41)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0049 (73)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x325B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0029 (41)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 2 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 3
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x004E (78)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B89 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3A FC 22 C3 29 AE 70 59 46 30 55 6C               :.".).pYF0Ul
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004C (76)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3158 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002A (42)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004C (76)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3258 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002A (42)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 3 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 4
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0051 (81)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B86 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 93 A4 3D A3 54 97 1D C2 87 D7 6C 5F               ..=.T.....l_
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004F (79)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3155 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002B (43)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004F (79)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3255 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002B (43)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 4 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 5
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0054 (84)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B83 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000005 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 34 C3 AF 79 4E 53 86 AC C1 CD CB 2B               4..yNS.....+
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0052 (82)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3152 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002C (44)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0052 (82)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3252 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002C (44)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 5 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 6
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0057 (87)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B80 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000006 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 51 66 46 D2 A5 09 72 2B DE 46 80 A3               QfF...r+.F..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0055 (85)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x314F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002D (45)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0055 (85)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x324F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002D (45)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 6 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 7
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x005A (90)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B7D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: DF 40 88 B3 E1 C9 B5 2C 2E 7E 4F 55               .@.....,.~OU
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0058 (88)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x314C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002E (46)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0058 (88)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x324C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002E (46)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 7 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 8
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x005D (93)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B7A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 22 4E F4 FF 6D F2 FF 3F 77 11 B4 F8               "N..m..?w...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005B (91)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3149 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002F (47)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005B (91)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3249 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002F (47)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 8 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 9
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0060 (96)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B77 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000009 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A7 E0 E9 D6 1E EC 12 EF 5B 80 4E 6B               ........[.Nk
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005E (94)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3146 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0030 (48)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005E (94)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3246 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0030 (48)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 9 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 10
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0063 (99)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B74 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B0 F3 EE A6 3A F0 F6 2F 36 0E CC ED               ....:../6...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0061 (97)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3143 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0031 (49)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0061 (97)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3243 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0031 (49)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 10 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 11
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0066 (102)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B71 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 1F 89 D7 58 4D 78 FF 92 B9 21 C9 F7               ...XMx...!..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0064 (100)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3140 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0032 (50)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0064 (100)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3240 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0032 (50)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 11 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 12
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0069 (105)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B6E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3E 33 A4 2C B2 3F 60 8C 07 0B EB 8D               >3.,.?`.....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0067 (103)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x313D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0033 (51)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0067 (103)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x323D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0033 (51)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 12 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 13
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x006C (108)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B6B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 06 4A 56 50 F4 B0 89 1E 87 D2 AE 04               .JVP........
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006A (106)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x313A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0034 (52)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006A (106)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x323A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0034 (52)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 13 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 14
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x006F (111)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B68 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3C A5 C8 3D C3 86 CA 68 75 F9 DD 78               <..=...hu..x
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006D (109)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3137 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0035 (53)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006D (109)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3237 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0035 (53)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 14 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 15
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0072 (114)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B65 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 96 AD 6D 25 BE F8 C2 1C 1F 79 E3 3A               ..m%.....y.:
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0070 (112)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3134 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0036 (54)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0070 (112)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3234 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0036 (54)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 15 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 16
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0075 (117)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B62 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000010 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 9E BA 53 C3 DA 84 48 22 45 53 52 4F               ..S...H"ESRO
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0073 (115)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3131 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0037 (55)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0073 (115)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3231 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0037 (55)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 16 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 17
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0078 (120)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B5F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000011 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 51 38 CB 70 F2 CF 5B 83 6E 13 EF 31               Q8.p..[.n..1
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0076 (118)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x312E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0038 (56)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0076 (118)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x322E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0038 (56)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 17 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 18
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x007B (123)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B5C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000012 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F0 54 2A 77 2A 77 63 88 68 69 6A D8               .T*w*wc.hij.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0079 (121)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x312B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0039 (57)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0079 (121)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x322B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0039 (57)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 18 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 19
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x007E (126)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B59 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000013 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 10 EF 08 9F DF 65 2B 66 E6 FB 1D 1A               .....e+f....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007C (124)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3128 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003A (58)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007C (124)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3228 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003A (58)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 19 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 20
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0081 (129)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B56 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000014 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 46 34 9F D5 4C 55 E1 01 1A 5D 2F 68               F4..LU...]/h
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007F (127)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3125 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003B (59)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007F (127)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3225 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003B (59)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 20 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 21
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0084 (132)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B53 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000015 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 67 E0 99 F8 01 2F E2 3D 4C 31 18 46               g..../.=L1.F
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0082 (130)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3122 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003C (60)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0082 (130)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3222 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003C (60)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 21 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 22
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0087 (135)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B50 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000016 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 66 53 3D 76 31 D9 FE 87 97 DB 84 94               fS=v1.......
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0085 (133)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x311F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003D (61)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0085 (133)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x321F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003D (61)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 22 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 23
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x008A (138)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B4D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000017 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A6 BF E3 AF 56 DD CE 4F 2A 03 16 C2               ....V..O*...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0088 (136)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x311C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003E (62)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0088 (136)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x321C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003E (62)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 23 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 24
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x008D (141)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B4A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000018 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: AC 65 D8 AB D6 A7 90 E0 94 7E F0 F1               .e.......~..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x008B (139)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3119 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003F (63)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x008B (139)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3219 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003F (63)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 24 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 25
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0090 (144)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B47 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000019 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D0 B9 94 7F A4 EF 44 71 9A 7A EC BA               ......Dq.z..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x008E (142)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3116 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0040 (64)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x008E (142)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3216 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0040 (64)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 25 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 26
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0093 (147)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B44 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: EE FC C0 26 29 9A 63 AA 82 F4 DE EB               ...&).c.....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0091 (145)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3113 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0041 (65)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0091 (145)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3213 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0041 (65)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 26 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 27
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0096 (150)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B41 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D5 36 18 FE 2C A7 90 11 0B 7E 78 F5               .6..,....~x.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0094 (148)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3110 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0042 (66)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0094 (148)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3210 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0042 (66)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 27 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 28
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0099 (153)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B3E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 92 E4 0D 20 8D 40 84 4D 22 C0 93 AC               ... .@.M"...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0097 (151)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x310D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0043 (67)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0097 (151)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x320D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0043 (67)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 28 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 29
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x009C (156)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B3B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 1C A3 79 CB 4E BF 72 54 4C 54 5D 72               ..y.N.rTLT]r
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009A (154)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x310A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0044 (68)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009A (154)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x320A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0044 (68)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 29 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 30
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x009F (159)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B38 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: BC 16 27 70 6C F7 22 61 AE 0D 00 CB               ..'pl."a....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009D (157)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3107 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0045 (69)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009D (157)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3207 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0045 (69)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 30 on interface eth4(40.1.1.150)
(Local Host)
Sending Authenticated ICMP Echo-Request with Sequence Number: 31
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00A2 (162)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B35 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B3 8E CF 16 5F AF 65 25 F6 90 2D F4               ...._.e%..-.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A0 (160)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3104 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0046 (70)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A0 (160)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3204 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0046 (70)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 31 on interface eth4(40.1.1.150)
(Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-3.2: Passed

>> IPSEC-AH-3.3
TEST_DESCRIPTION
IPSec MUST reject any IP datagram that has the same Sequence Number as
a previously received datagram falling within the anti-replay window
TEST_REFERENCE
NEGATIVE: RFC 4302 s3.4.3 p20 Sequence Number Verification
TEST_METHOD
- ANVL: Reset new SA with anti-replay enabled and with window size
        set to <window-size>
- ANVL: Send an authenticated ICMP Echo-request containing the
        value 1 ihe Sequence Number field of the AH
-  DUT: Forward the corresponding ICMP Echo-request
- ANVL: Send an authenticated ICMP Echo-request containing the value
        <window-size> in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMP Echo-request
- ANVL: Send (<window-size> - 2) authenticated ICMP Echo-requests
        with Sequence Numbers from 2 to (<window-size> - 1)
-  DUT: Forward all the corresponding ICMP Echo-requests
- ANVL: Send (<window-size> - 2) authenticated ICMP Echo-requests
        with Sequence Numbers from 2 to (<window-size> - 1)
-  DUT: Do not forward corresponding ICMP Echo-requests
- ANVL: Restore the default SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=150  pid=0xf0d020
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=151  pid=0xf0d020
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=152  pid=0xf0d020
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=153  pid=0xf0d020
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=154  pid=0xf0d020
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[123] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[124] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[122] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[125] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 32

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending authenticated ICMP Echo-Request with Sequence Number: 1
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00A5 (165)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B32 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 90 22 D7 9E 67 FF 0F BA 6E 61 8A E0               ."..g...na..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A3 (163)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3101 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0047 (71)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A3 (163)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3201 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0047 (71)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending authenticated ICMP Echo-Request with Sequence Number: 32
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00A8 (168)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B2F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000020 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 90 CE 1A DD 74 16 B6 12 B1 03 8C D8               ....t.......
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A6 (166)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30FE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0048 (72)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A6 (166)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31FE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0048 (72)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending authenticated ICMP Echo-Request with Sequence Number: 2
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00AB (171)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B2C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 54 F0 D4 73 D5 8B C4 E5 21 CD 8F 21               T..s....!..!
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A9 (169)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30FB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0049 (73)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A9 (169)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31FB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0049 (73)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 2 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 3
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00AE (174)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B29 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7B 0D 5C 3D 82 BC 96 E3 F3 41 4E EA               {.\=.....AN.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00AC (172)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30F8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004A (74)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00AC (172)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31F8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004A (74)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 3 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 4
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00B1 (177)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B26 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6A D7 B3 C8 52 25 0C 30 E8 4A 7B 3D               j...R%.0.J{=
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00AF (175)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30F5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004B (75)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00AF (175)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31F5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004B (75)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 4 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 5
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00B4 (180)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B23 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000005 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5E D6 2C EB 64 84 6A 97 E1 9A EE 14               ^.,.d.j.....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B2 (178)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30F2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004C (76)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B2 (178)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31F2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004C (76)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 5 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 6
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00B7 (183)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B20 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000006 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8A 41 59 9F D5 D9 55 D7 BB 06 B5 86               .AY...U.....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B5 (181)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30EF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004D (77)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B5 (181)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31EF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004D (77)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 6 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 7
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00BA (186)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B1D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 38 19 49 68 B1 59 E6 2E F9 5F 05 4A               8.Ih.Y..._.J
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B8 (184)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30EC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004E (78)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B8 (184)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31EC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004E (78)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 7 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 8
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00BD (189)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B1A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C3 B3 87 83 81 82 B5 B8 AF 61 0D 1F               .........a..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00BB (187)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30E9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004F (79)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00BB (187)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31E9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004F (79)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 8 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 9
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00C0 (192)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B17 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000009 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8F 55 3A 5B 67 62 CC 04 5F A8 AA 87               .U:[gb.._...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00BE (190)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30E6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0050 (80)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00BE (190)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31E6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0050 (80)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 9 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 10
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00C3 (195)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B14 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 53 C9 D9 38 B5 AD 34 3A EA 74 6F E7               S..8..4:.to.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00C1 (193)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30E3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0051 (81)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00C1 (193)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31E3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0051 (81)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 10 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 11
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00C6 (198)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B11 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 05 B3 A5 07 DD 2A 9D 23 4B FD 47 A7               .....*.#K.G.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00C4 (196)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30E0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0052 (82)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00C4 (196)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31E0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0052 (82)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 11 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 12
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00C9 (201)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B0E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: AA CA 71 EB FF C0 D9 CD C6 4D 8E FC               ..q......M..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00C7 (199)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30DD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0053 (83)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00C7 (199)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31DD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0053 (83)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 12 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 13
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00CC (204)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B0B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: FA 83 03 E8 5F DD 2E AB 63 8A 39 F0               ...._...c.9.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00CA (202)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30DA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0054 (84)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00CA (202)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31DA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0054 (84)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 13 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 14
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00CF (207)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B08 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 03 0A EC 78 F1 D5 F9 DA 25 33 B9 B3               ...x....%3..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00CD (205)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30D7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0055 (85)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00CD (205)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31D7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0055 (85)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 14 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 15
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00D2 (210)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B05 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 01 FC 03 1F C8 58 44 B9 CD 89 42 48               .....XD...BH
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D0 (208)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30D4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0056 (86)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D0 (208)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31D4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0056 (86)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 15 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 16
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00D5 (213)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3B02 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000010 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 95 35 95 17 84 6D B1 69 A1 20 9E A8               .5...m.i. ..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D3 (211)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30D1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0057 (87)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D3 (211)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31D1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0057 (87)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 16 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 17
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00D8 (216)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000011 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 1A C2 74 40 10 54 A7 D9 DC 69 29 E3               ..t@.T...i).
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D6 (214)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30CE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0058 (88)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D6 (214)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31CE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0058 (88)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 17 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 18
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00DB (219)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AFC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000012 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 38 27 1C A6 2B 27 1C A7 E9 43 77 43               8'..+'...CwC
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D9 (217)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30CB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0059 (89)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D9 (217)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31CB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0059 (89)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 18 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 19
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00DE (222)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AF9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000013 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D9 B3 98 B0 56 70 B7 24 E4 28 8A C2               ....Vp.$.(..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00DC (220)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30C8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005A (90)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00DC (220)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31C8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005A (90)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 19 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 20
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00E1 (225)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AF6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000014 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 0E 1E B4 53 EF C0 78 27 AE 76 50 98               ...S..x'.vP.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00DF (223)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30C5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005B (91)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00DF (223)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31C5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005B (91)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 20 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 21
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00E4 (228)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AF3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000015 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 9A 04 CD 34 38 AA DC 52 27 0F DB 64               ...48..R'..d
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00E2 (226)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30C2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005C (92)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00E2 (226)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31C2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005C (92)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 21 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 22
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00E7 (231)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AF0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000016 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 09 C8 AA 80 B4 C5 64 7D 33 2C 89 C3               ......d}3,..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00E5 (229)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30BF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005D (93)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00E5 (229)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31BF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005D (93)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 22 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 23
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00EA (234)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AED (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000017 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: FB 92 CE 16 A4 AC 6C F0 93 66 73 5E               ......l..fs^
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00E8 (232)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30BC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005E (94)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00E8 (232)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31BC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005E (94)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 23 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 24
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00ED (237)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AEA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000018 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 28 28 0F B1 5C EF F5 89 29 BC 41 19               ((..\...).A.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00EB (235)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30B9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005F (95)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00EB (235)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31B9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005F (95)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 24 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 25
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00F0 (240)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AE7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000019 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5E 87 F6 F6 6F 4B 9C BE 2D 7F 91 2E               ^...oK..-...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00EE (238)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30B6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0060 (96)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00EE (238)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31B6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0060 (96)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 25 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 26
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00F3 (243)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AE4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8B 82 1B D2 BC C0 9A C8 B8 E8 27 34               ..........'4
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00F1 (241)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30B3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED99 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0061 (97)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00F1 (241)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31B3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED99 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0061 (97)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 26 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 27
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00F6 (246)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AE1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 34 7A 54 32 17 70 C2 07 8C 3E 30 C2               4zT2.p...>0.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00F4 (244)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30B0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED98 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0062 (98)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00F4 (244)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31B0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED98 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0062 (98)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 27 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 28
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00F9 (249)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3ADE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: E0 1A CC 17 4A D3 C9 6C 05 01 B8 73               ....J..l...s
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00F7 (247)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30AD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED97 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0063 (99)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00F7 (247)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31AD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED97 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0063 (99)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 28 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 29
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00FC (252)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3ADB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 51 05 90 F0 90 74 A1 7E 71 26 AB 57               Q....t.~q&.W
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00FA (250)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30AA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED96 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0064 (100)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00FA (250)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31AA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED96 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0064 (100)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 29 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 30
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x00FF (255)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AD8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C1 15 13 57 EA 1F 56 E0 AD 9B 77 FB               ...W..V...w.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00FD (253)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED95 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0065 (101)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00FD (253)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED95 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0065 (101)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 30 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 31
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0102 (258)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AD5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 77 D5 09 42 3B 02 FA DF 3A 34 02 1F               w..B;...:4..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0100 (256)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED94 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0066 (102)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0100 (256)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED94 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0066 (102)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 31 on interface eth4(40.1.1.150)
(Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 2
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0105 (261)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AD2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8A 19 B6 3E AD 4B 0F 0F AB 5E D1 D5               ...>.K...^..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0103 (259)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED93 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0067 (103)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 3
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0108 (264)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3ACF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 9A 17 A2 DF 40 E9 13 4E F0 71 2D 63               ....@..N.q-c
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0106 (262)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x309E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED92 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0068 (104)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 4
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x010B (267)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3ACC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: BF C5 57 59 54 A5 E7 82 90 B0 E6 E4               ..WYT.......
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0109 (265)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x309B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED91 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0069 (105)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 5
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x010E (270)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AC9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000005 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F5 80 09 61 23 EA 1B 7F 01 F9 9A 22               ...a#......"
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x010C (268)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3098 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED90 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x006A (106)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 6
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0111 (273)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AC6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000006 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: BF 46 C1 05 13 4E 56 88 6E 5A CF 97               .F...NV.nZ..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x010F (271)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3095 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED8F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x006B (107)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 7
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0114 (276)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AC3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F4 37 A9 6F 35 EE DF 67 45 B3 B1 C7               .7.o5..gE...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0112 (274)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3092 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED8E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x006C (108)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 8
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0117 (279)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AC0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 82 BF 10 80 51 6F 27 45 DE D5 69 FD               ....Qo'E..i.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0115 (277)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x308F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED8D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x006D (109)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 9
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x011A (282)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3ABD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000009 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 75 D8 BB DA 89 EE A6 94 64 F1 22 EA               u.......d.".
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0118 (280)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x308C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED8C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x006E (110)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 10
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x011D (285)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3ABA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 49 19 A9 76 61 41 67 C0 AB 0E 77 5E               I..vaAg...w^
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x011B (283)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3089 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED8B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x006F (111)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 11
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0120 (288)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AB7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6E 6D EB 59 29 76 D8 C7 5E 46 B6 86               nm.Y)v..^F..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x011E (286)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3086 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED8A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0070 (112)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 12
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0123 (291)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AB4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 1A 1D 4B A8 B9 5D 3C EE 6C DA 30 0F               ..K..]<.l.0.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0121 (289)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3083 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED89 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0071 (113)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 13
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0126 (294)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AB1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 25 4A C5 D0 38 43 20 C8 1B F7 31 7C               %J..8C ...1|
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0124 (292)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3080 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED88 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0072 (114)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 14
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0129 (297)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AAE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6F 3D D3 24 0C 81 43 87 EE BC 3B 67               o=.$..C...;g
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0127 (295)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x307D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED87 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0073 (115)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 15
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x012C (300)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AAB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: AC BF CF 81 42 66 21 17 89 03 87 4A               ....Bf!....J
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012A (298)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x307A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED86 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0074 (116)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 16
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x012F (303)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AA8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000010 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 77 2F 47 56 E1 B8 D8 F3 EA D2 51 F3               w/GV......Q.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012D (301)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3077 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED85 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0075 (117)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 17
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0132 (306)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AA5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000011 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7B 62 04 31 66 45 F9 A6 90 C7 BF 30               {b.1fE.....0
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0130 (304)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3074 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED84 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0076 (118)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 18
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0135 (309)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3AA2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000012 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B7 C4 DE FF 44 0F 17 62 3A FA EC C4               ....D..b:...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0133 (307)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3071 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED83 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0077 (119)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 19
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0138 (312)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A9F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000013 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 18 47 3A F4 6E 65 54 21 66 6E EB F6               .G:.neT!fn..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0136 (310)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x306E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED82 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0078 (120)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 20
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x013B (315)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A9C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000014 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: E1 26 12 D3 0C 9C 15 00 2C 8D 56 FF               .&......,.V.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0139 (313)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x306B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED81 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0079 (121)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 21
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x013E (318)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A99 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000015 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 83 1A 04 89 8E 87 4B 1F C2 99 50 8F               ......K...P.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x013C (316)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3068 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED80 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x007A (122)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 22
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0141 (321)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A96 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000016 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 08 C5 29 3E 0A EA AB 21 50 D6 79 BA               ..)>...!P.y.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x013F (319)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3065 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x007B (123)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 23
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0144 (324)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A93 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000017 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: DB F2 79 8E 10 2A E3 CA F4 35 7B 77               ..y..*...5{w
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0142 (322)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3062 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x007C (124)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 24
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0147 (327)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A90 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000018 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A0 FA 4B 42 F0 EB 3D 9A 66 5F AE FE               ..KB..=.f_..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0145 (325)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x305F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x007D (125)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 25
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x014A (330)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A8D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000019 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F3 CF 3E 1F D6 6D E1 88 26 0D 9F 0C               ..>..m..&...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0148 (328)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x305C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x007E (126)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 26
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x014D (333)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A8A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 0C 2F AB 49 B2 8A 0F 47 E1 FC 52 4E               ./.I...G..RN
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x014B (331)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3059 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x007F (127)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 27
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0150 (336)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A87 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 1D 9B E3 55 41 72 59 0A 76 5A C1 C0               ...UArY.vZ..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x014E (334)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3056 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0080 (128)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 28
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0153 (339)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A84 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 26 5B C1 4F EE 87 67 83 49 3B 4E 7D               &[.O..g.I;N}
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0151 (337)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3053 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED79 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0081 (129)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 29
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0156 (342)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A81 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C7 5F 8C C0 19 89 98 B3 63 B9 E8 EB               ._......c...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0154 (340)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3050 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED78 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0082 (130)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 30
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0159 (345)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A7E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: EA 2A 54 EA 18 68 DB 8A 92 BC 21 78               .*T..h....!x
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0157 (343)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x304D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED77 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0083 (131)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)
Sending authenticated ICMP Echo-Request with Sequence Number: 31
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x015C (348)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A7B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 54 10 E8 2C 00 19 9A CE 48 7A E5 76               T..,....Hz.v
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x015A (346)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x304A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED76 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0084 (132)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive IP packet on interface eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-3.3: Passed

>> IPSEC-AH-3.4
TEST_DESCRIPTION
IPSec MUST move the *right* edge of the anti-replay window after
receiving a valid datagram with a higher Sequence Number in the AH
TEST_REFERENCE
 RFC 4302 s3.4.3 p19 Sequence Number Verification
TEST_METHOD
- ANVL: Reset new SA with anti-replay enabled and with window size
        set to <window-size>
- ANVL: Send an authenticated ICMP Echo-request containing the
        value 1 in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMP Echo-request
- ANVL: Send an authenticated ICMP Echo-request containing the value
        <window-size> in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMP Echo-request
- ANVL: Send an authenticated ICMP Echo-request containing the value
        (<window-size> + 2) in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMP Echo-request
- ANVL: Send an authenticated ICMP Echo-request containing the value 2
        in the Sequence Number field of the AH
-  DUT: Do not forward ICMP Echo-request
- ANVL: Restore the default SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=155  pid=0xf65530
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=156  pid=0xf65530
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=157  pid=0xf65530
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=158  pid=0xf65530
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=159  pid=0xf65530
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[127] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[128] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[126] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[129] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 32

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending authenticated ICMP Echo-Request with Sequence Number: 1
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x015F (351)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A78 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 53 55 5E 39 20 B1 B0 65 B6 21 1A 3E               SU^9 ..e.!.>
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x015D (349)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3047 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED75 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0085 (133)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x015D (349)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3147 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED75 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0085 (133)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending authenticated ICMP Echo-Request with Sequence Number: 32
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0162 (354)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A75 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000020 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 69 D7 CC 0B DF A9 1B 27 03 82 A5 52               i......'...R
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0160 (352)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3044 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED74 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0086 (134)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0160 (352)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3144 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED74 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0086 (134)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending authenticated ICMP Echo-Request with Sequence Number: 34
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0165 (357)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A72 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000022 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8A 59 60 C4 55 8A B2 A0 EB 5C 69 4A               .Y`.U....\iJ
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0163 (355)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3041 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED73 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0087 (135)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0163 (355)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3141 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED73 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0087 (135)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending authenticated ICMP Echo-Request with Sequence Number: 2
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0168 (360)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A6F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 66 1B 19 7A BD 2F 07 B3 A8 46 3B C9               f..z./...F;.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0166 (358)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x303E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED72 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0088 (136)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly, no IP packet received on interface eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-3.4: Passed

>> IPSEC-AH-3.5
TEST_DESCRIPTION
IPSec MUST NOT update the *right* edge of the anti-replay window
if the ICV verification on a received IP datagram fails
TEST_REFERENCE
NEGATIVE: RFC 4302 s3.4.3 p20 Sequence Number Verification
TEST_METHOD
- ANVL: Reset new SA with anti-replay enabled and with window size
        set to <window-size>
- ANVL: Send an authenticated ICMP Echo-request containing the value 1
        in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMP Echo-request
- ANVL: Send an authenticated ICMP Echo-request containing the value
        <window-size> in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMP Echo-request
- ANVL: Send an incorrectly authenticated ICMP Echo-request (with an
        ICV error) containing the value (<window-size> + 2) in the
        Sequence Number field of the AH
-  DUT: Do not forward ICMP Echo-request
- ANVL: Send an authenticated ICMP Echo-request containing the value 2
        in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMP Echo-request
- ANVL: Restore the default SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=160  pid=0xf65530
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=161  pid=0xf65530
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=162  pid=0xf65530
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=163  pid=0xf65530
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=164  pid=0xf65530
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[131] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[132] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[130] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[133] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 32

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending authenticated ICMP Echo-Request with Sequence Number: 1
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x016B (363)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A6C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6E 5B 4D 42 1B 56 CE 32 72 68 81 20               n[MB.V.2rh. 
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0169 (361)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x303B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED71 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0089 (137)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0169 (361)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x313B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED71 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0089 (137)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending authenticated ICMP Echo-Request with Sequence Number: 32
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x016E (366)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A69 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000020 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: DE 88 D7 F8 87 EF 9B E3 6F 73 D8 DC               ........os..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x016C (364)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3038 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED70 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008A (138)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x016C (364)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3138 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED70 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008A (138)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending authenticated ICMP Echo-Request with Sequence Number: 34
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0171 (369)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A66 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000022 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 00 F3 56 92 CF C4 C1 90 6B 73 78 4E               ..V.....ksxN
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x016F (367)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3035 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED6F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008B (139)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Sending authenticated ICMP Echo-Request with Sequence Number: 2
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0174 (372)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A63 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 9D 39 B6 99 5E AC FD 67 41 86 2F 73               .9..^..gA./s
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0172 (370)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3032 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED6E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008C (140)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0172 (370)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3132 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED6E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008C (140)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT has forwarded the corresponding ICMP Echo-Request on intreface eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-3.5: Passed

>> IPSEC-AH-4.1
TEST_DESCRIPTION
IPsec MUST set the values of the mutable fields(e.g. TOS field) in an incoming
IPv4 datagram to zero for purposes of the ICV computation
TEST_REFERENCE
RFC 4302 s3.3.3.1 p13 Handling Mutable Fields
RFC 4302 s3.3.3.1.1.1 p14 Base Header Fields
TEST_METHOD
- ANVL: Send 8 ICMP Echo-requests that are identical except
        for TOS which is set to <tos> field and Header Checksum
        from Local Host
-  DUT: Forward the corresponding authenticated ICMP Echo-requests
        to Remote Host
- ANVL: Check ICV in packet from DUT
- CASE: <tos> = 0
- CASE: <tos> = 1
- CASE: <tos> = 2
- CASE: <tos> = 3
- CASE: <tos> = 4
- CASE: <tos> = 5
- CASE: <tos> = 6
- CASE: <tos> = 7
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=165  pid=0xf8c020
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=166  pid=0xf8c020
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=167  pid=0xf8c020
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=168  pid=0xf8c020
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=169  pid=0xf8c020
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[135] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[136] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[134] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[137] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: send a plain IP packet with TOS field set to 0
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0175 (373)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x302F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED6D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008D (141)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x8866 (34918)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xB470 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 61 25 59 9B 39 EC 42 64 F5 5C DE 08               a%Y.9.Bd.\..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0175 (373)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x312F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED6D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008D (141)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: 61 25 59 9B 39 EC 42 64 F5 5C DE 08 


Case: send a plain IP packet with TOS field set to 1
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x20
IP:  |01234567
IP:  |001.....             = Precedence (Priority)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0176 (374)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x300E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED6C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008E (142)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x20
IP:  |01234567
IP:  |001.....             = Precedence (Priority)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x3ED6 (16086)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xFDE0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 51 29 D3 68 09 4A A0 2A 20 51 4B 53               Q).h.J.* QKS
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x20
IP:  |01234567
IP:  |001.....             = Precedence (Priority)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0176 (374)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x310E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED6C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008E (142)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: 51 29 D3 68 09 4A A0 2A 20 51 4B 53 


Case: send a plain IP packet with TOS field set to 2
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x40
IP:  |01234567
IP:  |010.....             = Precedence (Immediate)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0177 (375)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FED (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED6B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008F (143)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x40
IP:  |01234567
IP:  |010.....             = Precedence (Immediate)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x6953 (26963)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xD343 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: E9 89 1C FA 55 0C 84 F4 E3 C1 60 37               ....U.....`7
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x40
IP:  |01234567
IP:  |010.....             = Precedence (Immediate)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0177 (375)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30ED (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED6B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008F (143)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: E9 89 1C FA 55 0C 84 F4 E3 C1 60 37 


Case: send a plain IP packet with TOS field set to 3
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x60
IP:  |01234567
IP:  |011.....             = Precedence (Flash)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0178 (376)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FCC (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED6A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0090 (144)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x60
IP:  |01234567
IP:  |011.....             = Precedence (Flash)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x43CC (17356)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xF8AA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F1 55 84 6B 0E B6 74 EC 89 1B 94 CB               .U.k..t.....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x60
IP:  |01234567
IP:  |011.....             = Precedence (Flash)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0178 (376)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30CC (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED6A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0090 (144)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: F1 55 84 6B 0E B6 74 EC 89 1B 94 CB 


Case: send a plain IP packet with TOS field set to 4
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x80
IP:  |01234567
IP:  |100.....             = Precedence (Flash Override)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0179 (377)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FAB (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED69 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0091 (145)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x80
IP:  |01234567
IP:  |100.....             = Precedence (Flash Override)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x1535 (5429)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2722 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000005 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: DE 3A 7A CB 41 A1 13 C4 19 3E 13 9C               .:z.A....>..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x80
IP:  |01234567
IP:  |100.....             = Precedence (Flash Override)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0179 (377)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30AB (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED69 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0091 (145)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: DE 3A 7A CB 41 A1 13 C4 19 3E 13 9C 


Case: send a plain IP packet with TOS field set to 5
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xA0
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x017A (378)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F8A (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED68 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0092 (146)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xA0
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x8CB2 (36018)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xAF84 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000006 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 78 4D 3A 9D 1E 2B AA 8B 34 68 A3 6A               xM:..+..4h.j
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xA0
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x017A (378)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x308A (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED68 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0092 (146)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: 78 4D 3A 9D 1E 2B AA 8B 34 68 A3 6A 


Case: send a plain IP packet with TOS field set to 6
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x017B (379)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F69 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED67 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0093 (147)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x5E41 (24129)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xDDD5 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A4 EF CA 22 FF 38 59 06 B6 78 42 9D               ...".8Y..xB.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x017B (379)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3069 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED67 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0093 (147)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: A4 EF CA 22 FF 38 59 06 B6 78 42 9D 


Case: send a plain IP packet with TOS field set to 7
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xE0
IP:  |01234567
IP:  |111.....             = Precedence (Network Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x017C (380)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F48 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED66 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0094 (148)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xE0
IP:  |01234567
IP:  |111.....             = Precedence (Network Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x28F7 (10487)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x1300 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 89 23 89 A7 28 BA 5A FE 8C 03 3E 3B               .#..(.Z...>;
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xE0
IP:  |01234567
IP:  |111.....             = Precedence (Network Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x017C (380)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3048 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED66 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0094 (148)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: 89 23 89 A7 28 BA 5A FE 8C 03 3E 3B 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-4.1: Passed

>> IPSEC-AH-4.2
TEST_DESCRIPTION
IPsec MUST set the value of the mutable fields(e.g. DF bit) in an incoming
IPv4 datagram to zero for purposes of the ICV computation
TEST_REFERENCE
RFC 4302 s3.3.3.1 p13 Handling Mutable Fields
RFC 4302 s3.3.3.1.1.1 p14 Base Header Fields
TEST_METHOD
- ANVL: Send 2 ICMP Echo-requests from Local Host that are identical
        except for the DF bit set to <df> and the Header Checksum
-  DUT: Forward the corresponding authenticated ICMP Echo-requests
        to Remote Host
- ANVL: Check ICV in packet from DUT
- CASE: <df> = 0
- CASE: <df> = 1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=170  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=171  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=172  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=173  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=174  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[139] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[140] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[138] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[141] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: send a plain IP packet with DF bit set to 0
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x017D (381)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3027 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED65 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0095 (149)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xA0BD (41149)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x9C19 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 83 BB 8F 86 31 09 19 B8 D6 FB 90 C6               ....1.......
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x017D (381)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3127 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED65 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0095 (149)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: 83 BB 8F 86 31 09 19 B8 D6 FB 90 C6 


Case: send a plain IP packet with DF bit set to 1
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x017E (382)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF025 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED64 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0096 (150)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xF64C (63052)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x068A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7C 27 10 28 8D 46 F7 26 8F EB EB 63               |'.(.F.&...c
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x017E (382)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF125 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED64 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0096 (150)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: 7C 27 10 28 8D 46 F7 26 8F EB EB 63 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-4.2: Passed

>> IPSEC-AH-4.3
TEST_DESCRIPTION
IPsec MUST set the value of the mutable fields(e.g. TTL field) in an incoming
IPv4 datagram to zero for purposes of the ICV computation
TEST_REFERENCE
RFC 4302 s3.3.3.1 p13 Handling Mutable Fields
RFC 4302 s3.3.3.1.1.1 p14 Base Header Fields
TEST_METHOD
- ANVL: From Local Host send 4 ICMP Echo-requests that are identical
        except for the TTL field which is set to <ttl> and the
        Checksum Header
-  DUT: Forward the corresponding authenticated ICMP Echo-requests
        to Remote Host
- ANVL: Check ICV in packet from DUT
- CASE: <ttl> = 3
- CASE: <ttl> = 64
- CASE: <ttl> = 254
- CASE: <ttl> = 255
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=175  pid=0xf58a20
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=176  pid=0xf58a20
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=177  pid=0xf58a20
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=178  pid=0xf58a20
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=179  pid=0xf58a20
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[143] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[144] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[142] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[145] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: send a plain IP packet with
Time To Live field set to 2
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x017F (383)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 3
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x6D25 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED63 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0097 (151)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x51EC (20972)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 2
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x27EB (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 0A 3F 46 55 DC 9D C5 82 B8 6A 46 FF               .?FU.....jF.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x017F (383)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 2
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x6E25 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED63 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0097 (151)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: 0A 3F 46 55 DC 9D C5 82 B8 6A 46 FF 


Case: send a plain IP packet with
Time To Live field set to 64
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0180 (384)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3024 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED62 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0098 (152)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x795C (31068)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xC37A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 74 40 32 57 98 9E 83 76 A3 C7 FF 0A               t@2W...v....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0180 (384)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3124 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED62 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0098 (152)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: 74 40 32 57 98 9E 83 76 A3 C7 FF 0A 


Case: send a plain IP packet with
Time To Live field set to 254
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0181 (385)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 254
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7222 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED61 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0099 (153)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0C60 (3168)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 253
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x7276 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: BB 78 48 1A 48 95 F8 B4 D0 7D 73 D9               .xH.H....}s.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0181 (385)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 253
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7322 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED61 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0099 (153)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: BB 78 48 1A 48 95 F8 B4 D0 7D 73 D9 


Case: send a plain IP packet with
Time To Live field set to 255
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0182 (386)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 255
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7121 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED60 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009A (154)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xDB41 (56129)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 254
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xA294 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 28 1D F8 39 57 87 9C DF AB 2D 24 FE               (..9W....-$.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0182 (386)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 254
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7221 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED60 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009A (154)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received ICV from DUT: 28 1D F8 39 57 87 9C DF AB 2D 24 FE 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-4.3: Passed

>> IPSEC-AH-4.6
TEST_DESCRIPTION
IPsec MUST set the Option field in an incoming authenticated IPv4
datagram with strict source routing, to zero for purposes of the
ICV computation
TEST_REFERENCE
RFC 4302 s3.3.3.1.1.2 p15 Options
RFC 4302 s3.3.3.1.1.1 p14 Base Header Fields
TEST_METHOD
- ANVL: Send an authenticated IP datagram containing a strict source
        routing option from Remote Host through the DUT to Local Host
-  DUT: Forward the IP datagram to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=180  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=181  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=182  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=183  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=184  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[147] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[148] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[146] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[149] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0185 (389)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xA523 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x89 (Strict Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 30.1.1.5
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7A 60 E3 97 06 11 AB A5 7B 81 E9 99               z`......{...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0183 (387)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3021 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009B (155)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0183 (387)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3121 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009B (155)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received expected forwarded IP packet on interface eth4 (40.1.1.150)
(Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-4.6: Passed

>> IPSEC-AH-4.7
TEST_DESCRIPTION
IPSec MUST discard any incoming IPv4 datagram with a non-zero Fragment
Offset
TEST_REFERENCE
NEGATIVE: RFC 4302 s3.4.1 p18 Reassembly
TEST_METHOD
- ANVL: Send an authenticated ICMP Echo-request from Remote Host with
        the Fragment Offset field set to 1
-  DUT: Do not forward the ICMP Echo-request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=185  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=186  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=187  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=188  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=189  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[151] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[152] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[150] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[153] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0188 (392)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0001 (8 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A4E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 9F F5 56 87 0C 09 D8 E7 D3 34 EA 45               ..V......4.E
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0186 (390)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x301E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009C (156)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly, no IP packet received on interface eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-4.7: Passed

>> IPSEC-AH-4.8
TEST_DESCRIPTION
IPSec MUST discard any incoming IPV4 datagram having the
MORE FRAGMENTS flag set
TEST_REFERENCE
NEGATIVE: RFC 4302 s3.4.1 p18 Reassembly
TEST_METHOD
- ANVL: Send an authenticated ICMP Echo-request from Remote Host
        with the MORE FRAGMENTS flag set
-  DUT: Do not forward the ICMP Echo-request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=190  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=191  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=192  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=193  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=194  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[155] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[156] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[154] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[157] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x018B (395)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x1A4C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000005 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A6 FD 2A 85 53 E4 BD AB B3 61 EA A7               ..*.S....a..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0189 (393)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x301B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009D (157)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly, no IP packet received on interface eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-4.8: Passed

>> IPSEC-AH-5.1
TEST_DESCRIPTION
IPSec MUST discard an outbound IP datagram if no policy is found in
the SPD that matches the packet
TEST_REFERENCE
NEGATIVE: RFC 4301 s5 p50 IP Traffic Processing
TEST_METHOD
- ANVL: Remove IPSec SA on the DUT with source address ANVL Local
        Host address and destination address ANVL Remote Address
- ANVL: Send an ICMP Echo-request from ANVL Local Host to ANVL Remote
        Host
-  DUT: Do not forward ICMP Echo Request or AH authenicated ICMP Echo
        Request to Remote Host
- ANVL: Send an ICMP Echo-request from Local Host
-  DUT: Do not forward authenticated ICMP Echo-request to Remote host
- ANVL: Restore default IPSec SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=195  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=196  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=197  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=198  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=199  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[159] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[160] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[158] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[161] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Removing ANVL Local Address (40.1.1.150) and Remote Host Address (30.1.1.150)
from IPSec SAs configured on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipsecctrl flows
Flows:
[159] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[160] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[158] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[161] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=200  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=162
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -flowpri 10 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=201  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=163
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=202  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=164
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[159] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
exit
[162] :: deny src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: none
[163] :: deny pri=10 src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: none
[158] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[164] :: deny src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: none
Total of 5 flows.
-> Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x018C (396)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3018 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009E (158)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly did not forward unauthenticated ICMP Echo Request
on eth3 (30.1.1.150) (Remote Host)
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x018D (397)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3017 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009F (159)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet


DUT correctly did not forward authenticated ICMP Echo Request
on eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-5.1: Passed

>> IPSEC-AH-5.2
TEST_DESCRIPTION
IPSec MUST discard outbound IP datagram if SPD entry of datagram
does not point to a matching SA(in case of PROTECT) and there is 
no key-management entity
TEST_REFERENCE
NEGATIVE: RFC 4301 s5.1(3b) p53 Outbound IP Traffic Processing 
(protected-to-unprotected)
TEST_METHOD
- ANVL: Remove the ANVL Local and Remote Host IP addresses from the
        IPSec SAs on the DUT
- ANVL: Send an ICMP Echo-request from Local Host
-  DUT: Do not forward ICMP Echo-request to Remote host
- ANVL: Send an ICMP Echo-request from Local Host
-  DUT: Do not forward authenticated ICMP Echo-request to Remote host
- ANVL: Restore DUT IPSec SAs
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=203  pid=0x100f160
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=204  pid=0x100f160
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=205  pid=0x100f160
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=206  pid=0x100f160
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=207  pid=0x100f160
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[166] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[167] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[165] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[168] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Removing ANVL Local Address (40.1.1.150) and Remote Host Address (30.1.1.150)
from IPSec SAs configured on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipsecctrl flows
Flows:
[166] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[167] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[165] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[168] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=208  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=169
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -flowpri 10 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=209  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=170
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=210  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=171
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[166] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
exit
[169] :: deny src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: none
[170] :: deny pri=10 src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: none
[165] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[171] :: deny src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: none
Total of 5 flows.
-> Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x018E (398)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3016 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A0 (160)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet


DUT correctly did not forward unauthenticated ICMP Echo Request
on eth3 (30.1.1.150) (Remote Host)
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x018F (399)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3015 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED59 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A1 (161)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet


DUT correctly did not forward authenticated ICMP Echo Request
on eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-5.2: Passed

>> IPSEC-AH-5.3
TEST_DESCRIPTION
IPSec MUST allow a Lifetime field to be associated with any SAD entry
and the Lifetime of an SA may be specified as a time or byte count or a 
simultaneous use of BOTH.
TEST_REFERENCE
RFC 4301 s4.4.2.1 p37 Data Items in the SAD
TEST_METHOD
- ANVL: Reset the SA between ANVL and DUT with
        Lifetime <LifeTimeBytes> bytes
- ANVL: Send ICMP Echo-requests within the Lifetime
        from Local Host
-  DUT: Forward the corresponding authenticated ICMP Echo-requests
        to Remote Host
- ANVL: Send ICMP Echo-requests beyond the Lifetime
        from Local Host
-  DUT: Do not forward the corresponding authenticated ICMP
        Echo-requests to Remote Host
- ANVL: Reset the SA between ANVL and DUT with
        Lifetime <LifeTimeSeconds> seconds
- ANVL: Send ICMP Echo-requests within the Lifetime
        from Local Host
-  DUT: Forward the corresponding authenticated ICMP Echo-requests
        to Remote Host
- ANVL: Send ICMP Echo-requests beyond the Lifetime
        from Local Host
-  DUT: Do not forward the corresponding authenticated ICMP
        Echo-requests to Remote Host
- ANVL: Restore default IPSec SA on the DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=211  pid=0x100f160
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=212  pid=0x100f160
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=213  pid=0x100f160
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=214  pid=0x100f160
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=215  pid=0x100f160
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[173] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[174] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[172] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[175] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-set-sa-lifetime-bytes-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm update -spi 302 -proto ah -src 30.1.1.5 -dst 30.1.1.150 -bh 1024
SADB_MSG: msgtype=UPDATE  err=0  satype=AH  len=112  seq=216  pid=0xf7d010
      SA: spi=302  sta=MATURE  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
    HARD: addtime=0 usetime=0 bytes=1024
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending 0 ICMP plain Packet to DUT to expire Lifetime
byte in DUT
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 1000 bytes
IP: Identification         = 0x0190 (400)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2C58 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF76 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A2 (162)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [972 bytes] ---
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01               ............
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet

No Authenticated ICMP Echo Request packet received on
interface eth3 (30.1.1.150) (Remote Host) as expected
DUT correctly did not forward ICMP Echo Request packet
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 120

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=217  pid=0xf65530
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -lh 120 -bh 1024
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=218  pid=0xf65530
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
    HARD: addtime=120 usetime=0 bytes=1024
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=219  pid=0xf65530
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0xf65530
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25445 usetime=0 bytes=0
    HARD: addtime=120 usetime=0 bytes=1024
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0191 (401)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3013 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED57 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A3 (163)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x155B (5467)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x277C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3B A0 3E 56 FE 40 B8 44 6B 65 F3 A6               ;.>V.@.Dke..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0191 (401)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3113 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED57 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A3 (163)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting 120 seconds to expire SA Lifetime
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0192 (402)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3012 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED56 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A4 (164)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

! Unexpected IP packet received from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0192 (402)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3112 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED56 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A4 (164)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

No Authenticated ICMP Echo Request packet received on
interface DUT correctly did not forward ICMP Echo Request packet
 (eth3) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=221  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=222  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=223  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=224  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=225  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[180] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[181] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[179] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[182] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-5.3: Passed

>> IPSEC-AH-5.6
TEST_DESCRIPTION
IPSec MUST allow an interface to applications to obtain the information
about the mode of AH used in a received packet
(This test is for Transport Mode)
TEST_REFERENCE
RFC 4301 s4.4.2 p23 Security Association Database (SAD)
TEST_METHOD
- ANVL: Send an authenticated IP datagram to an application on the
        DUT side
- ANVL: Verify that the application on the DUT side is able to get
        the mode information
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> DUT Does not support transport Mode
cmd ipsecctrl flows
Flows:
[180] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[181] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[179] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[182] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 30.1.1.5 30.1.1.150 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=226  pid=0x107d050
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=227  pid=0x107d050
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 30.1.1.5 -dstflow  30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=228  pid=0x107d050
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=30.1.1.5/32
 DSTFLOW: addr=30.1.1.150/32
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=229  pid=0x107d050
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 30.1.1.5 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=230  pid=0x107d050
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=30.1.1.5/32
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.

Application on DUT is LISTENING for TRANSPORT mode information:
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
LISTEN TRANSPORT

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-check-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Application succesfully started listening for
the mode information. Sending Transport mode
Authenticated ICMP Echo Request packet to DUT
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to DUT virtual address 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x0193 (403)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A58 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 1 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000006 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D6 C6 C3 3B DF 0A 0A FC 25 6E 44 A9               ...;....%nD.
AH:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED55 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A5 (165)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Application on DUT is REPORTING for TRANSPORT mode information:
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
REPORT TRANSPORT

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-check-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Application succesfully obtained
the mode (Transport) information
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=231  pid=0xf1da20
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=232  pid=0xf1da20
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 30.1.1.5 -dstflow  30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=233  pid=0xf1da20
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=30.1.1.5/32
 DSTFLOW: addr=30.1.1.150/32
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=234  pid=0xf1da20
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 30.1.1.5 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=235  pid=0xf1da20
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=30.1.1.5/32
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-5.6: Passed

>> IPSEC-AH-5.7
TEST_DESCRIPTION
IPSec MUST allow an interface to applications to obtain the information
about the mode of AH used in a received packet
(This test is for Tunnel Mode)
TEST_REFERENCE
RFC 4301 s4.4.2 p23 Security Association Database (SAD)
TEST_METHOD
- ANVL: Send an authenticated IP datagram to an application on the
        DUT side
- ANVL: Verify that the application on the DUT side is able to get
        the mode information
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=236  pid=0x100eee0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=237  pid=0x100eee0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=238  pid=0x100eee0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=239  pid=0x100eee0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=240  pid=0x100eee0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[192] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[193] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[191] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[194] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Application on DUT is LISTENING for TUNNEL mode information:
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
LISTEN TUNNEL

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-check-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Application succesfully started listening for
the mode information. Sending Tunnel mode
Authenticated ICMP Echo Request packet to DUT
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0196 (406)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A41 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3B 30 44 0C 3D A6 B6 7E 16 9E 18 BD               ;0D.=..~....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0194 (404)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3010 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED54 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A6 (166)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0194 (404)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3110 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED54 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A6 (166)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Application on DUT is REPORTING for TUNNEL mode information:
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
REPORT TUNNEL

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-check-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Application succesfully obtained
the mode (Tunnel) information

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-5.7: Passed

>> IPSEC-AH-5.8
TEST_DESCRIPTION
IPSec MUST discard an inbound IP datagram if no policy is found in
the SPD that matches the packet
TEST_REFERENCE
NEGATIVE: RFC 4301 s5 p50 IP Traffic Processing
TEST_METHOD
- ANVL: Remove IPSec SA on the DUT with source address ANVL Remote
        Host address and destination address ANVL Local Address
- ANVL: Send an authenticated ICMP Echo-request from ANVL Remote Host
        to ANVL Local Host
-  DUT: Do not forward authenticated ICMP Echo Request to Local Host
- ANVL: Send an Authenticated ICMP Echo-request from Remote Host
-  DUT: Do not forward unauthenticated ICMP Echo-request to Local host
- ANVL: Restore default IPSec SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=241  pid=0x101c550
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=242  pid=0x101c550
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=243  pid=0x101c550
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=244  pid=0x101c550
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=245  pid=0x101c550
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[196] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[197] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[195] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[198] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Removing ANVL Local Address (40.1.1.150) and Remote Host Address (30.1.1.150)
from IPSec SAs configured on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipsecctrl flows
Flows:
[196] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[197] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[195] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[198] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=246  pid=0x100e9a0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=199
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -flowpri 10 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=247  pid=0x100e9a0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=200
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=248  pid=0x100e9a0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=201
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[196] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
exit
[199] :: deny src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: none
[200] :: deny pri=10 src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: none
[195] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[201] :: deny src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: none
Total of 5 flows.
-> Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0199 (409)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2FAD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 63 E2 08 95 FD 1B 90 CE 1F 0A B8 62               c..........b
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0197 (407)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x300D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED53 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A7 (167)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Correctly did not receive Authenticated IP packet on interface
eth4 (40.1.1.150) (Local Host)
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x019C (412)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A3B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000009 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6F 20 2B A8 C5 F5 0C D3 15 7D CA 7C               o +......}.|
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x019A (410)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x300A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED52 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A8 (168)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly did not receive Unauthenticated IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-5.8: Passed

>> IPSEC-AH-5.9
TEST_DESCRIPTION
IPSec MUST discard outbound IP datagram if SPD entry of datagram
does not point to a matching SA(in case of PROTECT) AND there is 
no key-management entity
TEST_REFERENCE
NEGATIVE: RFC 4301 s5.1(3b) p53 Outbound IP Traffic Processing
(protected-to-unprotected)
TEST_METHOD
- ANVL: Remove the ANVL Local and Remote Host IP addresses from the
        IPSec SAs on the DUT
- ANVL: Send an Authenticated ICMP Echo-request from Remote Host
-  DUT: Do not forward Authenticated ICMP Echo-request to Local host
- ANVL: Send an Authenticated ICMP Echo-request from Remote Host
-  DUT: Do not forward Unauthenticated ICMP Echo-request to Local host
- ANVL: Restore DUT IPSec SAs
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=249  pid=0xf5af60
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=250  pid=0xf5af60
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=251  pid=0xf5af60
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=252  pid=0xf5af60
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=253  pid=0xf5af60
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[203] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[204] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[202] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[205] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Removing ANVL Local Address (40.1.1.150) and Remote Host Address (30.1.1.150)
from IPSec SAs configured on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipsecctrl flows
Flows:
[203] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[204] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[202] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[205] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=254  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=206
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -flowpri 10 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=255  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=207
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=256  pid=0xf7d010
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=208
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[203] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[206] :: deny src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: none
exit
[207] :: deny pri=10 src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: none
[202] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[208] :: deny src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: none
Total of 5 flows.
-> Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x019F (415)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2FA7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 69 DA 3C 4C 4F C6 08 FA BE CD 22 01               i.<LO.....".
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x019D (413)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3007 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED51 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A9 (169)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Correctly did not receive Authenticated ICMP packet on
interface eth4 (40.1.1.150) (Local Host)
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01A2 (418)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A35 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5F F8 C0 55 C8 84 7A 13 4F E6 6F 6E               _..U..z.O.on
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01A0 (416)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3004 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED50 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AA (170)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet

Correctly did not receive Unauthenticated ICMP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-5.9: Passed

>> IPSEC-AH-5.10
TEST_DESCRIPTION
For inbound processing, for unicast SAs, the SPI is used either alone
to look up an SA or in conjunction with the IPsec protocol type.
IPSec MUST discard an incoming IP datagram containing a SPI and protocolentry for which no corresponding entry exists in the SAD.
TEST_REFERENCE
NEGATIVE: RFC 4301 s4.4.2 p35 Security Association Database
TEST_METHOD
- ANVL: Send authenticated IP packet from Remote Host with one of the
        elements <e> of the 2-tuple <Protocol, SPI>
        not matching the SA configuration
-  DUT: Do not forward IP packet, to Local Host
- CASE: <e> = SPI
- CASE: <e> = Protocol
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=257  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=258  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=259  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=260  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=261  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[210] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[211] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[209] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[212] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending packets having some BAD value for SPI


Case: Set the SPI Value to 778 in AH Header - Wrong SPI


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01A5 (421)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A32 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x0000030A 
AH: Sequence Number          = 0x0000000C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8E 90 8B 77 61 EA AC D5 1A DC 3A 00               ...wa.....:.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01A3 (419)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3001 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AB (171)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly, no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Now sending packets having correct SPI but wrong 
Outer Protocol


Case: Set the Protocol to 50 in Outer IP Header


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01A7 (423)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3A31 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000D 
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01A6 (422)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FFE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AC (172)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  51 C3 05 99 4D A5 9C C6 CB FB 82 36               Q...M......6
ESP: --- Authentication Data End ---
ESP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000D 
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01A6 (422)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FFE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AC (172)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  51 C3 05 99 4D A5 9C C6 CB FB 82 36               Q...M......6
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IP Packet
Correctly, didnot receive IP packet received on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-5.10: Passed

>> IPSEC-AH-5.11
TEST_DESCRIPTION
If an entire IP-datagram does not get delivered during the SA
lifetime the packet SHOULD be discarded
TEST_REFERENCE
RFC 4301 s4.4.2 p37 Security Association Database (SAD)
TEST_METHOD
- ANVL: Configure IPSec SA on the DUT with a lifetime
        of <LifeTimeBytes> bytes
-SETUP: Configure lifetime seconds on DUT such that
        SA doesnt get expired
- ANVL: Send as many ICMP Echo-requests as possible within the
        Lifetime from Local Host to expire the lifetime bytes
-  DUT: Forward the corresponding authenticated ICMP Echo-requests
        to Remote Host
- ANVL: Send ICMP Echo Request of size 44 bytes
-  DUT: Do not send the authenticated ICMP Echo Request
- ANVL: Restore default IPSec SA on the DUT
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=262  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=263  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=264  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=265  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=266  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[214] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[215] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[213] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[216] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-set-sa-lifetime-bytes-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm update -spi 302 -proto ah -src 30.1.1.5 -dst 30.1.1.150 -bh 1024
SADB_MSG: msgtype=UPDATE  err=0  satype=AH  len=112  seq=267  pid=0xf7d010
      SA: spi=302  sta=MATURE  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
    HARD: addtime=0 usetime=0 bytes=1024
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 120

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=268  pid=0x10748e0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -lh 120 -bh 1024
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=269  pid=0x10748e0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
    HARD: addtime=120 usetime=0 bytes=1024
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=270  pid=0x10748e0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x10748e0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25666 usetime=0 bytes=0
    HARD: addtime=120 usetime=0 bytes=1024
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending 0 ICMP plain Packet to DUT to expire Lifetime
byte in DUT.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 1000 bytes
IP: Identification         = 0x01A8 (424)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2C40 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF6B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AD (173)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [972 bytes] ---
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01               ............
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Correctly, no AH packets received on interface
eth3 (30.1.1.150) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=272  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=273  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=274  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=275  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=276  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[221] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[222] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[220] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[223] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-5.11: Passed

>> IPSEC-AH-6.1
TEST_DESCRIPTION
IPSec MUST allow an management interface to specify the security
processing for outbound traffic based on some SA value(e.g. Destination
IP Address) 
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add entry in DUT's SPD to discard datagrams to be sent to the
        Remote Host's IP address
- ANVL: Send ICMP Echo-request from Local Host to Remote Host
-  DUT: Do not forward ICMP Echo-request to Remote Host
- ANVL: Reset entry in DUT's SPD to bypass security for datagrams to be
        sent to the Remote Host
- ANVL: Send ICMP Echo-request from Local Host
-  DUT: Forward the plain ICMP Echo-request to Remote Host
- ANVL: Reset entry in DUT's SPD to apply security for datagrams to be
        sent to the Remote Host
- ANVL: Send ICMP Echo-request from Local Host
-  DUT: Forward the authenticated ICMP Echo-request to Remote Host
- ANVL: Restore the Default SPD
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=277  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=278  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=279  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=280  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=281  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[225] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[226] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[224] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[227] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec for REMOTE Host(30.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 DISCARD REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=30.1.1.150

DUT_ACTION=DISCARD

HOST_TYPE=REMOTE

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.150 -dstflow 30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=282  pid=0x101c020
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.150/32
 DSTFLOW: addr=30.1.1.150/32
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=228
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=283  pid=0x101c020
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=25677 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0x101c020
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25677 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01A9 (425)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FFB (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AE (174)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT correctly did not forward any ICMP Echo Request packet
on interface eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec for REMOTE Host(30.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 BYPASS REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=30.1.1.150

DUT_ACTION=BYPASS

HOST_TYPE=REMOTE

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.150 -dstflow 30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=176  seq=284  pid=0xf0d2d0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.150/32
 DSTFLOW: addr=30.1.1.150/32
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=285  pid=0xf0d2d0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=25677 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0xf0d2d0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25677 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01AA (426)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FFA (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AF (175)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01AA (426)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30FA (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AF (175)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT correctly forwarded plain ICMP Echo Request packet
on interface eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec for REMOTE Host(30.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 APPLY REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=30.1.1.150

DUT_ACTION=APPLY

HOST_TYPE=REMOTE

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.150 -dstflow 30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=286  pid=0x101c020
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.150/32
 DSTFLOW: addr=30.1.1.150/32
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=287  pid=0x101c020
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=25677 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0x101c020
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25677 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01AB (427)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FF9 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B0 (176)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x1394 (5012)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2943 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6A D4 9A 94 31 A9 43 4E 67 56 C0 14               j...1.CNgV..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01AB (427)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30F9 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B0 (176)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

DUT correctly forwarded authenticated ICMP Echo Request packet
on interface eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.1: Passed

>> IPSEC-AH-6.2
TEST_DESCRIPTION
IPSec MUST allow an management interface to specify the security
processing for outbound traffic based on some SA value(e.g. Source
IP Address) 
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add entry in DUT's SPD to discard datagrams sent from
        Local Host
- ANVL: Send ICMP Echo-request from Local Host
-  DUT: Do not forward ICMP Echo-request to Remote Host
- ANVL: Reset entry in DUT's SPD to bypass security for datagrams sent
        from Local Host
- ANVL: Send ICMP Echo-request from Local Host
-  DUT: Forward the ICMP Echo-request to Remote Host
- ANVL: Reset entry in DUT's SPD to apply security for datagrams
        from the Local Host
- ANVL: Send ICMP Echo-request from Local Host
-  DUT: Forward the authenticated ICMP Echo-request to Remote Host
- ANVL: Restore the Default SPD
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=288  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=289  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=290  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=291  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=292  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[232] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[233] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[231] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[234] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec for LOCAL Host(40.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 DISCARD LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=40.1.1.150

DUT_ACTION=DISCARD

HOST_TYPE=LOCAL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.150 -dstflow 30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=293  pid=0xf0d840
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.150/32
 DSTFLOW: addr=30.1.1.150/32
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=235
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=294  pid=0xf0d840
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=25688 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0xf0d840
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25688 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01AC (428)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FF8 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED49 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B1 (177)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Correctly, no IP packet received on interface eth3 (30.1.1.150)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec for LOCAL Host(40.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=40.1.1.150

DUT_ACTION=BYPASS

HOST_TYPE=LOCAL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.150 -dstflow 30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=176  seq=295  pid=0xf836f0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.150/32
 DSTFLOW: addr=30.1.1.150/32
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=296  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=25688 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25688 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01AD (429)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FF7 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED48 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B2 (178)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01AD (429)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30F7 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED48 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B2 (178)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received expected Unauthenticated IP Packet on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec for LOCAL Host(40.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=40.1.1.150

DUT_ACTION=APPLY

HOST_TYPE=LOCAL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.150 -dstflow 30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=297  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.150/32
 DSTFLOW: addr=30.1.1.150/32
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=298  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=25688 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25688 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01AE (430)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FF6 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED47 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B3 (179)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x3AE2 (15074)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x01F5 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C3 59 A6 F4 95 0C CC 15 96 41 9B 8A               .Y.......A..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01AE (430)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30F6 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED47 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B3 (179)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

DUT correctly forwarded authenticated ICMP Echo Request packet
on interface eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.2: Passed

>> IPSEC-AH-6.3
TEST_DESCRIPTION
IPSec MUST allow an management interface to specify the security
processing for outbound traffic based on some SA value(e.g. Transport
Layer Protocol)
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add the following entry in the DUT SPD:  Discard datagrams
        sent using Transport Layer protocol <protocol>
- ANVL: Send an IP datagram using <protocol>, from Local Host
        through the DUT to Remote Host
-  DUT: Do not forward the IP datagram to Remote Host
- ANVL: Add the following entry in the DUT SPD:  Bypass IPsec while
        processing datagrams sent using Transport Layer protocol
        <protocol>
- ANVL: Send an IP datagram using <protocol>, from Local Host
        through the DUT to Remote Host
-  DUT: Forward the IP datagram to Remote Host
- ANVL: Add the following entry in the DUT SPD:  Use IPsec while
        processing datagrams sent using Transport Layer protocol
        <protocol>
- ANVL: Send an IP datagram using <protocol>, from Local Host
        through the DUT to Remote Host
-  DUT: Forward the authenticated IP datagram to Remote Host
- ANVL: Restore the DUT SPD
- CASE: <protocol> = TCP
- CASE: <protocol> = UDP
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=299  pid=0x101c880
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=300  pid=0x101c880
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=301  pid=0x101c880
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=302  pid=0x101c880
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=303  pid=0x101c880
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[239] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[240] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[238] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[241] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=304  pid=0x100f1c0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=242
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=305  pid=0x100f1c0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=25699 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0x100f1c0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25699 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01AF (431)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FF4 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Correctly, no IP packet received on interface eth3 (30.1.1.150)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=306  pid=0x1014a30
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=307  pid=0x1014a30
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=25699 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0x1014a30
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25699 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01B0 (432)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FF3 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01B0 (432)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x30F3 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Received expected Unauthenticated IP Packet on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=308  pid=0x100f1c0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=309  pid=0x100f1c0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=25699 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0x100f1c0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25699 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01B1 (433)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FF2 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0459 (1113)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3882 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B6 86 EA 75 4E 89 9E F6 A6 34 85 B0               ...uN....4..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01B1 (433)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x30F2 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected authenticated IP Packet on interface
eth3 (30.1.1.150) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=310  pid=0x100f1c0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=311  pid=0x100f1c0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=312  pid=0x100f1c0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=313  pid=0x100f1c0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=314  pid=0x100f1c0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[246] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[247] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[245] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[248] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=315  pid=0x107da30
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=249
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=316  pid=0x107da30
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=25709 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0x107da30
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25709 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01B2 (434)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FF2 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Correctly, no IP packet received on interface eth3 (30.1.1.150)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=317  pid=0x107da30
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=318  pid=0x107da30
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=25709 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0x107da30
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25709 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01B3 (435)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FF1 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01B3 (435)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x30F1 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received expected Unauthenticated IP Packet on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=319  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=320  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=25709 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=25709 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01B4 (436)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FF0 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xFF58 (65368)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3D8E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7A 73 D8 F3 93 5B 9E 3C 6C 27 3B 96               zs...[.<l';.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01B4 (436)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x30F0 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Received expected authenticated IP Packet on interface
eth3 (30.1.1.150) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=321  pid=0xf0d620
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=322  pid=0xf0d620
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=323  pid=0xf0d620
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=324  pid=0xf0d620
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=325  pid=0xf0d620
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[253] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[254] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[252] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[255] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.3: Passed

>> IPSEC-AH-6.4
TEST_DESCRIPTION
IPSec MAY allow an administrative interface to specify the security
processing for outbound traffic based on some SA value(e.g  TCP/UDP Source Ports)
TEST_REFERENCE
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add the following entry in the DUT SPD:  Discard datagrams
        sent from source port <port>
- ANVL: Send an IP datagram on source port <port>, from Local Host
        through the DUT to Remote Host
-  DUT: Do not forward the IP datagram to Remote Host
- ANVL: Add the following entry in the DUT SPD: Bypass IPsec while
        processing datagrams sent from source port <port>
- ANVL: Send an IP datagram on source port <port>, from Remote Host
        through the DUT to Local Host
-  DUT: Forward the IP datagram to Local Host
- ANVL: Add the following entry in the DUT SPD:  Use IPsec while
        processing datagrams sent from source port <port>
- ANVL: Send an IP datagram on source port <port>, from Local Host
        through the DUT to Remote Host
-  DUT: Forward the IP datagram to Remote Host
- ANVL: Restore the DUT SPD
- CASE: <Protocol> = TCP, <port> = 23
- CASE: <Protocol> = TCP, <port> = 69
- CASE: <Protocol> = UDP, <port> = 23
- CASE: <Protocol> = UDP, <port> = 69
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=326  pid=0x1000e50
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=327  pid=0x1000e50
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=328  pid=0x1000e50
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=329  pid=0x1000e50
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=330  pid=0x1000e50
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[257] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[258] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[256] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[259] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Source Port> = 23

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol and SOURCE Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=SOURCE

PORT_NUMBER=23

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -srcport 23 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=331  pid=0xf79380
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24 port=23
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=260
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01B5 (437)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FEE (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x13AB (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Correctly, no IP packet received on interface eth3 (30.1.1.150)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol and SOURCE Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=SOURCE

PORT_NUMBER=23

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -srcport 23 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=332  pid=0x107da30
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24 port=23
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01B6 (438)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FED (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x13AB (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01B6 (438)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x30ED (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x13AB (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Received expected Unauthenticated IP Packet on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol and SOURCE Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=SOURCE

PORT_NUMBER=23

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -srcport 23 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=333  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24 port=23
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01B7 (439)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FEC (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x13AB (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0xA814 (43028)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x94C6 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 94 A4 35 C4 33 E2 C1 7D 7F AF 73 54               ..5.3..}..sT
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01B7 (439)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x30EC (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x13AB (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected authenticated IP Packet on interface eth3 (30.1.1.150)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=334  pid=0xf7d010
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=335  pid=0xf7d010
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=336  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=337  pid=0xf7d010
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=338  pid=0xf7d010
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[264] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[265] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[263] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[266] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = TCP, <Source Port> = 69

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol and SOURCE Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=SOURCE

PORT_NUMBER=69

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -srcport 69 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=339  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24 port=69
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=267
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01B8 (440)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FEB (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x137D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Correctly, no IP packet received on interface eth3 (30.1.1.150)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol and SOURCE Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=SOURCE

PORT_NUMBER=69

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -srcport 69 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=340  pid=0xf65370
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24 port=69
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01B9 (441)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FEA (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x137D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01B9 (441)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x30EA (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x137D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Received expected Unauthenticated IP Packet on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol and SOURCE Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=SOURCE

PORT_NUMBER=69

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -srcport 69 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=341  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24 port=69
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01BA (442)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FE9 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x137D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x2946 (10566)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x1395 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 55 FE B1 11 05 63 FC 15 51 E7 37 EE               U....c..Q.7.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01BA (442)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x30E9 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x137D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected authenticated IP Packet on interface eth3 (30.1.1.150)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=342  pid=0x100ed70
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=343  pid=0x100ed70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=344  pid=0x100ed70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=345  pid=0x100ed70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=346  pid=0x100ed70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[271] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[272] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[270] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[273] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = UDP, <Source Port> = 23

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and SOURCE Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=SOURCE

PORT_NUMBER=23

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -srcport 23 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=347  pid=0xf79380
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24 port=23
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=274
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01BB (443)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FE9 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly, no IP packet received on interface eth3 (30.1.1.150)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and SOURCE Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=SOURCE

PORT_NUMBER=23

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -srcport 23 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=348  pid=0x5dfd00
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24 port=23
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01BC (444)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FE8 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01BC (444)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x30E8 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received expected Unauthenticated IP Packet on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and SOURCE Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=SOURCE

PORT_NUMBER=23

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -srcport 23 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=349  pid=0xf0d760
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24 port=23
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01BD (445)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FE7 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x40CD (16589)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xFC19 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 16 69 1B DA 63 A1 B0 34 63 70 B0 41               .i..c..4cp.A
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01BD (445)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x30E7 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Received expected authenticated IP Packet on interface eth3 (30.1.1.150)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=350  pid=0x100ed70
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=351  pid=0x100ed70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=352  pid=0x100ed70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=353  pid=0x100ed70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=354  pid=0x100ed70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[278] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[279] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[277] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[280] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = UDP, <Source Port> = 69

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and SOURCE Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=SOURCE

PORT_NUMBER=69

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -srcport 69 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=355  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24 port=69
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=281
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01BE (446)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FE6 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Correctly, no IP packet received on interface eth3 (30.1.1.150)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and SOURCE Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=SOURCE

PORT_NUMBER=69

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -srcport 69 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=356  pid=0xf836f0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24 port=69
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01BF (447)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FE5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01BF (447)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x30E5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received expected Unauthenticated IP Packet on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and SOURCE Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=SOURCE

PORT_NUMBER=69

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -srcport 69 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=357  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24 port=69
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01C0 (448)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FE4 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x40D8 (16600)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xFC0E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 01 1F ED DF 8E 08 AB 1D 41 4B DD EA               ........AK..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01C0 (448)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x30E4 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Received expected authenticated IP Packet on interface eth3 (30.1.1.150)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=358  pid=0x100ed70
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=359  pid=0x100ed70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=360  pid=0x100ed70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=361  pid=0x100ed70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=362  pid=0x100ed70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[285] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[286] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[284] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[287] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.4: Passed

>> IPSEC-AH-6.5
TEST_DESCRIPTION
IPSec MAY allow an administrative interface to specify the security
processing for outbound traffic based on some selector value(e.g TCP/UDP 
Destination Ports)
TEST_REFERENCE
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add the following entry in the DUT SPD:  Discard datagrams
        to be sent to destination port <port>
- ANVL: Send an authenticated IP datagram to destination port <port>,
        from Remote Host through the DUT to Local Host
-  DUT: Do not forward the IP datagram to Local Host
- ANVL: Add the following entry in the DUT SPD:  Bypass IPsec while
        processing datagrams to be sent to destination port <port>
- ANVL: Send an unauthenticated IP datagram to destination port <port>,
        from Local Host through the DUT to Remote Host
-  DUT: Forward the IP datagram to Remote Host
- ANVL: Add the following entry in the DUT SPD:  Use IPsec while
        processing datagrams to be sent to destination port <port>
- ANVL: Send an authenticated IP datagram to destination port <port>,
        from Remote Host through the DUT to Local Host
-  DUT: Forward the IP datagram to Local Host
- ANVL: Send an unauthenticated IP datagram on destination port <port>,
        from Local Host through the DUT to Remote Host
-  DUT: Do not forward the IP datagram to Remote Host
- CASE: <Protocol> = TCP, <port> = 23
- CASE: <Protocol> = TCP, <port> = 69
- CASE: <Protocol> = UDP, <port> = 23
- CASE: <Protocol> = UDP, <port> = 69
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=363  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=364  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=365  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=366  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=367  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[289] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[290] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[288] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[291] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = TCP, <Destination Port> = 23

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=DESTINATION

PORT_NUMBER=23

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -dstport 23 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=368  pid=0x1017fe0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=23
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=292
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01C1 (449)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FE2 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x3ABB (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Correctly, no IP packet received on interface eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=DESTINATION

PORT_NUMBER=23

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -dstport 23 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=369  pid=0xf836f0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=23
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01C2 (450)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FE1 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x3ABB (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01C2 (450)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x30E1 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x3ABB (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Received expected Unauthenticated IP Packet on interface eth3
(30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=DESTINATION

PORT_NUMBER=23

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -dstport 23 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=370  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=23
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01C3 (451)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FE0 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x3ABB (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0xD71C (55068)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x65BE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C9 EB C6 4E F6 16 1E AF 4C 35 56 9C               ...N....L5V.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01C3 (451)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x30E0 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x3ABB (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected authenticated IP Packet on interface eth3 (30.1.1.150)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=371  pid=0x101c540
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=372  pid=0x101c540
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=373  pid=0x101c540
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=374  pid=0x101c540
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=375  pid=0x101c540
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[296] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[297] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[295] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[298] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = TCP, <Destination Port> = 69

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=DESTINATION

PORT_NUMBER=69

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -dstport 69 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=376  pid=0xf5af60
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=69
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=299
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01C4 (452)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FDF (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x3A8D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly, no IP packet received on interface eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=DESTINATION

PORT_NUMBER=69

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -dstport 69 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=377  pid=0x5dfd00
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=69
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01C5 (453)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FDE (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x3A8D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01C5 (453)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x30DE (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x3A8D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Received expected Unauthenticated IP Packet on interface eth3
(30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=DESTINATION

PORT_NUMBER=69

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 6 -dstport 69 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=378  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=69
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01C6 (454)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FDD (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x3A8D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x914C (37196)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xAB8E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 81 0A 3A FF C6 58 B5 B0 F6 C5 D8 B5               ..:..X......
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01C6 (454)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x30DD (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x3A8D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected authenticated IP Packet on interface eth3 (30.1.1.150)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=379  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=380  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=381  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=382  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=383  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[303] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[304] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[302] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[305] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = UDP, <Destination Port> = 23

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and DESTINATION Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=23

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -dstport 23 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=384  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=23
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=306
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01C7 (455)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FDD (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Correctly, no IP packet received on interface eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and DESTINATION Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=23

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -dstport 23 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=385  pid=0xf836f0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=23
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01C8 (456)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FDC (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01C8 (456)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x30DC (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received expected Unauthenticated IP Packet on interface eth3
(30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and DESTINATION Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=23

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -dstport 23 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=386  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=23
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01C9 (457)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FDB (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x6045 (24645)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xDCA1 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 90 44 3F 51 32 BD 49 D9 E2 CC 8C 25               .D?Q2.I....%
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01C9 (457)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x30DB (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Received expected authenticated IP Packet on interface eth3 (30.1.1.150)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=387  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=388  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=389  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=390  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=391  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[310] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[311] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[309] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[312] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = UDP, <Destination Port> = 69

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and DESTINATION Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=69

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -dstport 69 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=392  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=69
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=313
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01CA (458)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FDA (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly, no IP packet received on interface eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and DESTINATION Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=69

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -dstport 69 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=393  pid=0x5dfd00
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=69
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01CB (459)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FD9 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01CB (459)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x30D9 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received expected Unauthenticated IP Packet on interface eth3
(30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and DESTINATION Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=69

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -dstport 69 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=394  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=69
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01CC (460)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FD8 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xD68A (54922)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x665C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 50 D3 B8 AA 4E 4C 29 16 B8 8D D6 BB               P...NL).....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01CC (460)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x30D8 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Received expected authenticated IP Packet on interface eth3 (30.1.1.150)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=395  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=396  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=397  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=398  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=399  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[317] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[318] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[316] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[319] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.5: Passed

>> IPSEC-AH-6.6
TEST_DESCRIPTION
IPSec MUST discard an inbound authenticated IP datagram having a
matching SA entry in its SAD but incompatible protocol mode
TEST_REFERENCE
NEGATIVE: RFC 2401 s5.2.1 p34 Selecting and Using an SA or SA Bundle
TEST_METHOD
- ANVL: Send an Transport mode authenticated ICMP Echo-request
-  DUT: Do not forward ICMP Echo-request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=400  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=401  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=402  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=403  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=404  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[321] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[322] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[320] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[323] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to DUT virtual address 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x01CD (461)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A1E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 1 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 21 9A CD 10 5B 7B EF BA F8 F4 59 95               !...[{....Y.
AH:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED46 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B4 (180)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0xF7E3 (63459)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x4451 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF546 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B4 (180)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly did not receive IP packet on interface eth4 (40.1.1.150)(Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.6: Passed

>> IPSEC-AH-6.7
TEST_DESCRIPTION
IPSec MUST allow an management interface to specify the security
processing for inbound traffic based on some SA value(e.g. Destination
IP Address) 
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add entry in DUT's SPD to discard datagrams to be sent to the
        Local Host's IP address
- ANVL: Send Authenticated ICMP Echo-request from Remote Host to
        Local Host
-  DUT: Do not forward unauthenticated ICMP Echo-request to Local Host
- ANVL: Reset entry in DUT's SPD to bypass security for datagrams to be
        sent to the Local Host
- ANVL: Send Authenticated ICMP Echo-request from Remote Host
-  DUT: Forward the Authenticated ICMP Echo-request to Local Host
- ANVL: Reset entry in DUT's SPD to apply security for datagrams to be
        sent to the Local Host
- ANVL: Send Authenticated ICMP Echo-request from Remote Host
-  DUT: Forward the unauthenticated ICMP Echo-request to Local Host
- ANVL: Restore the Default SPD
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=405  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=406  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=407  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=408  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=409  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[325] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[326] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[324] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[327] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec for LOCAL Host(40.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 DISCARD LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=410  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=328
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01D0 (464)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A07 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 42 6F 4F BB FE 74 AA C3 6C F8 7E A3               BoO..t..l.~.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01CE (462)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FD6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED45 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B5 (181)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly, no Unauthenticated IP packets received on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host(40.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=176  seq=411  pid=0x5dfd00
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01D3 (467)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F73 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000010 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 50 CD 14 F4 41 CB 5F B1 FB 9C 0B CB               P...A._.....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01D1 (465)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FD3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED44 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B6 (182)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01D3 (467)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3073 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000010 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 50 CD 14 F4 41 CB 5F B1 FB 9C 0B CB               P...A._.....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01D1 (465)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FD3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED44 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B6 (182)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly Received Authenticated IP Packet on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host(40.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=412  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01D6 (470)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3A01 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000011 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 98 2C 3A 8E 30 77 77 1B F7 BE B0 3E               .,:.0ww....>
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01D4 (468)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FD0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED43 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B7 (183)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01D4 (468)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30D0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED43 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B7 (183)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received Unauthenticated IP Packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.7: Passed

>> IPSEC-AH-6.8
TEST_DESCRIPTION
IPSec MUST allow an management interface to specify the security
processing for inbound traffic based on some SA value(e.g. Source
IP Address) 
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add entry in DUT's SPD to discard datagrams sent from
        Remote Host
- ANVL: Send Authenticated ICMP Echo-request from Remote Host
-  DUT: Do not forward unauthenticated ICMP Echo-request to Local Host
- ANVL: Reset entry in DUT's SPD to bypass security for datagrams sent
        from Remote Host
- ANVL: Send Authenticated ICMP Echo-request from Remote Host
-  DUT: Forward the Authenticated ICMP Echo-request to Local Host
- ANVL: Reset entry in DUT's SPD to apply security for datagrams
        from the Remote Host
- ANVL: Send Authenticated ICMP Echo-request from Remote Host
-  DUT: Forward the unauthenticated ICMP Echo-request to Local Host
- ANVL: Restore the Default SPD
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=413  pid=0xf7d010
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=414  pid=0xf7d010
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=415  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=416  pid=0xf7d010
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=417  pid=0xf7d010
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[332] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[333] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[331] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[334] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec for REMOTE Host(30.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 DISCARD REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=418  pid=0xf5af60
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=335
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01D9 (473)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39FE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000012 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 1D 62 D1 0A 1A 9A 86 AB 1B FF 9B 2E               .b..........
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01D7 (471)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FCD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED42 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B8 (184)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly, No Unauthenticated IP packets received on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec for REMOTE Host(30.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 BYPASS REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=176  seq=419  pid=0x5dfd00
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01DC (476)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F6A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000013 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 51 57 3E 0C 3B EF B8 21 25 1F 1E 4D               QW>.;..!%..M
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01DA (474)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FCA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED41 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B9 (185)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01DC (476)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x306A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000013 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 51 57 3E 0C 3B EF B8 21 25 1F 1E 4D               QW>.;..!%..M
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01DA (474)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FCA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED41 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B9 (185)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly Received Authenticated IP Packet on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec for REMOTE Host(30.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 APPLY REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=420  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01DF (479)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39F8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000014 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 4C 05 84 71 7B 41 FC 24 27 69 03 74               L..q{A.$'i.t
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01DD (477)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FC7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED40 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BA (186)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01DD (477)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30C7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED40 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BA (186)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received Unauthenticated IP Packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.8: Passed

>> IPSEC-AH-6.9
TEST_DESCRIPTION
IPSec MUST allow an management interface to specify the security
processing for inbound traffic based on some SA value(e.g. Transport
Layer Protocol)
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add the following entry in the DUT SPD:  Discard datagrams
        sent using Transport Layer protocol <protocol>
- ANVL: Send an authenticated IP datagram using <protocol>, from
        Remote Host through the DUT to Local Host
-  DUT: Do not forward the unauthenticated IP datagram to Local Host
- ANVL: Add the following entry in the DUT SPD:  Bypass IPsec while
        processing datagrams sent using Transport Layer protocol
        <protocol>
- ANVL: Send an Authenticated IP datagram using <protocol>, from
        Remote Host through the DUT to Local Host
-  DUT: Forward the Authenticated IP datagram to Local Host
- ANVL: Add the following entry in the DUT SPD:  Use IPsec while
        processing datagrams sent using Transport Layer protocol
        <protocol>
- ANVL: Send an Authenticated IP datagram using <protocol>, from
        Remote Host through the DUT to Remote Host
-  DUT: Forward the unauthenticated IP datagram to Local Host
- ANVL: Restore the DUT SPD
- CASE: <protocol> = ICMP
- CASE: <protocol> = TCP
- CASE: <protocol> = UDP
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=421  pid=0x100f1e0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=422  pid=0x100f1e0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=423  pid=0x100f1e0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=424  pid=0x100f1e0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=425  pid=0x100f1e0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[339] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[340] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[338] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[341] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = ICMP

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for icmp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=128  seq=426  pid=0x100ecb0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 0 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=427  pid=0x100ecb0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=342
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[339] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[342] :: deny src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: none
[338] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[341] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01E2 (482)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39F5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000015 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 18 0B 2B A4 55 86 50 09 DA 9C DE B8               ..+.U.P.....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01E0 (480)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FC4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BB (187)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly, No Unauthenticated IP packets received on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for icmp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 0 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=428  pid=0x1000e50
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[339] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[343] :: bypass src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: BYPS
[338] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[341] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01E5 (485)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F61 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000016 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 60 8C 5E F4 A3 FC 2F 7B 34 44 19 92               `.^.../{4D..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01E3 (483)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FC1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BC (188)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01E5 (485)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3061 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000016 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 60 8C 5E F4 A3 FC 2F 7B 34 44 19 92               `.^.../{4D..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01E3 (483)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FC1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BC (188)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly Received Authenticated IP Packet on interface
eth3 (40.1.1.150)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for icmp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 0 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=429  pid=0x100eda0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[339] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[344] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[338] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[341] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x01E8 (488)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39EF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000017 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 50 2B B3 24 42 EF E9 A0 C4 E8 2C 5F               P+.$B.....,_
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01E6 (486)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2FBE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BD (189)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x01E6 (486)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30BE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BD (189)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received Unauthenticated IP Packet on interface
eth4 (40.1.1.150)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=430  pid=0x10743b0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=431  pid=0x10743b0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=432  pid=0x10743b0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=433  pid=0x10743b0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=434  pid=0x10743b0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[346] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[347] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[345] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[348] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=128  seq=435  pid=0xf836f0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=436  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=349
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[346] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[349] :: deny src=30.1.1.0/24:any dst=40.1.1.0/24:any TCP  <- SA: none
[345] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[348] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x01EB (491)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39F0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000018 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: DD 12 0E 67 56 CC 49 E3 71 53 E7 C3               ...gV.I.qS..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01E9 (489)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FBA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xECB0*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IP Packet
Correctly, No Unauthenticated IP packets received on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=437  pid=0x1000e50
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[346] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[350] :: bypass src=30.1.1.0/24:any dst=40.1.1.0/24:any TCP  <- SA: BYPS
[345] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[348] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x01EE (494)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F5C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000019 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 28 BE 8C 6D 6D AE C5 8F C5 65 9D C9               (..mm....e..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01EC (492)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FB7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xECB0*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x01EE (494)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x305C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000019 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 28 BE 8C 6D 6D AE C5 8F C5 65 9D C9               (..mm....e..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01EC (492)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FB7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xECB0*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Authenticated IP Packet on interface
eth3 (40.1.1.150)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=438  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[346] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[351] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any TCP  <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[345] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[348] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x01F1 (497)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39EA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 56 FE 3D E0 41 8D 59 C4 C0 84 58 4D               V.=.A.Y...XM
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01EF (495)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FB4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xECB0*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01EF (495)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x30B4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xECB0*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Correctly Received Unauthenticated IP Packet on interface
eth4 (40.1.1.150)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=439  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=440  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=441  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=442  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=443  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[353] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[354] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[352] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[355] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=128  seq=444  pid=0x101cb70
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=445  pid=0x101cb70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=356
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[353] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[356] :: deny src=30.1.1.0/24:any dst=40.1.1.0/24:any UDP  <- SA: none
[352] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[355] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x01F4 (500)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39F3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 19 F6 56 A8 0E 9E 48 EA 7F 33 90 4C               ..V...H..3.L
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01F2 (498)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FB2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IP Packet
Correctly, No Unauthenticated IP packets received on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=446  pid=0x1000e50
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[353] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[357] :: bypass src=30.1.1.0/24:any dst=40.1.1.0/24:any UDP  <- SA: BYPS
[352] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[355] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x01F7 (503)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F5F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8D 3D 75 B0 BD 38 4B C0 E1 22 A4 3F               .=u..8K..".?
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01F5 (501)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FAF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x01F7 (503)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x305F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8D 3D 75 B0 BD 38 4B C0 E1 22 A4 3F               .=u..8K..".?
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01F5 (501)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FAF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Authenticated IP Packet on interface
eth3 (40.1.1.150)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for udp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=447  pid=0xf0d020
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[353] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[358] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any UDP  <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[352] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[355] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x01FA (506)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39ED (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 22 E4 89 47 2D CA CC A7 9F A6 9C B0               "..G-.......
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01F8 (504)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2FAC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x01F8 (504)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x30AC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received Unauthenticated IP Packet on interface
eth4 (40.1.1.150)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=448  pid=0xf0d020
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=449  pid=0xf0d020
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=450  pid=0xf0d020
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=451  pid=0xf0d020
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=452  pid=0xf0d020
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[360] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[361] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[359] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[362] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.9: Passed

>> IPSEC-AH-6.10
TEST_DESCRIPTION
IPSec MAY allow an administrative interface to specify the security
processing for inbound traffic based on some SA value(e.g  TCP/UDP Source Ports)
TEST_REFERENCE
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add the following entry in the DUT SPD: Discard datagrams
        sent with source port <port>
- ANVL: Send an Authenticated IP datagram with source port <port> and,
        Transport protocol <Protocol> from Remote Host through the DUT to
        Local Host
-  DUT: Do not forward the unauthenticated IP datagram to Local Host
- ANVL: Add the following entry in the DUT SPD: Bypass IPsec while
        processing datagrams sent with source port <port>
- ANVL: Send an Authenticated IP datagram with source port <port> and
        Transport protocol <Protocol>, from Remote Host through the DUT
        to Local Host
-  DUT: Forward the authenticated IP datagram to Local Host
- ANVL: Add the following entry in the DUT SPD:  Use IPsec while
        processing datagrams sent with source port <port>
- ANVL: Send an authenticated IP datagram with source port <port> and
        Transport protocol <Protocol> ,from Remote Host through the DUT
        to Local Host
-  DUT: Forward the unauthenticated IP datagram to Local Host
- ANVL: Restore the DUT SPD
- CASE: <Protocol> = TCP, <port> = 23
- CASE: <Protocol> = TCP, <port> = 69
- CASE: <Protocol> = UDP, <port> = 23
- CASE: <Protocol> = UDP, <port> = 69
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=453  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=454  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=455  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=456  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=457  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[364] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[365] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[363] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[366] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Source Port> = 23

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport protocol and SOURCE port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=SOURCE

PORT_NUMBER=23

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=128  seq=458  pid=0x5dfd00
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -srcport 23 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=459  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24 port=23
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=367
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x01FD (509)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39DE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 4E 6E A8 30 A5 17 69 5E 44 62 33 14               Nn.0..i^Db3.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01FB (507)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FA8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x13AB*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IP Packet
Correctly, no Unauthenticated IP packets received on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport protocol and SOURCE port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=SOURCE

PORT_NUMBER=23

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -srcport 23 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=460  pid=0x5dfd00
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24 port=23
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0200 (512)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F4A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: CC B5 98 E0 60 46 33 F8 80 A5 99 F0               ....`F3.....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01FE (510)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FA5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x13AB*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0200 (512)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x304A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: CC B5 98 E0 60 46 33 F8 80 A5 99 F0               ....`F3.....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x01FE (510)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FA5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x13AB*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Authenticated IP Packet on interface
eth3 (40.1.1.150)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport protocol and SOURCE port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=SOURCE

PORT_NUMBER=23

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -srcport 23 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=461  pid=0x1000e50
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24 port=23
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0203 (515)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39D8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000020 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C3 7E 5B 4A 16 64 13 D6 F2 B7 E2 3C               .~[J.d.....<
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0201 (513)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2FA2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x13AB*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0201 (513)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x30A2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x13AB*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Correctly Received Unauthenticated IP Packet on interface
eth4 (40.1.1.150) (Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=462  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=463  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=464  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=465  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=466  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[371] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[372] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[370] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[373] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Source Port> = 69

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport protocol and SOURCE port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=SOURCE

PORT_NUMBER=69

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=128  seq=467  pid=0x101c7b0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -srcport 69 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=468  pid=0x101c7b0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24 port=69
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=374
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0206 (518)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39D5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000021 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5B 62 90 98 9E E6 6F 60 2D 7D BB D2               [b....o`-}..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0204 (516)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2F9F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x137D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IP Packet
Correctly, no Unauthenticated IP packets received on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport protocol and SOURCE port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=SOURCE

PORT_NUMBER=69

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -srcport 69 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=469  pid=0xf836f0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24 port=69
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0209 (521)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F41 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000022 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A0 57 27 C0 10 8B 66 94 88 EC 35 FA               .W'...f...5.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0207 (519)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2F9C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x137D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0209 (521)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3041 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000022 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A0 57 27 C0 10 8B 66 94 88 EC 35 FA               .W'...f...5.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0207 (519)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2F9C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x137D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Authenticated IP Packet on interface
eth3 (40.1.1.150)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport protocol and SOURCE port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=SOURCE

PORT_NUMBER=69

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -srcport 69 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=470  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24 port=69
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x020C (524)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39CF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000023 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 02 9C F6 28 2B CD 82 91 E0 59 11 F3               ...(+....Y..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x020A (522)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2F99 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x137D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x020A (522)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x3099 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x137D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Correctly Received Unauthenticated IP Packet on interface
eth4 (40.1.1.150) (Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=471  pid=0x100eb60
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=472  pid=0x100eb60
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=473  pid=0x100eb60
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=474  pid=0x100eb60
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=475  pid=0x100eb60
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[378] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[379] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[377] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[380] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Source Port> = 23

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport protocol and SOURCE port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=SOURCE

PORT_NUMBER=23

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=128  seq=476  pid=0x1000e50
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -srcport 23 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=477  pid=0x1000e50
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24 port=23
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=381
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x020F (527)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39D8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000024 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: E4 95 09 70 36 61 6C D0 68 36 D2 E9               ...p6al.h6..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x020D (525)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F97 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IP Packet
Correctly, no Unauthenticated IP packets received on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport protocol and SOURCE port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=SOURCE

PORT_NUMBER=23

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -srcport 23 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=478  pid=0xf836f0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24 port=23
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0212 (530)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F44 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000025 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B2 7A 33 F6 27 8C AD C7 A9 D0 C2 CF               .z3.'.......
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0210 (528)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F94 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0212 (530)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3044 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000025 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B2 7A 33 F6 27 8C AD C7 A9 D0 C2 CF               .z3.'.......
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0210 (528)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F94 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Authenticated IP Packet on interface
eth3 (40.1.1.150)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for udp transport protocol and SOURCE port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=SOURCE

PORT_NUMBER=23

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -srcport 23 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=479  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24 port=23
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0215 (533)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39D2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000026 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 46 3B 07 5D 83 91 FB 88 E7 77 FD 16               F;.].....w..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0213 (531)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F91 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0213 (531)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3091 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received Unauthenticated IP Packet on interface
eth4 (40.1.1.150) (Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=480  pid=0xf7d010
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=481  pid=0xf7d010
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=482  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=483  pid=0xf7d010
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=484  pid=0xf7d010
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[385] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[386] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[384] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[387] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Source Port> = 69

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport protocol and SOURCE port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=SOURCE

PORT_NUMBER=69

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=128  seq=485  pid=0xf5af60
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -srcport 69 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=486  pid=0xf5af60
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24 port=69
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=388
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0218 (536)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39CF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000027 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 80 5C D1 87 0F 28 FB C2 38 9A A4 5E               .\...(..8..^
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0216 (534)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F8E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IP Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly, no Unauthenticated IP packets received on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport protocol and SOURCE port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=SOURCE

PORT_NUMBER=69

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -srcport 69 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=487  pid=0xf836f0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24 port=69
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x021B (539)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F3B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000028 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6E 36 9A BE D9 38 41 15 95 B6 41 0B               n6...8A...A.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0219 (537)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F8B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x021B (539)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x303B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000028 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6E 36 9A BE D9 38 41 15 95 B6 41 0B               n6...8A...A.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0219 (537)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F8B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Authenticated IP Packet on interface
eth3 (40.1.1.150)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for udp transport protocol and SOURCE port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=SOURCE

PORT_NUMBER=69

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -srcport 69 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=488  pid=0xf0d020
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24 port=69
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x021E (542)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39C9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000029 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C0 59 E4 E7 87 F9 44 B0 6F F6 52 14               .Y....D.o.R.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x021C (540)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F88 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x021C (540)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3088 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received Unauthenticated IP Packet on interface
eth4 (40.1.1.150) (Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=489  pid=0x100efc0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=490  pid=0x100efc0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=491  pid=0x100efc0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=492  pid=0x100efc0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=493  pid=0x100efc0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[392] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[393] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[391] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[394] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.10: Passed

>> IPSEC-AH-6.11
TEST_DESCRIPTION
IPSec MAY allow an administrative interface to specify the security
processing for inbound traffic based on some SA value(e.g  TCP/UDP Destination  Ports)
TEST_REFERENCE
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add the following entry in the DUT SPD: Discard datagrams
        sent with destination port <port>
- ANVL: Send an Authenticated IP datagram with destination port <port>
        and, Transport protocol <Protocol> from Remote Host through
        the DUT to Local Host
-  DUT: Do not forward the unauthenticated IP datagram to Local Host
- ANVL: Add the following entry in the DUT SPD: Bypass IPsec while
        processing datagrams sent with destination port <port>
- ANVL: Send an Authenticated IP datagram with destination port <port>
        and Transport protocol <Protocol>, from Remote Host through
        the DUT to Local Host
-  DUT: Forward the authenticated IP datagram to Local Host
- ANVL: Add the following entry in the DUT SPD:  Use IPsec while
        processing datagrams sent with destination port <port>
- ANVL: Send an authenticated IP datagram with destination port <port>
        and Transport protocol <Protocol> ,from Remote Host through
        the DUT to Local Host
-  DUT: Forward the unauthenticated IP datagram to Local Host
- ANVL: Restore the DUT SPD
- CASE: <Protocol> = TCP, <port> = 23
- CASE: <Protocol> = TCP, <port> = 69
- CASE: <Protocol> = UDP, <port> = 23
- CASE: <Protocol> = UDP, <port> = 69
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=494  pid=0xf7d010
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=495  pid=0xf7d010
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=496  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=497  pid=0xf7d010
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=498  pid=0xf7d010
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[396] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[397] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[395] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[398] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Destination Port> = 23

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport protocol and DESTINATION port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=DESTINATION

PORT_NUMBER=23

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=128  seq=499  pid=0xf7d010
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -dstport 23 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=500  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24 port=23
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=399
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0221 (545)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39BA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D2 BA DD 5B 1D BC 57 59 82 8B 6F E5               ...[..WY..o.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x021F (543)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2F84 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x3ABB*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IP Packet
Correctly, no Unauthenticated IP packets received on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport protocol and DESTINATION port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=DESTINATION

PORT_NUMBER=23

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -dstport 23 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=501  pid=0x1000e50
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24 port=23
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0224 (548)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F26 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C7 7D E5 B3 17 87 20 7F 4B 10 EE FD               .}.... .K...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0222 (546)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2F81 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x3ABB*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0224 (548)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3026 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C7 7D E5 B3 17 87 20 7F 4B 10 EE FD               .}.... .K...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0222 (546)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2F81 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x3ABB*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Authenticated IP Packet on interface
eth3 (40.1.1.150)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport protocol and DESTINATION port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=DESTINATION

PORT_NUMBER=23

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -dstport 23 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=502  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24 port=23
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0227 (551)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39B4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 43 2D 90 A4 65 29 65 CF 1A 85 8E 3C               C-..e)e....<
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0225 (549)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2F7E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x3ABB*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0225 (549)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x307E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x3ABB*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Correctly Received Unauthenticated IP Packet on interface
eth4 (40.1.1.150)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=503  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=504  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=505  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=506  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=507  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[403] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[404] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[402] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[405] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Destination Port> = 69

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport protocol and DESTINATION port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=DESTINATION

PORT_NUMBER=69

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=128  seq=508  pid=0x100f130
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -dstport 69 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=509  pid=0x100f130
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24 port=69
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=406
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x022A (554)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39B1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A7 BB A3 D4 DE C1 6D B6 0B 20 22 B2               ......m.. ".
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0228 (552)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2F7B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x3A8D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IP Packet
Correctly, no Unauthenticated IP packets received on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport protocol and DESTINATION port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=DESTINATION

PORT_NUMBER=69

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -dstport 69 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=510  pid=0x1000e50
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24 port=69
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x022D (557)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F1D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5D 1A A3 8A A3 E0 EA 57 FB 88 DE B4               ]......W....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x022B (555)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2F78 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x3A8D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x022D (557)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x301D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5D 1A A3 8A A3 E0 EA 57 FB 88 DE B4               ]......W....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x022B (555)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2F78 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x3A8D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Authenticated IP Packet on interface
eth3 (40.1.1.150)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport protocol and DESTINATION port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=tcp

PORT_TYPE=DESTINATION

PORT_NUMBER=69

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -dstport 69 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=511  pid=0x101c6e0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=TCP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24 port=69
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0230 (560)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39AB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F1 42 F1 F5 9C 88 AB 5E 75 3D A6 F5               .B.....^u=..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x022E (558)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x2F75 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x3A8D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x022E (558)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x3075 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x3A8D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Correctly Received Unauthenticated IP Packet on interface
eth4 (40.1.1.150)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=512  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=513  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=514  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=515  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=516  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[410] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[411] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[409] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[412] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Destination Port> = 23

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport protocol and DESTINATION port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=23

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=128  seq=517  pid=0x1000e50
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -dstport 23 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=518  pid=0x1000e50
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24 port=23
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=413
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0233 (563)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39B4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000030 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: BF C2 98 6A 8B C4 A3 A9 49 1A 9D DA               ...j....I...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0231 (561)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F73 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IP Packet
Correctly, no Unauthenticated IP packets received on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport protocol and DESTINATION port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=23

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -dstport 23 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=519  pid=0x100f190
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24 port=23
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0236 (566)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F20 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000031 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 81 1A DF 59 01 10 6A 55 06 63 EA 09               ...Y..jU.c..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0234 (564)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F70 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0236 (566)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3020 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000031 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 81 1A DF 59 01 10 6A 55 06 63 EA 09               ...Y..jU.c..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0234 (564)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F70 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Authenticated IP Packet on interface
eth3 (40.1.1.150)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for udp transport protocol and DESTINATION port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=23

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -dstport 23 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=520  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24 port=23
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0239 (569)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39AE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000032 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 63 97 30 86 35 72 94 07 84 24 EA 87               c.0.5r...$..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0237 (567)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F6D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0237 (567)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x306D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received Unauthenticated IP Packet on interface
eth4 (40.1.1.150)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=521  pid=0x101c550
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=522  pid=0x101c550
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=523  pid=0x101c550
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=524  pid=0x101c550
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=525  pid=0x101c550
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[417] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[418] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[416] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[419] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Destination Port> = 69

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport protocol and DESTINATION port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=69

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=128  seq=526  pid=0x100eed0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -dstport 69 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=527  pid=0x100eed0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24 port=69
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=420
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x023C (572)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39AB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000033 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3B ED 23 C7 95 CF B0 1A C0 63 A1 48               ;.#......c.H
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x023A (570)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F6A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IP Packet
Correctly, no Unauthenticated IP packets received on interface
eth4 (40.1.1.150) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport protocol and DESTINATION port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=69

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -dstport 69 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=528  pid=0x1014a30
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24 port=69
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x023F (575)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F17 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000034 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 0C BE DE E2 E1 66 8C 88 68 D0 86 DE               .....f..h...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x023D (573)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F67 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x023F (575)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3017 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000034 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 0C BE DE E2 E1 66 8C 88 68 D0 86 DE               .....f..h...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x023D (573)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F67 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Authenticated IP Packet on interface
eth3 (40.1.1.150)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for udp transport protocol and DESTINATION port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=69

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -dstport 69 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=529  pid=0x101c020
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
PROTOCOL: proto=UDP 
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24 port=69
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0242 (578)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39A5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000035 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5D 80 31 51 E9 DE 65 92 E5 EC 61 22               ].1Q..e...a"
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0240 (576)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F64 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0240 (576)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3064 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received Unauthenticated IP Packet on interface
eth4 (40.1.1.150)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=530  pid=0x100e9a0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=531  pid=0x100e9a0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=532  pid=0x100e9a0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=533  pid=0x100e9a0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=534  pid=0x100e9a0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[424] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[425] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[423] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[426] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.11: Passed

>> IPSEC-AH-6.12
TEST_DESCRIPTION
The authentication provided to a authenticated inbound IP packet
depends on the order in which multiple matching entries are created
in SPD.
TEST_REFERENCE
RFC 4301 p21 s4.4.1 Security Policy Database
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that inbound authenticated
        IP-datagrams via interface D1 with outer IP Destination
        Address within Subnet-2 (specified using address + mask) are
        bypassed. Add another entry in the DUT's SPD such that
        inbound authenticated IP-datagrams with outer IP Destination Address
        set to A2 Addr, are processed using IPSec
- ANVL: Send authenticated ICMP Echo Request, from Remote Host
-  DUT: Forward authenticated ICMP Echo Request, to Local Host
- ANVL: Delete all SPD entries in DUT. Add the SPD entries again, but
        in reverse order (the SPD entry for Subnet-2 which was earlier
        added first is added second this time)
- ANVL: Send authenticated ICMP Echo Request, from Remote Host
-  DUT: Forward unauthenticated ICMP Echo Request, to Local Host
- ANVL: Delete all SPD entries in DUT. Add entry in the DUT's SPD such
        that inbound authenticated IP-datagrams via interface D1, with inner
        IP-Header Destination Address within Subnet-2 (specified using
        address + mask) are processed using IPsec. Add another entry
        in the DUT's SPD such that inbound authenticated IP-datagrams with
        inner IP-Header Destination Address set to A2 Addr,
        are bypassed
- ANVL: Send authenticated ICMP Echo Request, from Remote Host
-  DUT: Forward unauthenticated ICMP Echo Request, to Local Host
- ANVL: Delete all SPD entries in DUT. Add the SPD entries again just
        as last time, except that the entry for Subnet-2 is added
        second
- ANVL: Send authenticated ICMP Echo Request, from Remote Host
-  DUT: Forward authenticated ICMP Echo Request, to Local Host
- ANVL: Restore default SA and SPD between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=535  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=536  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=537  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=538  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=539  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[428] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[429] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[427] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[430] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Removing ANVL Local Address (40.1.1.150) and Remote Host Address (30.1.1.150)
from IPSec SAs configured on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipsecctrl flows
Flows:
[428] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[429] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[427] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[430] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=540  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=431
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -flowpri 10 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=541  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=432
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=542  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=433
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[428] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
exit
[431] :: deny src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: none
[432] :: deny pri=10 src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: none
[427] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[433] :: deny src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: none
Total of 5 flows.
-> 
Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host(40.1.1.150) with mask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 0.0.0.255 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0  -bypass -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=176  seq=543  pid=0x100eed0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=544  pid=0x100eed0
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=428
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=544  pid=0x100eed0
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=bypass prio=0 dscp=0x0 dir=in id=434
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=544  pid=0x100eed0
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=432
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=544  pid=0x100eed0
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=427
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=0  pid=0x100eed0
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=433
------------------------------------------
Total of 5 flows
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host(40.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -flowpri 10 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=545  pid=0xf1da20
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=use prio=10 dscp=0x0 dir=in id=435
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=546  pid=0xf1da20
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=428
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=546  pid=0xf1da20
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=bypass prio=0 dscp=0x0 dir=in id=434
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=AH  len=136  seq=546  pid=0xf1da20
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=use prio=10 dscp=0x0 dir=in id=435
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=546  pid=0xf1da20
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=427
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=0  pid=0xf1da20
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=433
------------------------------------------
Total of 5 flows
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0245 (581)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2F01 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000036 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 98 5D 6C A4 85 9C 1D 8A 57 D5 D3 9B               .]l.....W...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0243 (579)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F61 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BE (190)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0245 (581)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3001 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000036 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 98 5D 6C A4 85 9C 1D 8A 57 D5 D3 9B               .]l.....W...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0243 (579)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F61 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BE (190)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly, received authenticated IP packet on interface
eth4 (40.1.1.150) (Local Host)

Removing ANVL Local Address (40.1.1.150) and Remote Host Address (30.1.1.150)
from IPSec SAs configured on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipsecctrl flows
Flows:
[428] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[434] :: bypass src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: BYPS
[435] :: use pri=10 src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[427] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[433] :: deny src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: none
Total of 5 flows.
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=547  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=436
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -flowpri 10 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=548  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=437
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=549  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=438
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[428] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
exit
[436] :: deny src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: none
[437] :: deny pri=10 src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: none
[427] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[438] :: deny src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: none
Total of 5 flows.
-> 
Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host(40.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -flowpri 10 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=550  pid=0xf0d550
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=use prio=10 dscp=0x0 dir=in id=439
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=551  pid=0xf0d550
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=428
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=551  pid=0xf0d550
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=436
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=AH  len=136  seq=551  pid=0xf0d550
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=use prio=10 dscp=0x0 dir=in id=439
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=551  pid=0xf0d550
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=427
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=0  pid=0xf0d550
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=438
------------------------------------------
Total of 5 flows
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host(40.1.1.150) with mask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 0.0.0.255 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0  -bypass -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=176  seq=552  pid=0x107c790
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=553  pid=0x107c790
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=428
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=553  pid=0x107c790
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=bypass prio=0 dscp=0x0 dir=in id=440
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=AH  len=136  seq=553  pid=0x107c790
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=use prio=10 dscp=0x0 dir=in id=439
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=553  pid=0x107c790
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=427
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=0  pid=0x107c790
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=438
------------------------------------------
Total of 5 flows
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0248 (584)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x398F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000037 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 42 F9 78 06 5D 3A A5 43 EC 70 EC 41               B.x.]:.C.p.A
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0246 (582)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F5E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BF (191)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0246 (582)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x305E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BF (191)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received unauthenticated IP Packet on interface
eth4 (40.1.1.150) (Local Host)

Removing ANVL Local Address (40.1.1.150) and Remote Host Address (30.1.1.150)
from IPSec SAs configured on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipsecctrl flows
Flows:
[428] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[440] :: bypass src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: BYPS
[439] :: use pri=10 src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[427] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[438] :: deny src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: none
Total of 5 flows.
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=554  pid=0x100f1e0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=441
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -flowpri 10 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=555  pid=0x100f1e0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=442
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=556  pid=0x100f1e0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=443
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[428] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
exit
[441] :: deny src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: none
[442] :: deny pri=10 src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: none
[427] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[443] :: deny src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: none
Total of 5 flows.
-> 
Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host(40.1.1.150) with mask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 0.0.0.255 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=557  pid=0xf0d550
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=558  pid=0xf0d550
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=428
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=AH  len=136  seq=558  pid=0xf0d550
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=use prio=0 dscp=0x0 dir=in id=444
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=558  pid=0xf0d550
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=442
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=558  pid=0xf0d550
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=427
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=0  pid=0xf0d550
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=443
------------------------------------------
Total of 5 flows
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host(40.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -bypass -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=176  seq=559  pid=0xf90420
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=560  pid=0xf90420
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=428
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=560  pid=0xf90420
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=bypass prio=0 dscp=0x0 dir=in id=445
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=AH  len=136  seq=560  pid=0xf90420
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=use prio=0 dscp=0x0 dir=in id=444
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=560  pid=0xf90420
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=442
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=560  pid=0xf90420
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=427
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=0  pid=0xf90420
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=443
------------------------------------------
Total of 6 flows
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x024B (587)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x398C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000038 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8E F2 1C 97 52 29 D8 3D 4D 20 14 A3               ....R).=M ..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0249 (585)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F5B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C0 (192)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0249 (585)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x305B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C0 (192)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly received unauthenticated IP packet on interface
eth4 (40.1.1.150) (Local Host)

Removing ANVL Local Address (40.1.1.150) and Remote Host Address (30.1.1.150)
from IPSec SAs configured on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipsecctrl flows
Flows:
[428] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[445] :: bypass src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: BYPS
[444] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[442] :: deny pri=10 src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: none
[427] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[443] :: deny src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: none
Total of 6 flows.
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=561  pid=0x1014a30
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=446
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -flowpri 10 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=562  pid=0x1014a30
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=447
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=563  pid=0x1014a30
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=448
------------------------------------------
-> cmd ipsecctrl flows
exit
Flows:
[428] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[445] :: bypass src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: BYPS
[446] :: deny src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: none
[447] :: deny pri=10 src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: none
[427] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[448] :: deny src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: none
Total of 6 flows.
-> 
Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host(40.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -bypass -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=176  seq=564  pid=0xf0d020
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=565  pid=0xf0d020
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=428
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=565  pid=0xf0d020
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=bypass prio=0 dscp=0x0 dir=in id=449
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=565  pid=0xf0d020
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=446
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=565  pid=0xf0d020
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=447
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=565  pid=0xf0d020
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=427
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=0  pid=0xf0d020
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=448
------------------------------------------
Total of 6 flows
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host(40.1.1.150) with mask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 0.0.0.255 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=566  pid=0xf0d020
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=567  pid=0xf0d020
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=428
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=567  pid=0xf0d020
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=bypass prio=0 dscp=0x0 dir=in id=449
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=AH  len=136  seq=567  pid=0xf0d020
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
 FLOWOPT: type=use prio=0 dscp=0x0 dir=in id=450
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=567  pid=0xf0d020
PROTOCOL: proto=any
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=447
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=567  pid=0xf0d020
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=427
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=0  pid=0xf0d020
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=448
------------------------------------------
Total of 6 flows
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated IP packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x024E (590)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2EF8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000039 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: FF E4 50 AF 87 CC 40 28 1A BE 39 CF               ..P...@(..9.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x024C (588)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F58 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED39 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C1 (193)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x024E (590)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x2FF8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000039 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: FF E4 50 AF 87 CC 40 28 1A BE 39 CF               ..P...@(..9.
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x024C (588)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F58 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED39 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C1 (193)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received authenticated IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.12: Passed

>> IPSEC-AH-6.14
TEST_DESCRIPTION
IPsec MUST allow an management interface to specify the security
processing for outbound traffic based on SA value - Next Layer 
protocol (e.g. ICMP). 
TEST_REFERENCE
rfc 4301 S4.4.1, p23, The Security Policy Database (SPD)
rfc 4301 S4.4.1.1, p28, Selectors
TEST_METHOD
- SETUP: Add the following entry in the DUT SPD:  Discard packets 
         containing next protocol set to ICMP
- ANVL:  Send an ICMP packets, from Local Host through the DUT 
         to Remote Host
-  DUT:  Do not forward the ICMP packet to Remote Host
- SETUP: Add the following entry in the DUT SPD:  Bypass IPsec for
         packets containing next protocol set to ICMP
- ANVL:  Send an ICMP packet, from Local Host through the DUT 
         to Remote Host  
-  DUT:  Forward the ICMP packet to Remote Host  
- SETUP: Add the following entry in the DUT SPD:  Use IPsec while  
         packets containing next protocol set to ICMP
- ANVL:  Send an ICMP packet, from Local Host through the DUT 
         to Remote Host 
-  DUT:  Forward the authenticated ICMP packet to Remote Host 
- ANVL:  Restore the DUT SPD 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=568  pid=0x103aad0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=569  pid=0x103aad0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=570  pid=0x103aad0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=571  pid=0x103aad0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=572  pid=0x103aad0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[452] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[453] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[451] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[454] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for ICMP transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMP DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 0 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=573  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=455
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=574  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=26015 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=26015 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x024F (591)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F55 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED38 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C2 (194)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Correctly, no IP packet received on interface eth3 (30.1.1.150)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for ICMP transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMP BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 0 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=575  pid=0x1014a30
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=576  pid=0x1014a30
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=26015 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0x1014a30
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=26015 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0250 (592)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F54 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED37 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C3 (195)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0250 (592)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3054 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED37 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C3 (195)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received expected Plain IP Packet on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for ICMP transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMP APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 0 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=577  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=578  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
 CURRENT: addtime=26015 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=152  seq=0  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
 CURRENT: addtime=26015 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0251 (593)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F53 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED36 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C4 (196)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x91BB (37307)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xAB1B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 4E 8E 6F C9 CD C1 0F A9 46 89 FC CC               N.o.....F...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0251 (593)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3053 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED36 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C4 (196)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Received expected authenticated IP Packet on interface
eth3 (30.1.1.150) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=579  pid=0x100e9a0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=580  pid=0x100e9a0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=581  pid=0x100e9a0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=582  pid=0x100e9a0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=583  pid=0x100e9a0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[459] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[460] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[458] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[461] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.14: Passed

>> IPSEC-AH-6.15
TEST_DESCRIPTION
IPSec must process outbound ISAKMP packets according to SAD/SPD
entries
TEST_REFERENCE
RFC 4301 s4.4.1.1 p17 Selectors
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that outbound ISAKMP (UDP/500)
        IP-datagrams from DUT to ANVL are processed using Discard
        policy
- ANVL: Send IP Packet with Transport Protocol UDP and Transport
        Protocol Destination Port 500 from Local Host
-  DUT: Do not forward IP Packet to Remote Host
- ANVL: Modify the SPD entry to use Bypass
- ANVL: Send IP Packet with Transport Protocol UDP and Transport
        Protocol Destination Port 500 from Local Host
-  DUT: Forward IP Packet to Remote Host
- ANVL: Modify the SPD entry to use IPsec
- ANVL: Send IP Packet with Transport Protocol UDP and Transport
        Protocol Destination Port 500 from Local Host
-  DUT: Forward authenticated IP Packet to Remote Host
- ANVL: Restore default SA and SPD between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=584  pid=0x5dfd00
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=585  pid=0x5dfd00
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=586  pid=0x5dfd00
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=587  pid=0x5dfd00
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=588  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[463] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[464] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[462] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[465] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and DESTINATION Port 500
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 500 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=500

DUT_ACTION=DISCARD

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -dstport 500 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=200  seq=589  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=500
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=466
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x0252 (594)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F36 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 36 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [28 bytes] ---
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 10 00 00 00 00 00 00 00 00 00 1C               ............
UDP: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IP Packet

Correctly, no IP packets received on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and DESTINATION Port 500
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 500 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=500

DUT_ACTION=BYPASS

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -dstport 500 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=184  seq=590  pid=0x1014a30
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=500
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x0253 (595)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F35 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 36 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [28 bytes] ---
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 10 00 00 00 00 00 00 00 00 00 1C               ............
UDP: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.150 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x0253 (595)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3035 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 36 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [28 bytes] ---
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 10 00 00 00 00 00 00 00 00 00 1C               ............
UDP: --- Trailing Data End ---

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and DESTINATION Port 500
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 500 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
TRANSPORT_PROTO=udp

PORT_TYPE=DESTINATION

PORT_NUMBER=500

DUT_ACTION=APPLY

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -transport 17 -dstport 500 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=184  seq=591  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24 port=500
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x0254 (596)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F34 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 36 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [28 bytes] ---
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 10 00 00 00 00 00 00 00 00 00 1C               ............
UDP: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 100 bytes
IP: Identification         = 0xE045 (57413)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x5C85 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A9 93 22 91 5F B3 A4 38 8D 2E 5F 69               .."._..8.._i
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x0254 (596)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3034 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 36 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [28 bytes] ---
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 10 00 00 00 00 00 00 00 00 00 1C               ............
UDP: --- Trailing Data End ---

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-6.15: Passed

>> IPSEC-AH-7.1
TEST_DESCRIPTION
A compliant Host implementation MUST support IPsec(Transport mode)
between a pair of Hosts.
(Note: Both DUT and ANVL acting as Host)
TEST_REFERENCE
rfc 4301, s3.1, p8  What IPsec does
TEST_METHOD
- ANVL:  Send an authenticated ICMP echo request to <DIface-0>
- ANVL:  Listen upto <ParamListenTime> for AH-authenticated ICMP
         echo reply.
-  DUT:  Send an authenticated echo reply
- ANVL:  Verify that the received packet is AH-authenticated.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=592  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=593  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=594  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=595  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=596  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[470] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[471] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[469] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[472] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 30.1.1.5 30.1.1.150 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=597  pid=0x1074a60
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=598  pid=0x1074a60
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 30.1.1.5 -dstflow  30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=599  pid=0x1074a60
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=30.1.1.5/32
 DSTFLOW: addr=30.1.1.150/32
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=600  pid=0x1074a60
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 30.1.1.5 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=601  pid=0x1074a60
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=30.1.1.5/32
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to DUT virtual address 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x0255 (597)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3996 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 1 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000003A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 82 EF 9B B0 50 13 65 92 66 AD EA 35               ....P.e.f..5
AH:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED35 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C5 (197)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x517B (20859)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xEA6F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 1 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7B E6 81 15 04 BA 1C B2 54 AD 93 87               {.......T...
AH:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF535 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C5 (197)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received Expected authenticated packet on interface 
eth3 (30.1.1.150) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-7.1: Passed

>> IPSEC-AH-7.2
TEST_DESCRIPTION
In Transport mode, AH is inserted after the IP header and before the
next layer protocol.
(Note: This is basic test for Transport Mode)
TEST_REFERENCE
rfc 4302, s3.1.1, p9, Transport mode
TEST_METHOD
- ANVL: Send an AH-authenticated ICMP Echo Request from <AIface-0> to
        <DIface-0>
-  DUT: Send a AH-authenticated ICMP Echo Reply to <AIface-0>.
- ANVL: Verify that the AH Header is placed in between the original IP
        header and the payload data.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=602  pid=0xf836f0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=603  pid=0xf836f0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=604  pid=0xf836f0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=605  pid=0xf836f0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=606  pid=0xf836f0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[478] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[479] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[477] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[480] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 30.1.1.5 30.1.1.150 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=607  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=608  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 30.1.1.5 -dstflow  30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=609  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=30.1.1.5/32
 DSTFLOW: addr=30.1.1.150/32
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=610  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 30.1.1.5 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=611  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=30.1.1.5/32
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to DUT virtual address 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x0256 (598)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3995 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 1 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000003B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D3 31 C4 F3 32 ED 6A E7 AB 5E E7 76               .1..2.j..^.v
AH:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED34 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C6 (198)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x6596 (26006)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xD654 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 1 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 73 48 0C 53 7C 0C D3 58 83 78 40 F0               sH.S|..X.x@.
AH:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF534 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C6 (198)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


AH Header in received packet is correctly placed after
IP Header and before next layer protocol (ICMP)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-7.2: Passed

>> IPSEC-AH-8.1
TEST_DESCRIPTION
In transport mode, the DSCP value might change en route, but this SHOULD
not cause problems with respect to IPsec processings - since the value
is not employed for SA selection and MUST NOT be checked as part of
SA/packet validation.
TEST_REFERENCE
rfc 4301 S4.1 p14 Definition and Scope
TEST_METHOD
- ANVL: Send an Authenticated ICMP echo request from <AIface-0> to
        <DIface-0> with DSCP field set to <DSCP>
- ANVL: Listen upto <ParamListenTime> for authenticated ICMP
        echo reply.
-  DUT: Send an authenticated echo reply to <AIface-0>
- ANVL: Verify that the received packet is authenticated.
- CASE: <DSCP> = 0x28 (EXPRESS FWDing precedence)
- CASE: <DSCP> = 0x0C (stays for IP routing protocol)
- CASE: <DSCP> = 0  (Default case. Will give BEST EFFORT precedence)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=612  pid=0x107d010
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=613  pid=0x107d010
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=614  pid=0x107d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=615  pid=0x107d010
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=616  pid=0x107d010
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[486] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[487] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[485] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[488] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 30.1.1.5 30.1.1.150 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=617  pid=0xf7d010
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=618  pid=0xf7d010
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 30.1.1.5 -dstflow  30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=619  pid=0xf7d010
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=30.1.1.5/32
 DSTFLOW: addr=30.1.1.150/32
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=620  pid=0xf7d010
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 30.1.1.5 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=621  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=30.1.1.5/32
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


 Case: Sending an authenticated packet with DSCP field set to 0x28


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to DUT virtual address 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xA0
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0257 (599)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3904 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 1 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000003C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 2D 4D 23 0A 9B D2 52 A2 72 9F B6 73               -M#...R.r..s
AH:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF738 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C7 (199)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xA0
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x09C7 (2503)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3194 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 1 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 10 B1 BF F4 74 C4 69 9F C9 A7 63 91               ....t.i...c.
AH:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFF38 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C7 (199)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Received expected packet on interface eth3 (30.1.1.150)


 Case: Sending an authenticated packet with DSCP field set to 0xC


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to DUT virtual address 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x30
IP:  |01234567
IP:  |001.....             = Precedence (Priority)
IP:  |...1....             = Low Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0258 (600)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3973 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 1 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000003D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: DC 79 A7 6A 95 50 72 0F 50 87 F6 B6               .y.j.Pr.P...
AH:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF738 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C7 (199)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x30
IP:  |01234567
IP:  |001.....             = Precedence (Priority)
IP:  |...1....             = Low Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x09C8 (2504)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3203 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 1 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: EA E9 52 90 21 07 8C D4 50 05 E6 F1               ..R.!...P...
AH:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFF38 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C7 (199)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Received expected packet on interface eth3 (30.1.1.150)


 Case: Sending an authenticated packet with DSCP field set to 0x0


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to DUT virtual address 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0259 (601)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x39A2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 1 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000003E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F3 E3 60 A2 85 F3 D5 67 90 FC 81 0C               ..`....g....
AH:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF738 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C7 (199)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Authenticated IP Packet
Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x09C9 (2505)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3232 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 1 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B9 9B F3 03 7A 69 68 85 19 DA 01 2F               ....zih..../
AH:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFF38 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C7 (199)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Received expected packet on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-8.1: Passed

>> IPSEC-AH-8.2
TEST_DESCRIPTION
IPsec on a security gateway MUST copy the DS field from the inner IP
header to the outer IP header.
TEST_REFERENCE
RFC 4301 s5.1.2.1 p57 IPv4 header construction for tunnel mode
TEST_METHOD
- ANVL: Send ICMP Echo Request from Local Host, with the DS field
        in the inner IP-Header set to <DSCP>
-  DUT: Forward authenticated ICMP Echo Request to Remote Host
- ANVL: Verify that the DS field of the outer header is set to <ds>
- CASE: <DSCP> = 101110 (High Priority, Expedited Forwarding)
- CASE: <DSCP> = 001010 (Assured forwarding 11)
- CASE: <DSCP> = 000000 (Default case.Will give BEST EFFORT precedence)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=622  pid=0xf7d010
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=623  pid=0xf7d010
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=624  pid=0xf7d010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=625  pid=0xf7d010
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=626  pid=0xf7d010
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[494] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[495] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[493] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[496] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


 Case: Sending a plain packet with DSCP field set to 0x2E
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xB8
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...1....             = Low Delay
IP:  |....1...             = High Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x025A (602)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2E92 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED32 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C8 (200)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xB8
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...1....             = Low Delay
IP:  |....1...             = High Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xD1FA (53754)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x6A24 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D8 0E 29 A8 FA B8 C3 81 43 D8 EB B4               ..).....C...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xB8
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...1....             = Low Delay
IP:  |....1...             = High Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x025A (602)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F92 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED32 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C8 (200)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received outer IP DSCP field: 0x2E
on interface eth3 (30.1.1.150) (Remote Host) 


 Case: Sending a plain packet with DSCP field set to 0xA
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x28
IP:  |01234567
IP:  |001.....             = Precedence (Priority)
IP:  |...0....             = Normal Delay
IP:  |....1...             = High Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x025B (603)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F21 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED31 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C9 (201)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x28
IP:  |01234567
IP:  |001.....             = Precedence (Priority)
IP:  |...0....             = Normal Delay
IP:  |....1...             = High Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xA24A (41546)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x9A64 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: FA DF F3 C6 56 60 BD FD 96 70 FD 97               ....V`...p..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x28
IP:  |01234567
IP:  |001.....             = Precedence (Priority)
IP:  |...0....             = Normal Delay
IP:  |....1...             = High Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x025B (603)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3021 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED31 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C9 (201)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received outer IP DSCP field: 0xA
on interface eth3 (30.1.1.150) (Remote Host) 


 Case: Sending a plain packet with DSCP field set to 0x0
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x025C (604)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F48 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED30 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CA (202)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x608D (24717)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0xDC49 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8C 4D EE 01 38 51 59 69 25 AB 18 27               .M..8QYi%..'
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x025C (604)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3048 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED30 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CA (202)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Correctly received outer IP DSCP field: 0x0
on interface eth3 (30.1.1.150) (Remote Host) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-8.2: Passed

>> IPSEC-AH-8.3
TEST_DESCRIPTION
IPsec on a security gateway MUST copy the ECN field from 
the inner IP header to the outer IP header.
(Note: This test is for tunnel mode, authenticator side)
TEST_REFERENCE
RFC 4301 s5.1.2.1 p57 IPv4 header construction for tunnel mode
IETF-proceedings-draft-ipsec-ecn-00.txt s3.1.3 p7 
TEST_METHOD
- ANVL: Send plain ICMP Echo Request from Local Host to Remote host 
        through DUT containing:
        - ECT field set to <ECTInner>
-  DUT: Forward authenticated ICMP Echo Request to Remote Host
- ANVL: Verify that the ECT field of the outer IP-header is
        set to the value <ECTInner>
- CASE: <ECTInner> = 1 
- CASE: <ECTInner> = 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=627  pid=0xf588d0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=628  pid=0xf588d0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=629  pid=0xf588d0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=630  pid=0xf588d0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=631  pid=0xf588d0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[498] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[499] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[497] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[500] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


 Case: Sending a plain packet with ECT bit set to 1
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x02
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x025D (605)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F45 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CB (203)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x02
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0A6F (2671)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3266 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 74 7E 5D 6A F9 9A 17 3F 00 9B BF AA               t~]j...?....
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x02
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x025D (605)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3045 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CB (203)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

 Correctly received ECT bit field set to: 1
 on interface eth3 (30.1.1.150) (Remote Host) 


 Case: Sending a plain packet with ECT bit set to 0
Sending Unauthenticated ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x025E (606)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F46 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CC (204)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Authenticated IP Packet

Received Authenticated IP packet from 30.1.1.5 on interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xAEE3 (44771)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x8DF3 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 20 50 B3 23 FC 49 FF EC D8 A6 E0 11                P.#.I......
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x025E (606)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3046 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CC (204)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

 Correctly received ECT bit field set to: 0
 on interface eth3 (30.1.1.150) (Remote Host) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-8.3: Passed

>> IPSEC-AH-8.4
TEST_DESCRIPTION
If the ECN field in the inner header is set to ECT(0) or
ECT(1), where ECT is ECN-Capable Transport (ECT), and if the
ECN field in the outer header is set to Congestion Experienced
(CE), then set the ECN field in the inner header to CE;
otherwise, make no change to the ECN field in the inner header.
TEST_REFERENCE
RFC 4301 s5.1.2.1 p58 IPv4 header construction for tunnel mode
IETF-proceedings-draft-ipsec-ecn-00.txt s3.1.3 p7 
TEST_METHOD
- ANVL: Send authenticated IP Packet Remote host to Local
				 host through DUT
        - ECN field of Inner header set to <ECNInner>
        - ECN field of Outer header set to <ECNOuter>
-  DUT: Forward plain IP Packet to Local Host
- ANVL: Verify that the ECN bit-field of the inner IP-header
        is set to:
        - ECT(0)  in CASE-1
        - ECT(1)  in CASE-2
        - not-ECT in CASE-3
        - CE      in CASE-4
        - CE      in CASE-5
- CASE-1: <ECNInner> = ECT(0)  && <ECNOuter> = not-ECT 
- CASE-2: <ECNInner> = ECT(1)  && <ECNOuter> = not-ECT 
- CASE-3: <ECNInner> = not-ECT && <ECNOuter> = CE      
- CASE-4: <ECNInner> = ECT(0)  && <ECNOuter> = CE      
- CASE-5: <ECNInner> = ECT(1)  && <ECNOuter> = CE      

Note: As per RFC3168 s.5 p.7.,
   +-----+-----+
   | ECN FIELD |
   +-----+-----+
     ECT   CE
      0     0   -->   Not-ECT
      0     1   -->   ECT(1)
      1     0   -->   ECT(0)
      1     1   -->   CE
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=632  pid=0xffb010
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=633  pid=0xffb010
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=634  pid=0xffb010
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=635  pid=0xffb010
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=636  pid=0xffb010
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[502] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[503] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[501] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[504] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ALLOW TRUE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-dut-ecn-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POLICY=ALLOW

SET_ECN=TRUE

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=637  pid=0xf65370
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -ecn
keyadm: Enabling ECN support
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=638  pid=0xf65370
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  ecn tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=639  pid=0xf65370
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -ecn
keyadm: Enabling ECN support
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=640  pid=0xf65370
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  ecn tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=641  pid=0xf65370
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.


Case-1: Sending an encapsulated packet with inner_ECN(EST)field set to 2


Case-1: Set the outer_ECN(CE) field to 0 in Outer IP


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0261 (609)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3986 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000003F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8A BF 5F ED 2C DE 1E D1 26 6D 14 4B               .._.,...&m.K
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x02
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x025F (607)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F53 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF732 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CD (205)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x02
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x025F (607)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3053 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF732 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CD (205)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly received inner ECN bit field: 2
on interface eth4 (40.1.1.150) (Remote Host) 


Case-2: Sending an encapsulated packet with inner_ECN(EST)field set to 1


Case-2: Set the outer_ECN(CE) field to 0 in Outer IP


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0264 (612)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3983 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000040 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 57 1E 72 06 16 91 C8 9F A6 C8 6F 45               W.r.......oE
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x01
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......1             = Must Be Zero (*Should be 0*)
IP: Total Length           = 28 bytes
IP: Identification         = 0x0262 (610)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F51 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF731 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CE (206)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x01
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......1             = Must Be Zero (*Should be 0*)
IP: Total Length           = 28 bytes
IP: Identification         = 0x0262 (610)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3051 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF731 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CE (206)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly received inner ECN bit field: 1
on interface eth4 (40.1.1.150) (Remote Host) 


Case-3: Sending an encapsulated packet with inner_ECN(EST)field set to 0


Case-3: Set the outer_ECN(CE) field to 3 in Outer IP


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x03
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......1             = Must Be Zero (*Should be 0*)
IP: Total Length           = 72 bytes
IP: Identification         = 0x0267 (615)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x397D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000041 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 66 13 95 01 5B 3D 2B 82 78 78 81 81               f...[=+.xx..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0265 (613)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F4F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF730 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CF (207)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0265 (613)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x304F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF730 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CF (207)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly received inner ECN bit field: 0
on interface eth4 (40.1.1.150) (Remote Host) 


Case-4: Sending an encapsulated packet with inner_ECN(EST)field set to 2


Case-4: Set the outer_ECN(CE) field to 3 in Outer IP


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x03
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......1             = Must Be Zero (*Should be 0*)
IP: Total Length           = 72 bytes
IP: Identification         = 0x026A (618)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x397A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000042 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F9 70 9C 81 0D B8 81 F1 67 0B B3 96               .p......g...
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x02
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0268 (616)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F4A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF72F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D0 (208)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x03
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......1             = Must Be Zero (*Should be 0*)
IP: Total Length           = 28 bytes
IP: Identification         = 0x0268 (616)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3049 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF72F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D0 (208)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly received inner ECN bit field: 3
on interface eth4 (40.1.1.150) (Remote Host) 


Case-5: Sending an encapsulated packet with inner_ECN(EST)field set to 1


Case-5: Set the outer_ECN(CE) field to 3 in Outer IP


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x03
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......1             = Must Be Zero (*Should be 0*)
IP: Total Length           = 72 bytes
IP: Identification         = 0x026D (621)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3977 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000043 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 56 DC 58 C6 31 15 51 F3 06 7A 05 23               V.X.1.Q..z.#
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x01
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......1             = Must Be Zero (*Should be 0*)
IP: Total Length           = 28 bytes
IP: Identification         = 0x026B (619)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F48 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF72E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D1 (209)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Received Non-Authenticated IP packet from 30.1.1.150 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x03
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......1             = Must Be Zero (*Should be 0*)
IP: Total Length           = 28 bytes
IP: Identification         = 0x026B (619)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3046 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF72E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D1 (209)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly received inner ECN bit field: 3
on interface eth4 (40.1.1.150) (Remote Host) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-8.4: Passed

>> IPSEC-AH-9.1
TEST_DESCRIPTION
If an IPsec system receives an outbound packet that it finds it must
discard, it SHOULD be capable of generating and sending an ICMP
message to indicate to the sender of the outbound packet that the
packet was discarded.
a.  The selectors of the packet matched an SPD entry requiring the
packet to be discarded.
IPv4 Type = 3 (destination unreachable) Code = 13
(Communication Administratively Prohibited)
TEST_REFERENCE
rfc 4301 S5.1.1, p54, Handling an outbound packet
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that outbound IP-datagrams (via
        interface D1) with IP Destination Address set to ANVL Remote
        Address use Discard policy
- ANVL: Send an ICMP packets, from Local Host through the DUT
        to a Remote Host
-  DUT: Send an ICMP reply depicting the error
        "destination unreachable"
- ANVL: Verify the TYPE and CODE fields of the received ICMP packet are
        3 and 13 respectively.
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=642  pid=0x101c020
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=643  pid=0x101c020
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=644  pid=0x101c020
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=645  pid=0x101c020
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=646  pid=0x101c020
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[510] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[511] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[509] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[512] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Outbound IPSec Policy:
DISCARD IPSec for REMOTE Host(30.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 DISCARD REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-add-outbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=30.1.1.150

DUT_ACTION=DISCARD

HOST_TYPE=REMOTE

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=192  seq=647  pid=0x5dfd00
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=513
------------------------------------------
-> cmd keyadm dumpflow -egress
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=648  pid=0x5dfd00
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=509
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=136  seq=0  pid=0x5dfd00
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=513
------------------------------------------
Total of 2 flows
-> exit
Au revoir!
Connection closed by foreign host.

Sending Unauthenticated ICMP packet from interface eth4 (40.1.1.150)
to interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x026E (622)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F36 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED28 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D2 (210)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for IP Packet

Received Non-Authenticated IP packet from 40.1.1.5 on interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xAF02 (44802)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7910 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 3 (Destination Unreachable)
ICMP: Code             = 13 (*Unknown*)
ICMP: Checksum         = 0xFCF2 (Correct)
ICMP:
ICMP: ---- ICMP Data ----
ICMP:
ICMP: Unused           = 0x00000000
ICMP:
ICMP: IP: ---- IP Packet ----
ICMP: IP:
ICMP: IP: Version                = 4
ICMP: IP: Internet Header Length = 5 (20 bytes)
ICMP: IP: Type Of Service        = 0x00
ICMP: IP:  |01234567
ICMP: IP:  |000.....             = Precedence (Routine)
ICMP: IP:  |...0....             = Normal Delay
ICMP: IP:  |....0...             = Normal Throughput
ICMP: IP:  |.....0..             = Normal Reliability
ICMP: IP:  |......0.             = Normal Monetary Cost
ICMP: IP:  |.......0             = Must Be Zero 
ICMP: IP: Total Length           = 44 bytes
ICMP: IP: Identification         = 0x026E (622)
ICMP: IP: Flags                  = 0
ICMP: IP:  |012
ICMP: IP:  |0..                  = Reserved 
ICMP: IP:  |.0.                  = May Fragment
ICMP: IP:  |..0                  = Last Fragment
ICMP: IP: Fragment Offset        = 0x0000 (0 bytes)
ICMP: IP: Time to Live           = 63
ICMP: IP: Protocol               = ICMP (1)
ICMP: IP: Header Checksum        = 0x3036 (Correct)
ICMP: IP: Source Address         = 40.1.1.150
ICMP: IP: Destination Address    = 30.1.1.150
ICMP: IP:
ICMP: IP: ---- End of IP Header ----
ICMP: IP:
ICMP: IP: --- 64 bits of datagram [8 bytes] ---
ICMP: IP:  08 00 ED 28 00 D2 00 00                           ...(....
ICMP: IP: --- 64 bits of datagram End ---
ICMP: --- Trailing Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Trailing Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP packet from DUT on Local Host (eth4)

Received ICMP Message contains TYPE and CODE field correctly set to
3 (Destination Unreachable) and 13 (Administratively Prohibited) respectively

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-9.1: Passed

>> IPSEC-AH-10.1
TEST_DESCRIPTION
No valid SA exists for a session.The audit Log entry for this event
SHOULD include the SPI values, date/time received, source address and
destination address, sequence number.
(Note: Here we are doing this test only for SPI mismatch scenario. Can
be done for other parameter mis-match also)
TEST_REFERENCE
RFC 4302, s3.4.2, p18, Security Association Lookup
TEST_METHOD
- ANVL: Send an authenticated ICMP echo request containing a SPI value
        that doesn't match the SPI entry of the established SA from
        remote host.
-  DUT: Don't forward this ICMP echo request and LOG the error.
- ANVL: Verify that DUT has properly logged an error for incorrect SPI
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
 lllenth:21 
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=649  pid=0x101c020
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=650  pid=0x101c020
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=651  pid=0x101c020
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=80  seq=652  pid=0x101c020
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=176  seq=653  pid=0x101c020
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[515] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[516] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: AH   spi=0x300 src=30.1.1.150 dst=30.1.1.5
[514] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[517] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: AH   spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IP packet from interface eth3
(ANVL virtual address 30.1.1.150) to interface eth4
(ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0271 (625)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = AH (51)
IP: Header Checksum        = 0x3966 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 4 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x0000030A 
AH: Sequence Number          = 0x00000044 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3A 74 8D 50 0A BC 99 9B 29 5B AF D2               :t.P....)[..
AH:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x026F (623)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F35 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED27 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D3 (211)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for IP Packet
Correctly, did not receive IP packet on interface eth4 (40.1.1.150)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
778

Executing system command:
  "./DocScriptQ35/IPSEC-AH/ipsec-verify-audit-bad-spi-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> 
DUT has correctly logged the SPI mismatch with bad SPI 0x30A

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-AH-10.1: Passed
Executing system command:
  "./DocScriptQ35/IPSEC-AH/IPSECAHpostsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet.AcceptSourceRoute "0"
sysvar: ipnet.inet.AcceptSourceRoute=0 ok
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=654  pid=0x100eed0
------------------------------------------
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          57
Number of tests passed:       57
Number of tests failed:       0
Number of tests inconclusive: 0
