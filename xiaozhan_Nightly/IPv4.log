ANVL version 8.80.1.28 (Linux). Copyright (c) (2019) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197416 kB RAM. Free Memory 6740476 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlip ip 1-5.5 5.7-5.15 5.20-5.24 5.27-7.5 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlip.prm 

Reboot Time                              60                  # (0x0000003C)
Reboot Command                           "./DocScriptQ35/IP/reboot-command.exp $ANVL_DUTHOSTNAME"
Post suite Command                       "./DocScriptQ35/IP/IPpostsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
IP DUT Supports ICMP Param Problem for IP Record Route Option True
IP DUT Supports IP Stream Identifier Option True
IP DUT Supports IP Record Route Option   True
IP DUT Supports IP Strict Source And Record Route Option True
IP DUT Static Route Add Command          "./DocScriptQ35/IP/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IP DUT Static Route Delete Command       "./DocScriptQ35/IP/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IP DUT MTU Set Command                   "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IP DUT MTU Reset Command                 "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IP DUT Background Echo Request Send Command "./DocScriptQ35/IP/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IP DUT is a Router                       True
IP High MTU                              1500                # (0x000005DC)
IP Low MTU                               100                 # (0x00000064)
IP Initial Reassembly Timeout value      70.000000
IP Unrecognized Option Type              32                  # (0x00000020)
IP DUT Supports IP Timestamp Option      True
IP DUT Supports IP Loose Source And Record Route Option True
IP DUT Supports MTU Configuration        True
IP Listen Time                           15                  # (0x0000000F)
IP Tolerance Factor                      1                   # (0x00000001)
IP Tolerance Time                        15                  # (0x0000000F)
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
PPP Delay After NCP                      0                   # (0x00000000)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlip.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        
IP First Unused Net                      50.0.0.0
IP Number Unused Nets                    10                  # (0x0000000A)
IP Unused Net Mask                       255.255.255.0

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP DUT Address                           30.1.1.5
  IP ANVL Address                          30.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Gateway                               30.1.1.5
  IP Broadcast Address                     30.1.1.255
  IP First Unused Address                  30.1.1.160
  IP Number Unused Addresses               50                # (0x00000032)

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP DUT Address                           40.1.1.5
  IP ANVL Address                          40.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Gateway                               40.1.1.5
  IP Broadcast Address                     40.1.1.255
  IP First Unused Address                  40.1.1.160
  IP Number Unused Addresses               50                # (0x00000032)

# Configuration File End.
%% VALIDATE PRM 19 WARNING: Default Value for IP initial Reassembly Timeout
is not set to 15 sec, hence following tests will not be run: 7.3 7.4 
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet.AcceptSourceRoute "1"
sysvar: ipnet.inet.AcceptSourceRoute=1 ok
-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet add 30.1.1.5 netmask  255.255.255.0 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet add 40.1.1.5 netmask  255.255.255.0 up
-> cmd route delete default
    delete net 0.0.0.0
-> exit
Au revoir!
Connection closed by foreign host.
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

00:1B:21:7D:57:BA < 00:15:17:C8:90:28 ARP Rsp 30.1.1.150

Device Under Test found at 30.1.1.5 as 00:15:17:C8:90:28
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BB ARP Req 40.1.1.5

00:1B:21:7D:57:BB < 00:15:17:C8:90:29 ARP Rsp 40.1.1.150

Device Under Test found at 40.1.1.5 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite IP
RFC 791: 'INTERNET PROTOCOL'
RFC 1122: 'Requirements for Internet Hosts -- Communication Layers' (R. Braden, October 1989)
RFC 1812: 'Requirements for IP Version 4 Routers' (F. Baker, June 1995)

ANVL Test Suite Required Setup:
This suite expects to be running against an IP Node(Host/Router). Many
of the tests can be run against a single interface (Host) and remaining
tests require that the machine ANVL is running on is connected to 2
interfaces that are connected to the router under test.

The ANVL config file must contain at least one IP interface
configuration with DUT configured as ANVL's default gateway.


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IP-1.1
TEST_DESCRIPTION
A host must respond to all ICMP Echo Requests sent to it,by 
sending an ICMP Echo Reply back to the sender of ICMP Echo Request.
TEST_REFERENCE
ANVL, setup verification
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5),
containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE535 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0001 (1)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0xD673 (54899)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x65AD (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED35 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0001 (1)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-1.1: Passed

>> IP-1.2
TEST_DESCRIPTION
An IP router must forward all the ICMP Echo Requests and replies 
to and from the networks it is connected to.
TEST_REFERENCE
ANVL, setup verification
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address set to address of host-1
        - IP Destination Address set to address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward the ICMP Echo Request
- ANVL: Verify that the received ICMP Echo Request remains
        unmodified
- ANVL: Send an ICMP Echo Reply to <DIface-1>, containing:
        - IP Source Address set to address of host-2
        - IP Destination Address set to address of host-1
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Forward the ICMP Echo Reply
- ANVL: Verify that the received ICMP Echo Reply remains
        unmodified 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5),
containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3190 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE534 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0002 (2)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3290 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE534 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0002 (2)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

Received ICMP Echo Request correctly remains unmodified

Sending an ICMP Echo Reply to <DIface-1> (40.1.1.5),
containing:
- IP Source Address field set to address of host-2 (40.1.1.150)
- IP Destination Address field set to address of host-1 (30.1.1.150)

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3190 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED33 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0003 (3)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3290 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED33 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0003 (3)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Reply on <DIface-0>

Received ICMP Echo Reply correctly remains unmodified

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-1.2: Passed

>> IP-1.3
TEST_DESCRIPTION
DUT sends ICMP Echo Request
TEST_REFERENCE
ANVL, setup verification
TEST_METHOD
- ANVL: Cause DUT to send an ICMP Echo Request through <DIface-0>,
        containing:
        - IP Destination Address field set to address of host-1
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Causing DUT to send 1 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 30.1.1.150
ICMP Echo Data size 16
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 0 1 16

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 30.1.1.0
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0xB8FE (47358)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x832A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x1C46 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x6333 (25395)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [28 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B               0123456789:;
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Request from DUT
cmd ping -c 1 -s 36 30.1.1.150

Pinging 30.1.1.150 (30.1.1.150) with 36 bytes of data:

--- 30.1.1.150 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 1016 ms
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-1.3: Passed

>> IP-1.4
TEST_DESCRIPTION
Static route is added correctly.
TEST_REFERENCE
ANVL, setup verification
TEST_METHOD
 SETUP: Configure DUT to add static route for <RTR-2> via gateway 
        <RTR-1> and outgoing interface <DIface-1>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address set to address of host-1
        - IP Destination Address set to address of RTR-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward the ICMP Echo Request
- ANVL: Verify that the received ICMP Echo Request contains:
        - IP Destination Address field set to address of RTR-2
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Causing DUT to add a static route on DUT for
Destination Address 50.0.0.1
Gateway Address 40.1.1.150
outgoing interface <DIface-1>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
50.0.0.1 40.1.1.150 1 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -host 50.0.0.1 40.1.1.150
    add host 50.0.0.1: gateway 40.1.1.150
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       4     gei0   0    
30.1.1.5                        30.1.1.5                      UH       1     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       2     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
50.0.0.1                        40.1.1.150                    UGHS     0     gei1   0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       294   gei2   0    
vxTarget                        vxTarget                      UH       2260  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       82966 lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5),
containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of RTR-2 (50.0.0.1)

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2926 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 50.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE532 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0004 (4)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2A26 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 50.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE532 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0004 (4)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

IP Destination Address field of ICMP Echo Request is correctly
set to 50.0.0.1 (address of RTR-2)

Causing DUT to delete static route on DUT for
Destination Address 50.0.0.1
Gateway Address 40.1.1.150
outgoing interface <DIface-1>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
50.0.0.1 40.1.1.150 1 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -host 50.0.0.1 
    delete host 50.0.0.1
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       4     gei0   0    
30.1.1.5                        30.1.1.5                      UH       1     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       2     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       295   gei2   0    
vxTarget                        vxTarget                      UH       2277  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       82966 lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-1.4: Passed

>> IP-2.1
TEST_DESCRIPTION
The Time to Live is set by the sender of the datagram and reduced
at the points along the route where it is processed.
TEST_REFERENCE
RFC 791 s1.4 p2 Operation
RFC 791 s3.1 p14 Internet Header Format
RFC 791 s3.2 p30 Discussion (Time to Live)
RFC 1812 s5.3.1 p85 Time to Live (TTL)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP TTL field set to <validTTL>
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward the ICMP Echo Request
- ANVL: Verify that the received ICMP Echo Request contains:
        - IP TTL field set to (<validTTL> - 1)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP TTL field set to 64

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3190 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE531 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0005 (5)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3290 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE531 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0005 (5)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo request on <DIface-1>

TTL field of ICMP Echo Request is correctly set to 63

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-2.1: Passed

>> IP-2.2
TEST_DESCRIPTION
If the time to live reaches zero before the internet datagram
reaches its destination, the internet datagram is destroyed.
TEST_REFERENCE
RFC 791 s1.4 p2 Operation
RFC 791 s3.1 p14 Internet Header Format
RFC 791 s3.2 p30 Discussion (Time to Live)
RFC 1122 s3.2.1.7 p34 Time-to-Live: RFC-791 Section 3.2
RFC 1812 s4.2.2.9 p46 Time to Live: RFC 791 Section 3.2 
RFC 1812 s5.3.1 p85 Time to Live (TTL) 
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP TTL field set to 1
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Discard the ICMP Echo Request and do not forward 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5),
containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP TTL field set to 1

Waiting (up to 30.000 seconds) for No ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7090 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE530 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0006 (6)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Did not receive forwarded ICMP Echo Request on <DIface-1>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-2.2: Passed

>> IP-2.3
TEST_DESCRIPTION
A host MUST NOT discard a datagram just because it was received 
with TTL less than 2.
TEST_REFERENCE
RFC 1122 s3.2.1.7 p34 Time-to-Live: RFC-791 Section 3.2
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP TTL field set to <ttl>
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- CASE: <ttl> = 0
- CASE: <ttl> = 1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


CASE :: <ttl> = 0

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP TTL field set to 0

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 0
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7C21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE52F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0007 (7)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x08DD (2269)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3344 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0007 (7)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

CASE :: <ttl> = 1

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP TTL field set to 1

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7B21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE52E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0008 (8)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x08DE (2270)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3343 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0008 (8)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-2.3: Passed

>> IP-2.4
TEST_DESCRIPTION
If the header checksum fails, the internet datagram is discarded
at once by the entity which detects the error.
TEST_REFERENCE
NEGATIVE
RFC 791 s1.4 p3 Operation
RFC 1122 s3.2.1.2 p29 Checksum: RFC-791 Section 3.1
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Checksum field set to <invalidChecksum>
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Do not send ICMP Echo Reply
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Checksum field set to 0x3C22

Waiting (up to 30.000 seconds) for No ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C22 *Should be 0x3C21*
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE52D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0009 (9)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Did not receive ICMP Echo Reply on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-2.4: Passed

>> IP-3.1
TEST_DESCRIPTION
Fragmentation of an internet datagram is necessary when it
originates in a local net that allows a large packet size and must
traverse a local net that limits packets to a smaller size to reach
its destination.
TEST_REFERENCE
RFC 791 s2.3 p8 Function Description (Fragmentation)
RFC 791 s3.2 p26 Discussion (An Example Fragmentation Procedure)
RFC 1812 s5.2.6 p80  Fragmentation and Reassembly: RFC-791 Section 
3.2 
TEST_METHOD
 SETUP: Configure DUT to set MTU on <DIface-0> to <HighMTU>
 SETUP: Configure DUT to set MTU on <DIface-1> to <LowMTU>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Total Length field set to greater than <LowMTU>
        - IP Flags field, containing:
          - DF bit set to zero
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward two fragmented packets
- ANVL: Verify that the received:
        - first fragmented packet contains:
          - IP Fragment Offset field set to zero
          - IP Flags field, containing:
            - M bit set to 1
        - second fragmented packet contains:
        - IP Fragment Offset field set to non-zero
          - IP Flags field, containing:
            - M bit set to zero
        - two packets when reassembled contain same data as sent
          in ICMP Echo Request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Causing DUT to set MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to set MTU to 100 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 100

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 100 up
-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5),
containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Total Length field set to 110 (greater than <LowMTU> (100))
- IP Flags field, containing:
  - DF bit set to zero

Waiting (up to 30.000 seconds) for ICMP Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 110 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3162 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7F5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000A (10)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [82 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF                                             ..
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 100 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x126C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7F5 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000A (10)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [72 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF                           ........
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 30 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x000A (80 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x32A8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet (continuation [10 bytes]) ----
ICMP:
ICMP: --- Data [10 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF                     ..........
ICMP: --- Data End ---
ETHER: --- Padding [16 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER: --- Padding End ---


Received expected two IP packets on <DIface-1>

Fragment Offset field of first IP packet is correctly set
to zero

M bit of Flags field of first IP packet is correctly set
to 1

Fragment Offset field of second IP packet is correctly set
to non-zero value (10)

M bit of Flags field of second IP packet is correctly set
to zero

Received two fragmented packets when reassembled correctly
contain same data as sent in ICMP Echo Request:
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF                                             ..

Causing DUT to Reset MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to Reset MTU to 1500 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-3.1: Passed

>> IP-3.2
TEST_DESCRIPTION
An internet datagram can be marked "don't fragment."  Any internet
datagram so marked is not to be internet fragmented under any
circumstances, it is to be discarded instead.
TEST_REFERENCE
RFC 791 s2.3 p8 Function Description (Fragmentation)
RFC 791 s3.2 p25 Discussion (Fragmentation and Reassembly)
TEST_METHOD
 SETUP: Configure DUT to set MTU on <DIface-0> to <HighMTU>
 SETUP: Configure DUT to set MTU on <DIface-1> to <LowMTU>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Total Length field set to greater than <LowMTU>
        - IP Flags field, containing:
          - DF bit set to 1
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Discard the ICMP Echo Request and do not forward
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Causing DUT to set MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to set MTU to 100 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 100

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 100 up
-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5),
containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Total Length field set to 110 (greater than <LowMTU> (100))
- IP Flags field, containing:
  - DF bit set to 1

Waiting (up to 30.000 seconds) for No ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 110 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF161 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7F4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000B (11)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [82 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF                                             ..
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Did not receive forwarded IP packet on <DIface-1>

Causing DUT to Reset MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to Reset MTU to 1500 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-3.2: Passed

>> IP-3.3
TEST_DESCRIPTION
The data of the long datagram is divided into two portions on a 8
octet (64 bit) boundary (the second portion might not be an
integral multiple of 8 octets, but the first must be).
TEST_REFERENCE
RFC 791 s2.3 p8 Function Description (Fragmentation)
RFC 791 s3.2 p25 Discussion)
TEST_METHOD
 SETUP: Configure DUT to set MTU on <DIface-0> to <HighMTU>
 SETUP: Configure DUT to set MTU on <DIface-1> to <LowMTU>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Total Length field set to greater than <LowMTU>
        - IP Flags field, containing:
          - DF bit set to zero
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward two fragmented packets
- ANVL: Verify that the received first fragmented packet 
        contains:
        - IP Fragment Offset field set to zero
        - IP Data length set to integral multiple of 8 octets.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Causing DUT to set MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to set MTU to 100 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 100

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 100 up
-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5),
containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Total Length field set to 110 (greater than <LowMTU> (100))
- IP Flags field, containing:
  - DF bit set to zero

Waiting (up to 30.000 seconds) for ICMP Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 110 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3162 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7F3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000C (12)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [82 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF                                             ..
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 100 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x126C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7F3 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000C (12)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [72 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF                           ........
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 30 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x000A (80 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x32A8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet (continuation [10 bytes]) ----
ICMP:
ICMP: --- Data [10 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF                     ..........
ICMP: --- Data End ---
ETHER: --- Padding [16 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER: --- Padding End ---


Received expected two IP packets on <DIface-1>

Fragment Offset field of first IP packet is correctly set
to zero

Data length of first IP packet is correctly set to integral
multiple of 8 octets (72 octets)

Causing DUT to Reset MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to Reset MTU to 1500 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-3.3: Passed

>> IP-3.4
TEST_DESCRIPTION
To assemble the fragments of an internet datagram, an internet
protocol module (for example at a destination host) combines
internet datagrams that all have the same value for the four
fields: identification, source, destination, and protocol.
TEST_REFERENCE
RFC 791 s2.3 p9 Function Description (Fragmentation)
RFC 791 s3.2 p29 Discussion (Identification)
RFC 1122 s3.3.2 p56 Reassembly
TEST_METHOD
- ANVL: Construct an ICMP Echo Request. Send an IP packet to 
        <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Identification field set to <id>
        - Protocol field set to <ipTypeICMP>
        - Fragment Offset field set to zero
        - Flags, containing:
          - MF bit set to 1
        - first half of the constructed ICMP packet
- ANVL: Send an IP packet to <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Identification field set to <id>
        - Protocol field set to <ipTypeICMP>
        - Fragment Offset field set to data size sent in first IP packet
          in unit of 8-octets
        - Flags, containing:
          - MF bit set to zero
        - last half of the constructed ICMP packet
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that Identifier, Sequence Number and Data of ICMP
        Echo Reply are same as those of ICMP Echo Request sent in two
        fragments.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to address of host-1 (30.1.1.150)
- Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 0
- Protocol field set to ICMP
- Fragment Offset field set to zero
- Flags, containing:
  - MF bit set to 1
- first half of the constructed ICMP packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1C35 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE529 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000D (13)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to address of host-1 (30.1.1.150)
- Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 0
- Protocol field set to ICMP
- Fragment Offset field set to 3
- Flags, containing:
  - MF bit set to zero
- last half of the constructed ICMP packet

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0003 (24 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C36 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet (continuation [20 bytes]) ----
ICMP:
ICMP: --- Data [20 bytes] ---
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0A81 (2689)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED29 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000D (13)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

Identifier field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 13

Sequence Number field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 0

Data of ICMP Echo Request sent and ICMP Echo Reply received
are correctly set to
41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
72 61 72 79                                       rary

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-3.4: Passed

>> IP-3.5
TEST_DESCRIPTION
To assemble the fragments of an internet datagram, an internet
protocol module (for example at a destination host) combines
internet datagrams that all have the same value for the four
fields: identification, source, destination, and protocol.
(Note: This test verifies that IP module does not assemble the
       fragments if identification is different).
TEST_REFERENCE
NEGATIVE
RFC 791 s2.3 p9 Function Description (Fragmentation)
TEST_METHOD
- ANVL: Construct an ICMP Echo Request. Send an IP packet to 
        <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Identification field set to <id1>
        - Protocol field set to <ipTypeICMP>
        - Fragment Offset field set to zero
        - Flags field, containing:
          - MF bit set to 1
        - first half of the constructed ICMP packet
- ANVL: Send an IP packet to <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Identification field set to <id2>
        - Protocol field set to <ipTypeICMP>
        - Fragment Offset field set to data size sent in first
          IP packet in unit of 8-octets
        - Flags field, containing:
          - MF bit set to zero
        - last half of the constructed ICMP packet
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Do not send ICMP Echo Reply
- ANVL: Send an IP packet to <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Identification field set to <id1>
        - Protocol field set to <ipTypeICMP>
        - Fragment Offset field set to data size sent in first 
          IP packet in unit of 8-octets
        - Flags field, containing:
          - MF bit set to zero
        - last half of the constructed ICMP packet
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that Identifier, Sequence Number and Data of ICMP
        Echo Reply are same as those of ICMP Echo Request sent in two
        fragments.
- ANVL: Wait for <FragReassemlyTimeout> seconds
- NOTE: ANVL has to wait for <FragReassemlyTimeout> seconds because
        when ANVL is sending the fragment with different identification,
        the fragment gets stored in DUT's reassembly buffer.
        If this fragment is not removed from the buffer then it may lead
        to a scenario where this fragment may be mistaken for a fragment-1 of another test case.
        So a timeout needs to occur for this fragment.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to address of host-1 (30.1.1.150)
- Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 1
- Protocol field set to ICMP
- Fragment Offset field set to zero
- Flags, containing:
  - MF bit set to 1
- first half of the constructed ICMP packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0001 (1)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1C34 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE528 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000E (14)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to address of host-1 (30.1.1.150)
- Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 2
- Protocol field set to ICMP
- Fragment Offset field set to 3
- Flags field, containing:
  - MF bit set to zero
- last half of the constructed ICMP packet

Waiting (up to 30.000 seconds) for No ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0002 (2)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0003 (24 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C34 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet (continuation [20 bytes]) ----
ICMP:
ICMP: --- Data [20 bytes] ---
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Did not receive ICMP Echo Reply on <DIface-0>

Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to address of host-1 (30.1.1.150)
- Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 1
- Protocol field set to ICMP
- Fragment Offset field set to 3
- Flags field, containing:
  - MF bit set to zero
- last half of the constructed ICMP packet

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0001 (1)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0003 (24 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C35 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet (continuation [20 bytes]) ----
ICMP:
ICMP: --- Data [20 bytes] ---
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0A82 (2690)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x319F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED28 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000E (14)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

Identifier field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 14

Sequence Number field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 0

Data of ICMP Echo Request sent and ICMP Echo Reply received
are correctly set to
41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
72 61 72 79                                       rary

Waiting (up to 85.000 seconds) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-3.5: Passed

>> IP-3.6
TEST_DESCRIPTION
To assemble the fragments of an internet datagram, an internet
protocol module (for example at a destination host) combines
internet datagrams that all have the same value for the four
fields: identification, source, destination, and protocol.
(Note: This test verifies that IP module does not assemble the
       fragments if source is different).
TEST_REFERENCE
NEGATIVE
RFC 791 s2.3 p9 Function Description (Fragmentation)
TEST_METHOD
- ANVL: Construct an ICMP Echo Request. Send an IP packet to 
        <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Identification field set to <id>
        - Protocol field set to <ipTypeICMP>
        - Fragment Offset field set to zero
        - Flags field, containing:
          - MF bit set to 1
        - first half of the constructed ICMP packet
- ANVL: Send an IP packet to <DIface-0>, containing:
        - Source Address field set to different address from 
          host-1 
        - Destination Address field set to address of DUT
        - Identification field set to <id>
        - Protocol field set to <ipTypeICMP>
        - Fragment Offset field set to data size sent in first 
          IP packet in unit of 8-octets
        - Flags field, containing:
          - MF bit set to zero
        - last half of the constructed ICMP packet
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Do not send ICMP Echo Reply
- ANVL: Send an IP packet to <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Identification field set to <id>
        - Protocol field set to <ipTypeICMP>
        - Fragment Offset field set to data size sent in first 
          IP packet in unit of 8-octets
        - Flags field, containing:
          - MF bit set to zero
        - last half of the constructed ICMP packet
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that Identifier, Sequence Number and Data of ICMP
        Echo Reply are same as those of ICMP Echo Request sent in two
        fragments.
- ANVL: Wait for <FragReassemlyTimeout> seconds
- NOTE: ANVL has to wait for <FragReassemlyTimeout> seconds because
        when ANVL is sending the fragment with different source address,
        the fragment gets stored in DUT's reassembly buffer.
        If this fragment is not removed from the buffer then it may lead
        to a scenario where this fragment may be mistaken for a fragment-1 of another test case.
        So a timeout needs to occur for this fragment.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to address of host-1 (30.1.1.150)
- Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 0
- Protocol field set to ICMP
- Fragment Offset field set to zero
- Flags field, containing:
  - MF bit set to 1
- first half of the constructed ICMP packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1C35 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE527 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000F (15)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to 30.1.1.160 different address from
  host-1 (30.1.1.150)
- Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 0
- Protocol field set to ICMP
- Fragment Offset field set to 3
- Flags field, containing:
  - MF bit set to zero
- last half of the constructed ICMP packet

Waiting (up to 30.000 seconds) for No ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0003 (24 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C2C (Correct)
IP: Source Address         = 30.1.1.160
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet (continuation [20 bytes]) ----
ICMP:
ICMP: --- Data [20 bytes] ---
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Did not receive ICMP Echo Reply on <DIface-0>

Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to address from host-1 (30.1.1.150)
- Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 0
- Protocol field set to ICMP
- Fragment Offset field set to 3
- Flags field, containing:
  - MF bit set to zero
- last half of the constructed ICMP packet

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0003 (24 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C36 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet (continuation [20 bytes]) ----
ICMP:
ICMP: --- Data [20 bytes] ---
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x5400 (21504)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xE820 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED27 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000F (15)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

Identifier field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 15

Sequence Number field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 0

Data of ICMP Echo Request sent and ICMP Echo Reply received
are correctly set to
41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
72 61 72 79                                       rary

Waiting (up to 85.000 seconds) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-3.6: Passed

>> IP-3.7
TEST_DESCRIPTION
To assemble the fragments of an internet datagram, an internet
protocol module (for example at a destination host) combines
internet datagrams that all have the same value for the four
fields: identification, source, destination, and protocol.
(Note: This test verifies that IP module does not assemble the
       fragments if destination is different).
TEST_REFERENCE
NEGATIVE
RFC 791 s2.3 p9 Function Description (Fragmentation)
TEST_METHOD
- ANVL: Construct an ICMP Echo Request. Send an IP packet to 
        <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Identification field set to <id>
        - Protocol field set to <ipTypeICMP>
        - Fragment Offset field set to zero
        - Flags field, containing:
          - MF bit set to 1
        - first half of the constructed ICMP packet
- ANVL: Send an IP packet to <DIface-0>, containing:
        - Source Address field set to address of host-1 
        - Destination Address field set to address of host-2
        - Identification field set to <id>
        - Protocol field set to <ipTypeICMP>
        - Fragment Offset field set to data size sent in first 
          IP packet in unit of 8-octets
        - Flags field, containing:
          - MF bit set to zero
        - last half of the constructed ICMP packet
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Do not send ICMP Echo Reply
- ANVL: Send an IP packet to <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Identification field set to <id>
        - Protocol field set to <ipTypeICMP>
        - Fragment Offset field set to data size sent in first 
          IP packet in unit of 8-octets
        - Flags field, containing:
          - MF bit set to zero
        - last half of the constructed ICMP packet
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that Identifier, Sequence Number and Data of ICMP
        Echo Reply are same as those of ICMP Echo Request sent in two
        fragments.
- ANVL: Wait for <FragReassemlyTimeout> seconds
- NOTE: ANVL has to wait for <FragReassemlyTimeout> seconds because
        when ANVL is sending the fragment with different destination address,
        the fragment gets stored in DUT's reassembly buffer.
        If this fragment is not removed from the buffer then it may lead
        to a scenario where this fragment may be mistaken for a fragment-1 of another test case.
        So a timeout needs to occur for this fragment.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to address of host-1 (30.1.1.150)
- Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 0
- Protocol field set to ICMP
- Fragment Offset field set to zero
- Flags field, containing:
  - MF bit set to 1
- first half of the constructed ICMP packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1C35 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE526 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0010 (16)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to address of host-1 (30.1.1.150)
- Destination Address field set to address of host-2 (40.1.1.150)
- Identification field set to 0
- Protocol field set to ICMP
- Fragment Offset field set to 3
- Flags field, containing:
  - MF bit set to zero
- last half of the constructed ICMP packet

Waiting (up to 30.000 seconds) for No ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0003 (24 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet (continuation [20 bytes]) ----
ICMP:
ICMP: --- Data [20 bytes] ---
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Did not receive ICMP Echo Reply on <DIface-0>

Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to address of host-1 (30.1.1.150)
- Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 0
- Protocol field set to ICMP
- Fragment Offset field set to 3
- Flags field, containing:
  - MF bit set to zero
- last half of the constructed ICMP packet

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0003 (24 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C36 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet (continuation [20 bytes]) ----
ICMP:
ICMP: --- Data [20 bytes] ---
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0xC7D6 (51158)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x744A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED26 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0010 (16)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

Identifier field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 16

Sequence Number field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 0

Data of ICMP Echo Request sent and ICMP Echo Reply received
are correctly set to
41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
72 61 72 79                                       rary

Waiting (up to 85.000 seconds) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-3.7: Passed

>> IP-3.8
TEST_DESCRIPTION
To assemble the fragments of an internet datagram, an internet
protocol module (for example at a destination host) combines
internet datagrams that all have the same value for the four
fields: identification, source, destination, and protocol.
(Note: This test verifies that IP module does not assemble the
       fragments if protocol is different).
TEST_REFERENCE
NEGATIVE
RFC 791 s2.3 p9 Function Description (Fragmentation)
TEST_METHOD
- ANVL: Construct an ICMP Echo Request. Send an IP packet to 
        <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Identification field set to <id>
        - Protocol field set to <ipTypeICMP>
        - Fragment Offset field set to zero
        - Flags field, containing:
          - MF bit set to 1
        - first half of the constructed ICMP packet
- ANVL: Send an IP packet to <DIface-0>, containing:
        - Source Address field set to address of host-1 
        - Destination Address field set to address of DUT
        - Identification field set to <id>
        - Protocol field set to <ipTypeTCP>
        - Fragment Offset field set to data size sent in first 
          IP packet in unit of 8-octets
        - Flags field, containing:
          - MF bit set to zero
        - last half of the constructed ICMP packet
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Do not send ICMP Echo Reply
- ANVL: Send an IP packet to <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Identification field set to <id>
        - Protocol field set to <ipTypeICMP>
        - Fragment Offset field set to data size sent in first 
          IP packet in unit of 8-octets
        - Flags field, containing:
          - MF bit set to zero
        - last half of the constructed ICMP packet
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that Identifier, Sequence Number and Data of ICMP
        Echo Reply are same as those of ICMP Echo Request sent in two
        fragments.
- ANVL: Wait for <FragReassemlyTimeout> seconds
- NOTE: ANVL has to wait for <FragReassemlyTimeout> seconds because
        when ANVL is sending the fragment with different protocol,
        the fragment gets stored in DUT's reassembly buffer.
        If this fragment is not removed from the buffer then it may lead
        to a scenario where this fragment may be mistaken for a fragment-1 of another test case.
        So a timeout needs to occur for this fragment.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to address of host-1 (30.1.1.150)
- Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 0
- Protocol field set to ICMP
- Fragment Offset field set to zero
- Flags field, containing:
  - MF bit set to 1
- first half of the constructed ICMP packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1C35 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE525 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0011 (17)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to address of host-1 (30.1.1.150)
- Destination Address field set to address of (30.1.1.5)
- Identification field set to 0
- Protocol field set to TCP
- Fragment Offset field set to 3
- Flags field, containing:
  - MF bit set to zero
- last half of the constructed ICMP packet

Waiting (up to 30.000 seconds) for No ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0003 (24 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x3C31 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
TCP: ---- TCP Packet (continuation [20 bytes]) ----
TCP:
TCP: --- Trailing Data [20 bytes] ---
TCP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
TCP:  72 61 72 79                                       rary
TCP: --- Trailing Data End ---
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Did not receive ICMP Echo Reply on <DIface-0>

Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- Source Address field set to address of host-1 (30.1.1.150)
- Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 0
- Protocol field set to ICMP
- Fragment Offset field set to 3
- Flags field, containing:
  - MF bit set to zero
- last half of the constructed ICMP packet

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0003 (24 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C36 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet (continuation [20 bytes]) ----
ICMP:
ICMP: --- Data [20 bytes] ---
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0xD241 (53825)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x69DF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED25 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0011 (17)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

Identifier field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 17

Sequence Number field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 0

Data of ICMP Echo Request sent and ICMP Echo Reply received
are correctly set to
41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
72 61 72 79                                       rary

Waiting (up to 85.000 seconds) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-3.8: Passed

>> IP-4.1
TEST_DESCRIPTION
A datagram whose version number is not 4 MUST be silently 
discarded.
TEST_REFERENCE
NEGATIVE
RFC 791 s3.1 p11 Internet Header Format (Version)
RFC 1122 s3.2.1.1 p29 Version Number: RFC-791 Section 3.1
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Version field set to other than <IP_VERSION_4>
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Discard ICMP Echo Request and do not send ICMP Echo 
        Reply
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Version field set to 5 (other than <IP_VERSION_4>)

Waiting (up to 30.000 seconds) for No ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 5
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2C21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE524 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0012 (18)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Did not receive ICMP Echo Reply on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-4.1: Passed

>> IP-4.2
TEST_DESCRIPTION
All hosts must be prepared to accept datagrams of up to 576 octets.
TEST_REFERENCE
RFC 791 s3.1 p13 Internet Header Format
RFC 791 s3.2 p25 Discussion
RFC 1122 s3.3.3 p60 Fragmentation
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Total Length field set to 576
        - IP Payload field, containing:
          - 556 bytes data
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that Identifier, Sequence Number and Data of ICMP
        Echo Reply are same as those of ICMP Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Total Length field set to 576
- IP Payload field, containing:
  - 556 bytes data

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3A21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7EC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0013 (19)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [548 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF                                       ....
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x935E (37726)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xA6C2 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFFEC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0013 (19)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [548 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF                                       ....
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

Identifier field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 19

Sequence Number field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 0

Data of ICMP Echo Request sent and ICMP Echo Reply received
are correctly set to
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
FF FF FF FF                                       ....

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-4.2: Passed

>> IP-4.3
TEST_DESCRIPTION
Bit 0 of Flags field is reserved and must be zero.
TEST_REFERENCE
NEGATIVE
RFC 791 s3.1 p13 Internet Header Format
RFC 1812 s4.2.2.3 p43 Unused IP Header Bits: RFC 791 Section 3.1
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Flags field, containing:
          - bit 0 set to <non-reserve-value>
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward ICMP Echo Request
- ANVL: Verify that the received ICMP Echo Request contains:
        - IP Flags field, containing:
          - bit 0 set to <non-reserve-value>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Flags field, containing:
- bit 0 set to 1

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 4
IP:  |012
IP:  |1..                  = Reserved (*Should be 0*)
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xB18F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE522 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0014 (20)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 4
IP:  |012
IP:  |1..                  = Reserved (*Should be 0*)
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xB28F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE522 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0014 (20)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo request on <DIface-1>

bit 0 of IP Flags of ICMP Echo Request is correctly set to 1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-4.3: Passed

>> IP-4.4
TEST_DESCRIPTION
The checksum field is the 16 bit one's complement of the one's
complement sum of all 16 bit words in the header.  For purposes of
computing the checksum, the value of the checksum field is zero.
(Note: Here we are verifying that DUT uses same checksum calculation
       method as we are expecting)
TEST_REFERENCE
RFC 791 s3.1 p14 Internet Header Format
TEST_METHOD
- ANVL: Cause DUT to send an ICMP Echo Request through <DIface-0>,
        containing:
        - IP Destination Address set to address of host-1
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Request
- ANVL: Verify that the received ICMP Echo Request contains:
        - IP Checksum field set to "16 bit one's complement of the
          one's complement sum of all 16 bit words in the header"
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Causing DUT to send 1 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 30.1.1.150
ICMP Echo Data size 16
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 0 1 16

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 30.1.1.0
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x1D8A (7562)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1E9F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x1ADC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x649D (25757)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [28 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B               0123456789:;
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Request from DUT

IP Header Checksum field of ICMP Echo Request is correctly
set to 0x1E9F (16 bit one's complement of the one's complement
sum of all 16 bit words in the header)
cmd ping -c 1 -s 36 30.1.1.150

Pinging 30.1.1.150 (30.1.1.150) with 36 bytes of data:

--- 30.1.1.150 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 1017 ms
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-4.4: Passed

>> IP-4.5
TEST_DESCRIPTION
The checksum field is the 16 bit one's complement of the one's
complement sum of all 16 bit words in the header.  For purposes of
computing the checksum, the value of the checksum field is zero.
(Note: Here we send an Echo Request with checksum calculated 
       according to rfc. DUT receives this Echo Request, verifies
       the Echo Request and then sends Echo Reply. We then verify
       that DUT uses the checksum calculation method according to
       rfc)
TEST_REFERENCE
RFC 791 s3.1 p14 Internet Header Format
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Checksum field set to "16 bit one's complement 
          of the one's complement sum of all 16 bit words in 
          the header"
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that the received ICMP Echo Reply contains:
        - IP Checksum field to "16 bit one's complement 
          of the one's complement sum of all 16 bit words 
          in the header"
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1
  (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Checksum field set to "16 bit one's complement
  of the one's complement sum of all 16 bit words in
  the header"
Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE521 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0015 (21)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x935F (37727)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xA8C1 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED21 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0015 (21)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

IP Header Checksum field of ICMP Echo Reply is correctly
set to 0xA8C1 (16 bit one's complement of the one's complement
sum of all 16 bit words in the header)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-4.5: Passed

>> IP-4.6
TEST_DESCRIPTION
A router MUST discard messages containing invalid checksums.
TEST_REFERENCE
NEGATIVE
RFC 1812 s4.2.2.5 p44 Header Checksum: RFC 791 Section 3.1
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Checksum field set to <invalidChecksum>
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Discard the ICMP Echo Request and do not forward
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Checksum field set to 0x3191 (invalid checksum)

Waiting (up to 30.000 seconds) for No ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3191 *Should be 0x3190*
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE520 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0016 (22)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Did not receive forwarded ICMP Echo Request on <DIface-1>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-4.6: Passed

>> IP-5.1
TEST_DESCRIPTION
End of Option List option indicates the end of the option list.
(Note: Here we are verifying that DUT does not crash on receiving
       multiple End of Options)
TEST_REFERENCE
NEGATIVE
RFC 791 s3.1 p16 Internet Header Format (End of Option List)
RFC 791 s3.2 p31 Options
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - Four End of Option List options
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that Identifier, Sequence Number and Data of ICMP
        Echo Reply are same as those of ICMP Echo Request sent
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - Four End of Option List options

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3B1D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [3 bytes] ---
IP:  00 00 00                                          ...
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE51F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0017 (23)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0xBFFB (49147)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7C25 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED1F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0017 (23)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

Identifier field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 23

Sequence Number field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 0

Data of ICMP Echo Request sent and ICMP Echo Reply received
are correctly set to
41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
72 61 72 79                                       rary

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.1: Passed

>> IP-5.2
TEST_DESCRIPTION
End of Option List is used at the end of all options, not the end
of each option
TEST_REFERENCE
NEGATIVE
RFC 791 s3.1 p16 Internet Header Format (End of Option List)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of 
          <DIface-0>
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 12
            - pointer field set to 9 
            - flg field set to zero
            - one timestamp value
          - One End of Option List option
          - One Loose Source and Record Route option, 
            containing:
            - length field set to 7
            - pointer field set to 4
            - route data, containing:
              - address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Do not forward ICMP Echo Request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Internet Timestamp option, containing:
    - length field set to 12
    - pointer field set to 9 
    - flg field set to zero
  - one timestamp value
    - One End of Option List option
    - One Loose Source and Record Route option, 
      containing:
      - length field set to 7
      - pointer field set to 4
      - route data, containing:
        - address of host-2

Waiting (up to 30.000 seconds) for No ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 10 (40 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xFF81 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 44938931
IP OPT: TimeStamp          = 0
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE51E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0018 (24)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Did not receive forwarded ICMP Echo Request on <DIface-1>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.2: Passed

>> IP-5.3
TEST_DESCRIPTION
End of Option List need only be used if the end of the options
would not otherwise coincide with the end of the internet header.
TEST_REFERENCE
RFC 791 s3.1 p16 Internet Header Format (End of Option List)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of 
          <DIface-0>
        - IP Options, containing:
          - One Loose Source and Record Route option, 
            containing:
            - length field set to 7
            - pointer field set to 4
            - route data, containing:
              - address of host-2
          - One End of Option List option
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward ICMP Echo Request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Loose Source and Record Route option,
    containing:
    - length field set to 7
    - pointer field set to 4
    - route data, containing:
      - address of host-2 (40.1.1.150)
  - One End of Option List option

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1BE8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE51D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0019 (25)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x9F57 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 40.1.1.5
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE51D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0019 (25)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.3: Passed

>> IP-5.4
TEST_DESCRIPTION
No Operation option may be used between options, for example, to
align the beginning of a subsequent option on a 32 bit boundary.
TEST_REFERENCE
RFC 791 s3.1 p17 Internet Header Format (No Operation)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of 
          <DIface-0>
        - IP Options, containing:
          - One Loose Source and Record Route option, 
            containing:
            - length field set to 7
            - pointer field set to 4
            - route data, containing:
              - address of host-2
          - One No Operation option (for alignment)
          - One Record Route option, containing:
            - length field set to 7
            - pointer field set to 4
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward ICMP Echo Request
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Loose Source and Record Route option,
    containing:
    - length field set to 7
    - pointer field set to 4
    - route data, containing:
      - address of host-2 (40.1.1.150)
  - One No Operation option (for alignment)
    - One Record Route option, containing:
    - length field set to 7

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 9 (36 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0ED8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x01 (No Operation)
IP OPT:
IP OPT: Type               = 0x07 (Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 0.0.0.0
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE51C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001A (26)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 9 (36 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x881E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 40.1.1.5
IP OPT:
IP OPT: Type               = 0x01 (No Operation)
IP OPT:
IP OPT: Type               = 0x07 (Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 40.1.1.5
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE51C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001A (26)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.4: Passed

>> IP-5.5
TEST_DESCRIPTION
Security Option Must be copied on fragmentation.
TEST_REFERENCE
RFC 791 s3.1 p18 Internet Header Format (Security)
TEST_METHOD
 SETUP: Configure DUT to set MTU on <DIface-0> to <HighMTU>
 SETUP: Configure DUT to set MTU on <DIface-1> to <LowMTU>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Total Length field set to greater than <LowMTU>
        - IP Flags field, containing:
          - DF bit set to zero
        - IP Options, containing:
          - One Security Option
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward two fragmented packets
- ANVL: Verify that the received two fragmented packets contain:
        - IP Security option
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Causing DUT to set MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to set MTU to 100 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 100

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 100 up
-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Total Length field set to 110 (greater than <LowMTU> 100)
  - IP Flags field, containing:
    - DF bit set to zero
- IP Options, containing:
  - One Security Option

Waiting (up to 30.000 seconds) for ICMP Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 110 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xAC56 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x82 (Security)
IP OPT: Length             = 11
IP OPT: Security           = 0x0000 (Unclassified)
IP OPT: Compartments       = 0
IP OPT: Handling Restrict  = 0
IP OPT: Trans Ctrl Code    = 0x000000
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7E4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001B (27)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [70 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF                                 ......
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x8D64 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x82 (Security)
IP OPT: Length             = 11
IP OPT: Security           = 0x0000 (Unclassified)
IP OPT: Compartments       = 0
IP OPT: Handling Restrict  = 0
IP OPT: Trans Ctrl Code    = 0x000000
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7E4 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001B (27)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [56 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF                           ........
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 46 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0008 (64 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2318 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x01 (No Operation)
IP OPT:
IP OPT: Type               = 0x82 (Security)
IP OPT: Length             = 11
IP OPT: Security           = 0x0000 (Unclassified)
IP OPT: Compartments       = 0
IP OPT: Handling Restrict  = 0
IP OPT: Trans Ctrl Code    = 0x000000
IP OPT:
IP:
ICMP: ---- ICMP Packet (continuation [14 bytes]) ----
ICMP:
ICMP: --- Data [14 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF         ..............
ICMP: --- Data End ---


Received expected forwarded two IP fragments on <DIface-1>

First IP fragment correctly contains IP Security Option

Second IP fragment correctly contains IP Security Option

Causing DUT to Reset MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to Reset MTU to 1500 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.5: Passed

>> IP-5.7
TEST_DESCRIPTION
The third octet is the pointer into the route data indicating the
octet which begins the next Source Address to be processed.
(Note: If the address in destination address field has been reached and
       the pointer is not greater than the length, the next address in
       the source route replaces the address in the destination address
       field, and the recorded route address replaces the source
       address just used ...)
TEST_REFERENCE
RFC 791 s3.1 p18 Internet Header Format (Loose Source and Record 
Route)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of <DIface-0>
        - IP Options, containing:
          - One Loose Source and Record Route option, 
            containing:
            - length field set to 7
            - pointer field set to 4
            - route data, containing:
              - address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward ICMP Echo Request
- ANVL: Verify that the received ICMP Echo Request contains:
        - IP Loose Source and Record Route option, containing:
          - route data field set to address of <DIface-1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of <DIface-0> (30.1.1.5)
- IP Options, containing:
  - One Loose Source and Record Route option, containing:
    - length field set to 7
    - pointer field set to 4
    - route data, containing:
      - address of host-2 (40.1.1.150)

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1BE8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE51A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001C (28)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x9F57 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 40.1.1.5
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE51A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001C (28)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

ICMP Echo Request correctly contains IP Loose Source and
Record Route Option

Route data field of IP Loose Source and Record Route
Option is correctly set to 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.7: Passed

>> IP-5.8
TEST_DESCRIPTION
The third octet is the pointer into the route data indicating the
octet which begins the next Source Address to be processed.
(Note: If the address in destination address field has been reached and
       the pointer is not greater than the length, the next address in
       the source route replaces the address in the destination address
       field, and the recorded route address replaces the source
       address just used ...)
TEST_REFERENCE
NEGATIVE
RFC 791 s3.1 p18 Internet Header Format (Loose Source and Record 
Route)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of 
          <DIface-0>
        - IP Options, containing:
          - One Loose Source and Record Route option, 
            containing:
            - length field set to 7
            - pointer field set to 4
            - route data, containing:
              - address of other subnet different from host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Destination Unreachable Message as DUT has
        no way to reach the destination on different subnet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Loose Source and Record Route option, containing:
    - length field set to 7
    - pointer field set to 4
    - route data, containing:
      - address 50.0.0.1 (different from subnet of host-2
                   (40.1.1.150))

Waiting (up to 30.000 seconds) for ICMP Destination Unreachable Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xB1DF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 50.0.0.1
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE519 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001D (29)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 108 bytes
IP: Identification         = 0x2DBC (11708)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xEE0B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 30.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 3 (Destination Unreachable)
ICMP: Code             = 5 (Source Route Failed)
ICMP: Checksum         = 0xE9FF (Correct)
ICMP:
ICMP: ---- ICMP Data ----
ICMP:
ICMP: Unused           = 0x00000000
ICMP:
ICMP: IP: ---- IP Packet ----
ICMP: IP:
ICMP: IP: Version                = 4
ICMP: IP: Internet Header Length = 7 (28 bytes)
ICMP: IP: Type Of Service        = 0x00
ICMP: IP:  |01234567
ICMP: IP:  |000.....             = Precedence (Routine)
ICMP: IP:  |...0....             = Normal Delay
ICMP: IP:  |....0...             = Normal Throughput
ICMP: IP:  |.....0..             = Normal Reliability
ICMP: IP:  |......0.             = Normal Monetary Cost
ICMP: IP:  |.......0             = Must Be Zero 
ICMP: IP: Total Length           = 72 bytes
ICMP: IP: Identification         = 0x0000 (0)
ICMP: IP: Flags                  = 0
ICMP: IP:  |012
ICMP: IP:  |0..                  = Reserved 
ICMP: IP:  |.0.                  = May Fragment
ICMP: IP:  |..0                  = Last Fragment
ICMP: IP: Fragment Offset        = 0x0000 (0 bytes)
ICMP: IP: Time to Live           = 64
ICMP: IP: Protocol               = ICMP (1)
ICMP: IP: Header Checksum        = 0xB1DF *Should be 0x9EE4*
ICMP: IP: Source Address         = 30.1.1.150
ICMP: IP: Destination Address    = 50.0.0.1
ICMP: IP: ---- Options ----
ICMP: IP OPT:
ICMP: IP OPT: Type               = 0x83 (Loose Source and Record Route)
ICMP: IP OPT: Length             = 7
ICMP: IP OPT: Pointer            = 4
ICMP: IP OPT: Route Data         = 50.0.0.1
ICMP: IP OPT:
ICMP: IP OPT: Type               = 0x00 (End of Option List)
ICMP: IP OPT:
ICMP: IP:
ICMP: IP: ---- End of IP Header ----
ICMP: IP:
ICMP: IP: --- 64 bits of datagram [8 bytes] ---
ICMP: IP:  08 00 E5 19 00 1D 00 00                           ........
ICMP: IP: --- 64 bits of datagram End ---
ICMP: --- Trailing Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Trailing Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Destination Unreachable Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.8: Passed

>> IP-5.9
TEST_DESCRIPTION
If the pointer is greater than the length, the source route is
empty (and the recorded route full) and the routing is to be based
on the destination address field.
TEST_REFERENCE
RFC 791 s3.1 p18 Internet Header Format (Loose Source and Record 
Route)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of 
          <DIface-0>
        - IP Options, containing:
          - One Loose Source and Record Route option, 
            containing:
            - length field set to 7
            - pointer field set to 8
            - route data, containing:
              - address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Send ICMP Echo Reply as recent route in option is address
        of host-2
- ANVL: Verify that the received ICMP Echo Reply contains:
        - IP Loose Source and Record Route option, containing:
          - route data field set to address of host-1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Loose Source and Record Route option, containing:
    - length field set to 7
    - pointer field set to 8
    - route data, containing:
      - address of host-2 (40.1.1.150)

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x17E8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE518 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001E (30)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0xC9AD (51629)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x4740 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 30.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [4 bytes] ---
IP:  00 00 00 00                                       ....
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED18 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001E (30)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-1>

ICMP Echo Reply correctly contains IP Loose Source and
Record Route Option

Route data field of IP Loose Source and Record Route
Option is correctly set to 30.1.1.150 (address of host-1)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.9: Passed

>> IP-5.10
TEST_DESCRIPTION
If the address in destination address field has been reached and
the pointer is not greater than the length, the next address in
the source route replaces the address in the destination address
field, and the recorded route address replaces the source
address just used, and pointer is increased by four.
TEST_REFERENCE
RFC 791 s3.1 p19 Internet Header Format (Loose Source and Record
Route)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of <DIface-0>
        - IP Options, containing:
          - One Loose Source and Record Route option, 
            containing:
            - length field set to 7
            - pointer field set to 4
            - route data, containing:
              - address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward ICMP Echo Request
- ANVL: Verify that the received ICMP Echo Request contains:
        - IP Loose Source and Record Route option, containing:
          - route data field set to address of <DIface-1>
          - pointer field set to 8
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Loose Source and Record Route option, containing:
    - length field set to 7
    - pointer field set to 4
    - route data, containing:
      - address of host-2 (40.1.1.150)

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1BE8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE517 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001F (31)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x9F57 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 40.1.1.5
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE517 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001F (31)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

Route data field of IP Loose Source and Record Route
Option is correctly set to 40.1.1.5

Pointer field of IP Loose Source and Record Route Option
is correctly set to 8

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.10: Passed

>> IP-5.11
TEST_DESCRIPTION
This option is a loose source route because the gateway or host
IP is allowed to use any route of any number of other
intermediate gateways to reach the next address in the route.
TEST_REFERENCE
RFC 791 s3.1 p19 Internet Header Format (Loose Source and Record
Route)
TEST_METHOD
 SETUP: Configure DUT to add static route for <RTR-2> via gateway 
        <RTR-1> and outgoing interface <DIface-1>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of <DIface-0>
        - IP Options, containing:
          - One Loose Source and Record Route option,
            containing:
            - length field set to 7
            - pointer field set to 4
            - route data, containing:
              - address of RTR-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward ICMP Echo Request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Causing DUT to add a static route on DUT for
Destination Address 50.0.0.1
Gateway Address 40.1.1.150
outgoing interface <DIface-1>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
50.0.0.1 40.1.1.150 1 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -host 50.0.0.1 40.1.1.150
    add host 50.0.0.1: gateway 40.1.1.150
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       23    gei0   0    
30.1.1.5                        30.1.1.5                      UH       26    lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       12    gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
50.0.0.1                        40.1.1.150                    UGHS     0     gei1   0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       392   gei2   0    
vxTarget                        vxTarget                      UH       2521  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       88828 lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Loose Source and Record Route option, containing:
    - length field set to 7
    - pointer field set to 4
    - route data, containing:
      - address of RTR-2 (50.0.0.1)

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xB1DF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 50.0.0.1
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE516 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0020 (32)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x96ED (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 50.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 40.1.1.5
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE516 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0020 (32)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

Causing DUT to delete static route on DUT for
Destination Address 50.0.0.1
Gateway Address 40.1.1.150
outgoing interface <DIface-1>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
50.0.0.1 40.1.1.150 1 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -host 50.0.0.1 
    delete host 50.0.0.1
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       23    gei0   0    
30.1.1.5                        30.1.1.5                      UH       27    lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       12    gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       393   gei2   0    
vxTarget                        vxTarget                      UH       2538  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       90778 lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.11: Passed

>> IP-5.12
TEST_DESCRIPTION
Loose Source and Record Route option Must be copied on
fragmentation.
TEST_REFERENCE
RFC 791 s3.1 p19 Internet Header Format (Loose Source and Record
Route)
TEST_METHOD
 SETUP: Configure DUT to set MTU on <DIface-0> to <HighMTU>
 SETUP: Configure DUT to set MTU on <DIface-1> to <LowMTU>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of <DIface-0>
        - IP Total Length field set to greater than <LowMTU>
        - IP Options, containing:
          - One Loose Source and Record Route option,
            containing:
            - length field set to 7
            - pointer field set to 4
            - route data, containing:
              - address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward two fragmented packets
- ANVL: Verify that the received two fragmented packets contain:
        - IP Loose Source and Record Route option, containing:
          - route data field set to address of <DIface-1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Causing DUT to set MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to set MTU to 100 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 100

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 100 up
-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Total Length field set to 110 (greater than <LowMTU> 100)
- IP Options, containing:
  - One Loose Source and Record Route option,
    containing:
    - length field set to 7
    - pointer field set to 4
    - route data, containing:
      - address of host-2 (40.1.1.150)

Waiting (up to 30.000 seconds) for ICMP Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 110 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1BC2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7DE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0021 (33)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [74 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF                     ..........
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 100 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7F3B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 40.1.1.5
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7DE 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0021 (33)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [64 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 38 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0009 (72 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xFF0F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x01 (No Operation)
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 40.1.1.5
IP OPT:
IP:
ICMP: ---- ICMP Packet (continuation [10 bytes]) ----
ICMP:
ICMP: --- Data [10 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF                     ..........
ICMP: --- Data End ---
ETHER: --- Padding [8 bytes] ---
ETHER:  00 00 00 00 00 00 00 00                           ........
ETHER: --- Padding End ---


Received expected forwarded two IP fragments on <DIface-1>

First fragment correctly contains IP Loose Source and
Record Route Option

Route data field of IP Loose Source and Record Route
Option of first fragment is correctly set to 40.1.1.5

Second fragment correctly contains IP Loose Source and
Record Route Option

Route data field of IP Loose Source and Record Route
Option of second fragment is correctly set to 40.1.1.5

Causing DUT to Reset MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to Reset MTU to 1500 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.12: Passed

>> IP-5.13
TEST_DESCRIPTION
It is an error for more than one loose source route option to
appear in a datagram. If it receives such a datagram, it SHOULD
discard the packet.
TEST_REFERENCE
NEGATIVE
RFC 791 s3.1 p19 Internet Header Format (Loose Source and Record
Route)
RFC 1812 s5.2.4.1 p72 IP Destination Address
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of <DIface-0>
        - IP Options, containing:
          - two Loose Source and Record Route options,
            each containing:
            - length field set to 7
            - pointer field set to 4
            - route data, containing:
              - address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Discard the ICMP Echo Request and do not forward
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - Two Loose Source and Record Route options,
    each containing:
    - length field set to 7
    - pointer field set to 4
    - route data, containing:
      - address of host-2 (40.1.1.150)

Waiting (up to 30.000 seconds) for No ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 9 (36 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xE8C1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE514 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0022 (34)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Did not receive forwarded ICMP Echo Request on <DIface-1>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.13: Passed

>> IP-5.14
TEST_DESCRIPTION
Loose Source and Record Route option appears at most once in a
datagram. If it receives such a datagram it replies with an ICMP
Parameter Problem message whose pointer points at the beginning
of the second source route option.
TEST_REFERENCE
NEGATIVE
RFC 791 s3.1 p19 Internet Header Format (Loose Source and Record
Route)
RFC 1122 s3.2.1.8 p36 Options: RFC-791 Section 3.2 ((c)  Source
Route Options)
RFC 1812 s5.2.4.1 p72 IP Destination Address
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of <DIface-0>
        - IP Options, containing:
          - two Loose Source and Record Route options,
            each containing:
            - length field set to 7
            - pointer field set to 4
            - route data, containing:
              - address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Parameter Problem Message
- ANVL: Verify that the received ICMP Parameter Problem Message
        contains:
        - Pointer field set to 27 (Basic IP Header length (20) +
                                   One Loose Source Option length (7))
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - Two Loose Source and Record Route options,
    each containing:
    - length field set to 7
    - pointer field set to 4
    - route data, containing:
      - address of host-2 (40.1.1.150)

Waiting (up to 30.000 seconds) for ICMP Parameter Problem Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 9 (36 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xE8C1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE513 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0023 (35)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 116 bytes
IP: Identification         = 0xAAE9 (43753)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x70D6 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 30.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 12 (Parameter Problem)
ICMP: Code             = 0 (Pointer Indicates the Error)
ICMP: Checksum         = 0xD8FF (Correct)
ICMP:
ICMP: ---- ICMP Parameter Problem Data ----
ICMP:
ICMP: Pointer          = 27
ICMP: Unused           = 0x000000
ICMP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 9 (36 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xE8C1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE513 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0023 (35)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Parameter Problem Message on <DIface-0>

Pointer field of ICMP Parameter Problem Message is correctly
set to 27

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.14: Passed

>> IP-5.15
TEST_DESCRIPTION
If the pointer is greater than the length, the source route is
empty (and the recorded route full) and the routing is to be based
on the destination address field.
TEST_REFERENCE
RFC 791 s3.1 p19 Internet Header Format (Strict Source and Record
Route option)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - One Strict Source and Record Route option,
            containing:
            - length field set to 7
            - pointer field set to 8
            - route data, containing:
              - address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Send ICMP Echo Reply as recent route in option is address
        of host-2
- ANVL: Verify that the received ICMP Echo Reply contains:
        - IP Strict Source and Record Route option, containing:
          - route data field set to address of host-1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Strict Source and Record Route option, containing:
    - length field set to 7
    - pointer field set to 8
    - route data, containing:
      - address of host-2 (40.1.1.150)

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x11E8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x89 (Strict Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE512 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0024 (36)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0xAAEA (43754)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x6003 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x89 (Strict Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 30.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [4 bytes] ---
IP:  00 00 00 00                                       ....
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED12 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0024 (36)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-1>

ICMP Echo Reply correctly contains IP Strict Source and
Record Route Option

Route data field of IP Strict Source and Record Route
Option is correctly set to 30.1.1.150 (address of host-1)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.15: Passed

>> IP-5.20
TEST_DESCRIPTION
It is an error for more than one strict source route option to 
appear in a datagram. If it receives such a datagram, it SHOULD 
discard the packet.
TEST_REFERENCE
NEGATIVE
RFC 791 s3.1 p19 Internet Header Format (Strict Source and Record 
Route)
RFC 1812 s5.2.4.1 p72 IP Destination Address
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of <DIface-0>
        - IP Options, containing:
          - Two Strict Source and Record Route options, 
            each containing:
            - length field set to 7
            - pointer field set to 4
            - route data, containing:
              - address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Discard the ICMP Echo Request and do not forward
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - Two Strict Source and Record Route options,
    each containing:
    - length field set to 7
    - pointer field set to 4
    - route data, containing:
      - address of host-2 (40.1.1.150)

Waiting (up to 30.000 seconds) for No ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 9 (36 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xE2BB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x89 (Strict Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x89 (Strict Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE511 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0025 (37)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Did not receive forwarded ICMP Echo Request on <DIface-1>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.20: Passed

>> IP-5.21
TEST_DESCRIPTION
Strict Source and Record Route option appears at most once in a
datagram. If it receives such a datagram it replies with an ICMP 
Parameter Problem message whose pointer points at the beginning 
of the second source route option.
TEST_REFERENCE
NEGATIVE
RFC 791 s3.1 p20 Internet Header Format (Strict Source and Record
Route option)
RFC 1812 s5.2.4.1 p72 IP Destination Address
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of <DIface-0>
        - IP Options, containing:
          - two Strict Source and Record Route options, 
            each containing:
            - length field set to 7
            - pointer field set to 4
            - route data, containing:
              - address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Parameter Problem Message
- ANVL: Verify that the received ICMP Parameter Problem Message
        contains:
        - Pointer field set to 27 (Basic IP Header length (20) +
                                   One Strict Source and Record 
                                   Route option length(7))
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - Two Strict Source and Record Route options,
    each containing:
    - length field set to 7
    - pointer field set to 4
    - route data, containing:
      - address of host-2 (40.1.1.150)

Waiting (up to 30.000 seconds) for ICMP Parameter Problem Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 9 (36 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xE2BB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x89 (Strict Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x89 (Strict Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE510 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0026 (38)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 116 bytes
IP: Identification         = 0x5BC4 (23492)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xB9FB (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x89 (Strict Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 30.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 12 (Parameter Problem)
ICMP: Code             = 0 (Pointer Indicates the Error)
ICMP: Checksum         = 0xD8FF (Correct)
ICMP:
ICMP: ---- ICMP Parameter Problem Data ----
ICMP:
ICMP: Pointer          = 27
ICMP: Unused           = 0x000000
ICMP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 9 (36 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xE2BB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x89 (Strict Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x89 (Strict Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE510 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0026 (38)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Parameter Problem Message on <DIface-0>

Pointer field of ICMP Parameter Problem Message is correctly
set to 27

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.21: Passed

>> IP-5.22
TEST_DESCRIPTION
If record route option is present in a datagram, internet module
inserts its own internet address as known in the environment into
which this datagram is being forwarded into the recorded route
beginning at the octet indicated by the pointer, and increments
the pointer by four.
TEST_REFERENCE
RFC 791 s3.1 p21 Internet Header Format (Record Route option)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Options, containing:
          - One Record Route option, containing:
            - length field set to 7
            - pointer field set to 4
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward ICMP Echo Request
- ANVL: Verify that the received ICMP Echo Request contains:
        - IP Record Route option, containing:
          - route data field set to address of <DIface-1>
          - pointer field set to 8
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Record Route option,
    containing:
    - length field set to 7
    - pointer field set to 4

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2481 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x07 (Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 0.0.0.0
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE50F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0027 (39)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1B58 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x07 (Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 40.1.1.5
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE50F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0027 (39)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

ICMP Echo Request correctly contains IP Record Route Option

Route data field of IP Record Route Option is correctly set
to 40.1.1.5

Pointer field of IP Record Route Option is correctly set to 8

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.22: Passed

>> IP-5.23
TEST_DESCRIPTION
If the route data area is already full (the pointer exceeds the
length) the datagram is forwarded without inserting the address
into the recorded route.
TEST_REFERENCE
RFC 791 s3.1 p21 Internet Header Format (Record Route option)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Options, containing:
          - One Record Route option, containing:
            - length field set to 7
            - pointer field set to 8
            - route data field set to address of host-1 
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward ICMP Echo Request
- ANVL: Verify that the received ICMP Echo Request contains:
        - IP Record Route option, containing:
          - route data field set to address of host-1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Options, containing:
  - One Record Route option, containing:
    - length field set to 7
    - pointer field set to 8
    - route data, containing:
      - address of host-1 (30.1.1.150)

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x8961 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x07 (Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 30.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE50E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0028 (40)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x8A61 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x07 (Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 30.1.1.150
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE50E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0028 (40)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

ICMP Echo Request correctly contains IP Record Route Option

Route data field of IP Record Route Option is correctly set
to 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.23: Passed

>> IP-5.24
TEST_DESCRIPTION
If there is some room but not enough room for a full address to
be inserted, the original datagram is considered to be in error
and is discarded.
TEST_REFERENCE
RFC 791 s3.1 p21 Internet Header Format (Record Route option)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Options, containing:
          - One Record Route option, containing:
            - length field set to 5
            - pointer field set to 4
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Discard the ICMP Echo Request and do not forward
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Options, containing:
  - One Record Route option, containing:
    - length field set to 5
    - pointer field set to 4

Waiting (up to 30.000 seconds) for No ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2483 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x07 (Record Route)
IP OPT: Length             = 5
IP OPT: Pointer            = 4
IP OPT: Route Data         = 
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [2 bytes] ---
IP:  00 00                                             ..
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE50D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0029 (41)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Did not receive forwarded ICMP Echo Request on <DIface-1>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.24: Passed

>> IP-5.27
TEST_DESCRIPTION
Record Route option is not copied on fragmentation, goes in first
fragment only.
TEST_REFERENCE
RFC 791 s3.1 p21 Internet Header Format (Record Route option)
TEST_METHOD
 SETUP: Configure DUT to set MTU on <DIface-0> to <HighMTU>
 SETUP: Configure DUT to set MTU on <DIface-1> to <LowMTU>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Total Length field set to greater than <LowMTU>
        - IP Options, containing:
          - One Record Route option, containing:
            - length field set to 7
            - pointer field set to 4
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward two fragmented packets
- ANVL: Verify that the received:
        - first fragmented packet contains:
          - IP Record Route option, containing:
            - route data field set to address of <DIface-1>
        - second fragmented packet contains:
          - no IP Record Route option
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Causing DUT to set MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to set MTU to 100 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 100

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 100 up
-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Total Length field set to 110 (greater than <LowMTU> 100)
- IP Options, containing:
  - One Record Route option,
    containing:
    - length field set to 7
    - pointer field set to 4

Waiting (up to 30.000 seconds) for ICMP Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 110 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x245B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x07 (Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 0.0.0.0
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7D5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002A (42)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [74 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF                     ..........
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 100 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xFB3B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x07 (Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 8
IP OPT: Route Data         = 40.1.1.5
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7D5 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002A (42)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [64 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 30 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0009 (72 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x32A9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet (continuation [10 bytes]) ----
ICMP:
ICMP: --- Data [10 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF                     ..........
ICMP: --- Data End ---
ETHER: --- Padding [16 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER: --- Padding End ---


Received expected forwarded two IP fragments on <DIface-1>

First fragment correctly contains IP Record Route Option

Route data field of IP Record Route Option of first
fragment is correctly set to 40.1.1.5

Second fragment correctly does not contain IP Record Route Option

Causing DUT to Reset MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to Reset MTU to 1500 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.27: Passed

>> IP-5.28
TEST_DESCRIPTION
Record Route option appears at most once in a datagram.
TEST_REFERENCE
RFC 791 s3.1 p21 Internet Header Format (Record Route option)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Options, containing:
          - two Record Route options, each containing:
            - length field set to 7
            - pointer field set to 4
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Parameter Problem Message
- ANVL: Verify that the received ICMP Parameter Problem Message
        contains:
        - Pointer field set to 27 (Basic IP Header length (20) +
                                   one Record Route option length (7))
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Options, containing:
  - Two Record Route options, each containing:
    - length field set to 7
    - pointer field set to 4

Waiting (up to 30.000 seconds) for ICMP Parameter Problem Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 9 (36 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1B6E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x07 (Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 0.0.0.0
IP OPT:
IP OPT: Type               = 0x07 (Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 0.0.0.0
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE50B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002B (43)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 108 bytes
IP: Identification         = 0x8CCA (36042)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xAF24 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 12 (Parameter Problem)
ICMP: Code             = 0 (Pointer Indicates the Error)
ICMP: Checksum         = 0xD8FF (Correct)
ICMP:
ICMP: ---- ICMP Parameter Problem Data ----
ICMP:
ICMP: Pointer          = 27
ICMP: Unused           = 0x000000
ICMP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 9 (36 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1B6E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x07 (Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 0.0.0.0
IP OPT:
IP OPT: Type               = 0x07 (Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 0.0.0.0
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE50B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002B (43)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Parameter Problem Message on <DIface-0>

Pointer field of ICMP Parameter Problem Message is correctly
set to 27

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.28: Passed

>> IP-5.29
TEST_DESCRIPTION
Stream Identifier MUST be ignored in datagrams received by the 
router.
TEST_REFERENCE
RFC 791 s3.1 p21 Internet Header Format (Stream Identifier)
RFC 1812 s4.2.2.1 p40 Options: RFC 791 Section 3.2((b) Stream
Identifier Option)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Options, containing:
          - Two Stream Identifier Options
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward ICMP Echo Request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Options, containing:
   - Two Stream Identifier Options

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1F7F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x88 (Stream identifier)
IP OPT: Length             = 4
IP OPT: Stream ID          = 0
IP OPT:
IP OPT: Type               = 0x88 (Stream identifier)
IP OPT: Length             = 4
IP OPT: Stream ID          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE50A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002C (44)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x207F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x88 (Stream identifier)
IP OPT: Length             = 4
IP OPT: Stream ID          = 0
IP OPT:
IP OPT: Type               = 0x88 (Stream identifier)
IP OPT: Length             = 4
IP OPT: Stream ID          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE50A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002C (44)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-5.29: Passed

>> IP-6.1
TEST_DESCRIPTION
The Overflow (oflw) [4 bits] is the number of IP modules that
cannot register timestamps due to lack of space.
TEST_REFERENCE
RFC 791 s3.1 p22 Internet Header Format (Internet Timestamp)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 8
            - pointer field set to 9 (one timestamp sent by ANVL)
            - oflw field set to zero
            - flg field set to zero
            - one timestamp value
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that received ICMP Echo Reply contains:
        - IP Internet Timestamp option, containing:
           - oflw field set to 1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Internet Timestamp option, containing:
  - length field set to 8
  - pointer field set to 9 (one timestamp sent by ANVL)
  - oflw field set to zero
  - flg field set to zero
  - one timestamp value

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x8700 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 8
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45179743
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE509 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002D (45)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x2177 (8567)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x6579 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 8
IP OPT: Pointer            = 9
IP OPT: Overflow           = 1
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45179743
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED09 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002D (45)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

ICMP Echo Request correctly contains IP Timestamp option

Oflw field of IP Internet Timestamp option is correctly
set to 1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-6.1: Passed

>> IP-6.2
TEST_DESCRIPTION
0 -- time stamps only, stored in consecutive 32-bit words.
TEST_REFERENCE
RFC 791 s3.1 p22 Internet Header Format (Internet Timestamp)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 12
            - pointer field set to 9 (one timestamp)
            - flg field set to zero
            - one timestamp
            - octets 8-11 set to zero
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that received ICMP Echo Reply contains:
        - IP Internet Timestamp option, containing:
          - octets 8-11 set to timestamp value (non-zero)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Internet Timestamp option, containing:
  - length field set to 12
  - pointer field set to 9 (one timestamp sent by ANVL)
  - flg field set to zero
  - one timestamp value
  - octets 8-11 set to zero

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x726D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45184746
IP OPT: TimeStamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE508 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002E (46)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0x2178 (8568)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x69E7 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 13
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45184746
IP OPT: TimeStamp          = 2149868265
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED08 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002E (46)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

ICMP Echo Reply correctly contains IP Timestamp Option

Octets 8-11 of IP Internet Timestamp option is correctly
set to timestamp 2149868265 (non zero)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-6.2: Passed

>> IP-6.3
TEST_DESCRIPTION
1 -- each timestamp is preceded with internet address of the
     registering entity.
TEST_REFERENCE
RFC 791 s3.1 p22 Internet Header Format (Internet Timestamp)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 20 
            - pointer field set to 13 (one timestamp and one 
                                       internet address)
            - flg field set to 1
            - one internet address set to address of host-1
            - one timestamp
            - octets 12-19 set to zero
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that received ICMP Echo Reply contains:
        - IP Internet Timestamp option, containing:
          - octets 12-15 set to address of DUT
          - octets 16-19 set to timestamp value (non-zero)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Internet Timestamp option, containing:
  - length field set to 20
  - pointer field set to 13 (one timestamp and one internet address)
  - flg field set to 1
  - one internet address set to address of host-1 (30.1.1.150)
  - one timestamp value
  - octets 12-19 set to zero

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 10 (40 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x393A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 20
IP OPT: Pointer            = 13
IP OPT: Overflow           = 0
IP OPT: Flag               = 1 (Time stamps and Addresses)
IP OPT: Address            = 30.1.1.150
IP OPT: Timestamp          = 45189749
IP OPT: Address            = 0.0.0.0
IP OPT: Timestamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE507 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002F (47)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 10 (40 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x2179 (8569)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xFA13 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 20
IP OPT: Pointer            = 21
IP OPT: Overflow           = 0
IP OPT: Flag               = 1 (Time stamps and Addresses)
IP OPT: Address            = 30.1.1.150
IP OPT: Timestamp          = 45189749
IP OPT: Address            = 30.1.1.5
IP OPT: Timestamp          = 2149873282
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED07 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002F (47)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

ICMP Echo Request correctly contains IP Timestamp option

Octets 12-15 of IP Internet Timestamp option is correctly
set to 30.1.1.5 (address of DUT)

Octets 16-19 of IP Internet Timestamp option is correctly
set to timestamp 2149873282 (non zero)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-6.3: Passed

>> IP-6.4
TEST_DESCRIPTION
3 -- the internet address fields are prespecified.  An IP module
     only registers its timestamp if it matches its own address
     with the next specified internet address.
TEST_REFERENCE
RFC 791 s3.1 p22 Internet Header Format (Internet Timestamp)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 12
            - pointer field set to 5
            - flg field set to 3
            - one internet address set to address of DUT
            - octets 4-7 set to zero
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that received ICMP Echo Reply contains:
        - IP Internet Timestamp option, containing:
          - octets 4-7 set to timestamp value (non-zero)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Internet Timestamp option, containing:
  - length field set to 12
  - pointer field set to 5
  - flg field set to 3
  - one internet address set to address of DUT (30.1.1.5)
  - octets 4-7 set to zero

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xD0FF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 5
IP OPT: Overflow           = 0
IP OPT: Flag               = 3 (Timestamp prespecified hops)
IP OPT: Address            = 30.1.1.5
IP OPT: Timestamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE506 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0030 (48)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0x217A (8570)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x9D56 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 13
IP OPT: Overflow           = 0
IP OPT: Flag               = 3 (Timestamp prespecified hops)
IP OPT: Address            = 30.1.1.5
IP OPT: Timestamp          = 2149878282
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED06 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0030 (48)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

ICMP Echo Request correctly contains IP Timestamp option

Octets 4-7 of IP Internet Timestamp option is correctly
set to timestamp value 2149878282 (non zero)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-6.4: Passed

>> IP-6.5
TEST_DESCRIPTION
3 -- the internet address fields are prespecified.  An IP module
     only registers its timestamp if it matches its own address
     with the next specified internet address.
TEST_REFERENCE
NEGATIVE
RFC 791 s3.1 p22 Internet Header Format (Internet Timestamp)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 12
            - pointer field set to 5
            - flg field set to 3
            - one internet address set to different address 
              of DUT
            - octets 4-7 set to zero
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that received ICMP Echo Reply contains:
        - IP Internet Timestamp option, containing:
          - octets 4-7 set to zero (DUT did not register 
            its timestamp)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Internet Timestamp option, containing:
  - length field set to 12
  - pointer field set to 5
  - flg field set to 3
  - one internet address set to 30.1.1.160
    (different from address of DUT (30.1.1.150))
  - octets 4-7 set to zero

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xD064 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 5
IP OPT: Overflow           = 0
IP OPT: Flag               = 3 (Timestamp prespecified hops)
IP OPT: Address            = 30.1.1.160
IP OPT: Timestamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE505 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0031 (49)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0x217B (8571)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xAEE9 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 5
IP OPT: Overflow           = 0
IP OPT: Flag               = 3 (Timestamp prespecified hops)
IP OPT: Address            = 30.1.1.160
IP OPT: Timestamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED05 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0031 (49)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

ICMP Echo Request correctly contains IP Timestamp option

Octets 4-7 of IP Internet Timestamp option is correctly
set to zero (DUT did not register its timestamp)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-6.5: Passed

>> IP-6.6
TEST_DESCRIPTION
If the timestamp data area is already full (the pointer exceeds
the length) the datagram is forwarded without inserting the
timestamp, but the overflow count is incremented by one.
TEST_REFERENCE
RFC 791 s3.1 p23 Internet Header Format (Internet Timestamp)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 8
            - pointer field set to 9 (one timestamp sent by ANVL)
            - oflw field set to zero
            - flg field set to zero
            - one timestamp value
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward ICMP Echo Request
- ANVL: Verify that the received ICMP Echo Request contains:
        - IP Internet Timestamp option, containing:
          - octets 4-7 set to same value as sent with ICMP
            Echo Request
          - oflw field set to 1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Options, containing:
  - One Internet Timestamp option, containing:
  - length field set to 8
  - pointer field set to 9 (one timestamp sent by ANVL)
  - oflw field set to zero
  - flg field set to zero
  - one timestamp value

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1AB5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 8
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45204761
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE504 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0032 (50)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1BA5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 8
IP OPT: Pointer            = 9
IP OPT: Overflow           = 1
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45204761
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE504 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0032 (50)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

ICMP Echo Request correctly contains IP Timestamp option

Octets 4-7 of IP Internet Timestamp option is correctly
set to 45204761 (set by ANVL)

Oflw field of IP Internet Timestamp option is correctly
set to 1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-6.6: Passed

>> IP-6.7
TEST_DESCRIPTION
If there is some room but not enough room for a full timestamp
to be inserted the original datagram is considered to be in error
and is discarded.
TEST_REFERENCE
RFC 791 s3.1 p23 Internet Header Format (Internet Timestamp)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 12
            - pointer field set to 11 
            - flg field set to zero
            - one timestamp value
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Discard ICMP Echo Request and do not send ICMP Echo 
        Reply
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Internet Timestamp option, containing:
  - length field set to 12
  - pointer field set to 11
  - flg field set to zero
  - one timestamp value

Waiting (up to 30.000 seconds) for No ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0EB2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 11
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45209765
IP OPT: TimeStamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE503 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0033 (51)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Ignoring unexpected ICMP Parameter Problem from 30.1.1.5 to 30.1.1.150

Did not receive ICMP Echo Reply on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-6.7: Passed

>> IP-6.8
TEST_DESCRIPTION
If the overflow count itself overflows, the original datagram is
considered to be in error and is discarded.
TEST_REFERENCE
RFC 791 s3.1 p23 Internet Header Format (Internet Timestamp)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 8
            - pointer field set to 9 (one timestamp sent by ANVL)
            - oflw field set to 15 (oflw is a 4 bits field)
            - flg field set to zero
            - one timestamp value
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Discard ICMP Echo Request and do not send ICMP Echo 
        Reply
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Internet Timestamp option, containing:
  - length field set to 8
  - pointer field set to 9 (one timestamp send by ANVL)
  - oflw field set to 15 (oflw is a 4 bit field)
  - flg field set to zero
  - one timestamp value

Waiting (up to 30.000 seconds) for No ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x880E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 8
IP OPT: Pointer            = 9
IP OPT: Overflow           = 15
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45244768
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE502 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0034 (52)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Ignoring unexpected ICMP Parameter Problem from 30.1.1.5 to 30.1.1.150

Did not receive ICMP Echo Reply on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-6.8: Passed

>> IP-6.9
TEST_DESCRIPTION
If there is some room but not enough room for a full timestamp
to be inserted, an ICMP parameter problem message may be sent to
the source host.
TEST_REFERENCE
RFC 791 s3.1 p23 Internet Header Format (Internet Timestamp)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 12
            - pointer field set to 11 
            - flg field set to zero
            - one timestamp value
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Parameter Problem Message
- ANVL: Verify that the received ICMP Parameter Problem Message 
        contains:
        - Pointer field set to 22 (Basic IP Header length (20) +
                                   third octet (pointer field) of 
                                   Internet Timestamp option)
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Internet Timestamp option, containing:
  - length field set to 12
  - pointer field set to 11
  - flg field set to zero
  - one timestamp value

Waiting (up to 30.000 seconds) for ICMP Parameter Problem Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xFD3B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 11
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45279770
IP OPT: TimeStamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE501 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0035 (53)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 104 bytes
IP: Identification         = 0x217E (8574)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1A75 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 12 (Parameter Problem)
ICMP: Code             = 0 (Pointer Indicates the Error)
ICMP: Checksum         = 0xDDFF (Correct)
ICMP:
ICMP: ---- ICMP Parameter Problem Data ----
ICMP:
ICMP: Pointer          = 22
ICMP: Unused           = 0x000000
ICMP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xFD3B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 11
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45279770
IP OPT: TimeStamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE501 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0035 (53)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Parameter Problem Message on <DIface-0>

Pointer field of ICMP Parameter Problem Message is correctly
set to 22

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-6.9: Passed

>> IP-6.10
TEST_DESCRIPTION
If the overflow count itself overflows, an ICMP parameter problem
message may be sent to the source host.
TEST_REFERENCE
RFC 791 s3.1 p23 Internet Header Format (Internet Timestamp)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 8
            - pointer field set to 9 (one timestamp sent by ANVL)
            - oflw field set to 15 (oflw is a 4 bits field)
            - flg field set to zero
            - one timestamp value
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Parameter Problem Message
- ANVL: Verify that the received ICMP Parameter Problem Message 
        contains:
        - Pointer field set to 23 (Basic IP Header length (20) +
                                   fourth octet (oflw field))
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Internet Timestamp option, containing:
  - length field set to 8
  - pointer field set to 9 (one timestamp sent by ANVL)
  - oflw field set to 15 (oflw is a 4 bits field)
  - flg field set to zero
  - one timestamp value

Waiting (up to 30.000 seconds) for ICMP Parameter Problem Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xEBC6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 8
IP OPT: Pointer            = 9
IP OPT: Overflow           = 15
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45284775
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE500 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0036 (54)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 100 bytes
IP: Identification         = 0x217F (8575)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1A78 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 12 (Parameter Problem)
ICMP: Code             = 0 (Pointer Indicates the Error)
ICMP: Checksum         = 0xDCFF (Correct)
ICMP:
ICMP: ---- ICMP Parameter Problem Data ----
ICMP:
ICMP: Pointer          = 23
ICMP: Unused           = 0x000000
ICMP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xEBC6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 8
IP OPT: Pointer            = 9
IP OPT: Overflow           = 15
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45284775
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE500 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0036 (54)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Parameter Problem Message on <DIface-0>

Pointer field of ICMP Parameter Problem Message is correctly
set to 23

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-6.10: Passed

>> IP-6.11
TEST_DESCRIPTION
The timestamp option is not copied upon fragmentation.  It is
carried in the first fragment.
TEST_REFERENCE
RFC 791 s3.1 p23 Internet Header Format (Internet Timestamp)
TEST_METHOD
 SETUP: Configure DUT to set MTU on <DIface-0> to <HighMTU>
 SETUP: Configure DUT to set MTU on <DIface-1> to <LowMTU>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Total Length field set to greater than <LowMTU>
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 12
            - pointer field set to 9 (one timestamp sent by ANVL)
            - flg field set to zero
            - one timestamp value
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward two fragmented packets
- ANVL: Verify that the received:
        - first fragment contains:
          - IP Internet Timestamp option
        - second fragment contains:
          - no IP Internet Timestamp option
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Causing DUT to set MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to set MTU to 100 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 100

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 100 up
-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Total Length field set to 110 (greater than <LowMTU> 100)
- IP Options, containing:
  - One Internet Timestamp option, containing:
    - length field set to 12
    - pointer field set to 9 (one timestamp sent by ANVL)
    - flg field set to zero
    - one timestamp value

Waiting (up to 30.000 seconds) for ICMP Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 110 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xC4AB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45292023
IP OPT: TimeStamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7C8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0037 (55)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [70 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF                                 ......
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1B97 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 13
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45292023
IP OPT: TimeStamp          = 2149975548
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7C8 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0037 (55)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [56 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF                           ........
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 34 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0008 (64 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x32A6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet (continuation [14 bytes]) ----
ICMP:
ICMP: --- Data [14 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF         ..............
ICMP: --- Data End ---
ETHER: --- Padding [12 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00               ............
ETHER: --- Padding End ---


Received expected two IP fragments on <DIface-1>

First fragment correctly contains IP Internet Timestamp Option

Second fragment correctly does not contain IP Internet
Timestamp Option

Causing DUT to Reset MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to Reset MTU to 1500 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-6.11: Passed

>> IP-6.12
TEST_DESCRIPTION
The timestamp option appears at most once in a datagram.
TEST_REFERENCE
RFC 791 s3.1 p23 Internet Header Format (Internet Timestamp)
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - Two Internet Timestamp options, each containing:
            - length field set to 12
            - pointer field set to 9 
            - flg field set to zero
            - one timestamp value
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Parameter Problem Message
- ANVL: Verify that the received ICMP Parameter Problem Message 
        contains:
        - Pointer field set to 32 (Basic IP Header length (20) +
                                   one internet Timestamp option
                                   length (12))
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - Two Internet Timestamp options, each containing:
    - length field set to 12
    - pointer field set to 9
    - flg field set to zero
    - one timestamp value

Waiting (up to 30.000 seconds) for ICMP Parameter Problem Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 11 (44 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2A12 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45299260
IP OPT: TimeStamp          = 0
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45299260
IP OPT: TimeStamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE4FE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0038 (56)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 116 bytes
IP: Identification         = 0xCE21 (52769)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x6DC5 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 12 (Parameter Problem)
ICMP: Code             = 0 (Pointer Indicates the Error)
ICMP: Checksum         = 0xD3FF (Correct)
ICMP:
ICMP: ---- ICMP Parameter Problem Data ----
ICMP:
ICMP: Pointer          = 32
ICMP: Unused           = 0x000000
ICMP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 11 (44 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2A12 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45299260
IP OPT: TimeStamp          = 0
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 45299260
IP OPT: TimeStamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE4FE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0038 (56)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Parameter Problem Message on <DIface-0>

Pointer field of ICMP Parameter Problem Message is correctly
set to 32

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-6.12: Passed

>> IP-6.13
TEST_DESCRIPTION
A router MUST ignore IP options which it does not recognize.
TEST_REFERENCE
RFC 1812 s4.2.2.6 p44 Unrecognized Header Options: RFC 791 
Section 3.1
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Options, containing:
          - One option, containing:
            - Type field set to <unrecognizedOptionType>
            - length field set to 4
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Ignore the unrecognized option and forward ICMP Echo 
        Request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Options, containing:
  - One option, containing:
    - Type field set to 32 (<unrecognizedOptionType>)
    - length field set to 4

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1088 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP Unknown Option: --- Data [4 bytes] ---
IP Unknown Option:  20 04 00 00                                        ...
IP Unknown Option: --- Data End ---
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE4FD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0039 (57)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1188 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP: ---- Options ----
IP OPT:
IP Unknown Option: --- Data [4 bytes] ---
IP Unknown Option:  20 04 00 00                                        ...
IP Unknown Option: --- Data End ---
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE4FD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0039 (57)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-6.13: Passed

>> IP-7.1
TEST_DESCRIPTION
The fragmentation strategy is designed so than an unfragmented
datagram has all zero fragmentation information (MF = 0, fragment
offset = 0).
TEST_REFERENCE
RFC 791 s3.2 p25 Discussion
TEST_METHOD
- ANVL: Cause DUT to send an ICMP Echo Request through <DIface-0>,
        containing:
        - IP Destination Address set to address of host-1
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Request
- ANVL: Verify that the received packet contains:
        - IP Flags field, containing:
          - MF bit set to zero
        - IP Fragment Offset field set to zero
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Causing DUT to send 1 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 30.1.1.150
ICMP Echo Data size 16
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 0 1 16

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IP/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 30.1.1.0
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x26FB (9979)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x152E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x4F46 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x3033 (12339)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [28 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B               0123456789:;
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Request from DUT

MF bit of IP Flags field of ICMP Echo Request is correctly
set to zero

IP Fragment offset field of ICMP Echo Request is correctly
set to zero
cmd ping -c 1 -s 36 30.1.1.150

Pinging 30.1.1.150 (30.1.1.150) with 36 bytes of data:

--- 30.1.1.150 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 1016 ms
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-7.1: Passed

>> IP-7.2
TEST_DESCRIPTION
Every internet module must be able to forward a datagram of 68
octets without further fragmentation.
TEST_REFERENCE
RFC 791 s3.2 p25 Discussion
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Total Length field set to 68 octets
        - IP Flags field, containing:
          - DF bit set to zero
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward ICMP Echo Request
- ANVL: Verify that the received ICMP Echo Request contains:
        - IP Flags field, containing:
          - MF bit set to zero
        - IP Fragment Offset field set to zero
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Total Length field set to 68 octets
- IP Flags field, containing:
  - DF bit set to zero

Waiting (up to 30.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x318C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7C5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003A (58)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [40 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF                           ........
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x328C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7C5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003A (58)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [40 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF                           ........
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

MF bit of IP Flags field of ICMP Echo Request is correctly set to zero

IP Fragment Offset field of ICMP Echo Request is correctly set to zero

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-7.2: Passed

>> IP-7.5
TEST_DESCRIPTION
The initial setting of the timer is a lower bound on the reassembly 
waiting time. The waiting time will not be decreased if it is less 
the Time to Live in the arriving fragment.
TEST_REFERENCE
RFC 791 s3.2 p27 Discussion (An Example Reassembly Procedure)
TEST_METHOD
- ANVL: Construct an ICMP Echo Request. Send an IP packet to 
        <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Fragment Offset field set to zero
        - Flags field, containing:
          - MF bit set to 1
        - TTL field set to <LowTTLValue>
        - first half of the constructed ICMP packet which is 
          multiple of 8-octets
- ANVL: Wait for <LowTTLValue> seconds
- ANVL: Send an IP packet to <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Fragment Offset field set to data size sent in first IP 
          packet in unit of 8-octets
        - Flags field, containing:
          - MF bit set to zero
        - TTL field set to <LowTTLValue>
        - last half of the constructed ICMP packet
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
- ANVL: Verify that Identifier, Sequence Number and Data of ICMP
        Echo Reply are same as those of ICMP Echo Request sent in two
        fragments.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- Fragment Offset field set to zero
- Flags field, containing:
  - MF bit set to 1
- TTL field set to 5 (<LowTTLValue>)
- first half of the constructed ICMP packet whose size
  is multiple of 8-octets (24 octets)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 5
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x5735 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE4FB 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003B (59)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 5.000 seconds) 

Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- Fragment Offset field set to data size sent in first IP
  packet in unit of 8-octets (24)
- Flags field, containing:
  - MF bit set to 0
- TTL field set to 5 (<LowTTLValue>)
- last half of the constructed ICMP packet (20 octets)

Waiting (up to 30.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0003 (24 bytes)
IP: Time to Live           = 5
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7736 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet (continuation [20 bytes]) ----
ICMP:
ICMP: --- Data [20 bytes] ---
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0xCE22 (52770)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x6DFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xECFB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003B (59)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

Identifier field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 59

Sequence Number field of ICMP Echo Request sent and ICMP
Echo Reply received are correctly set to 0

Data of ICMP Echo Request sent and ICMP Echo Reply received
are correctly set to
41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
72 61 72 79                                       rary

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IP-7.5: Passed
Executing system command:
  "./DocScriptQ35/IP/IPpostsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet.AcceptSourceRoute "0"
sysvar: ipnet.inet.AcceptSourceRoute=0 ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          60
Number of tests passed:       60
Number of tests failed:       0
Number of tests inconclusive: 0
