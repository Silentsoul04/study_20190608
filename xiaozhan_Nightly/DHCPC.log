ANVL version 8.80.1.28 (Linux). Copyright (c) (2019) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197416 kB RAM. Free Memory 6739732 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvldhcpclient dhcp-client 1-6.2 6.4-6.6 6.8-13.6 13.9 13.11-16.5 16.7-16.8 16.10 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvldhcpclient.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           "./DocScriptQ35/IP/reboot-command.exp $ANVL_DUTHOSTNAME"
Post suite Command                       "./DocScriptQ35/DHCP-CLIENT/DHCPCpostsuite.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
IP DUT Background Echo Request Send Command "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
DHCP Client Suite Setup Command          "./DocScriptQ35/DHCP-CLIENT/dhcp-client-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Configure Command            "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Reset Command                "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Renew Command                "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Release Command              "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Option Configure Command     "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Boot Command                 "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Reboot Command               "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reboot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client DHCPINFORM Message Send Command "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Restart Log Check Command    "./DocScriptQ35/DHCP-CLIENT/dhcp-client-restart-log-check-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Static IP Assign Command     "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Supports Sending DHCPINFORM  True
DHCP Client Supports Lease Renewal       True
DHCP Listen Time                         10                  # (0x0000000A)
DHCP Lease Time                          80                  # (0x00000050)
DHCP Tolerance Time                      20                  # (0x00000014)
DHCP Tolerance Factor                    1                   # (0x00000001)
DHCP Process Time                        2                   # (0x00000002)
DHCP First Retransmission Interval       4                   # (0x00000004)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvldhcpclient.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        
IP First Unused Net                      50.0.0.0
IP Number Unused Nets                    100                 # (0x00000064)
IP Unused Net Mask                       255.0.0.0

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29

# Configuration File End.

WARNING: It is recommended that the value of lease time should
WARNING: kept higher than 5 seconds since in various cases,
WARNING: verification of T1 and T2 (Ref: rfc2131) is done which
WARNING: are fractions of 'DHCP Lease Time'. Keeping it too low
WARNING: may cause the T1 and T2 to become too low for proper
WARNING: verifications.
WARNING: Too high values are also deprreciated since it will
WARNING: lead to unnecessary long running of tests which
WARNING: may not add any value to the test results.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.rfc2131_init_delay "1"
sysvar: ipdhcpc.rfc2131_init_delay=1 ok
-> cmd sysvar get ipdhcpc.rfc2131_init_delay
sysvar: ipdhcpc.rfc2131_init_delay=1
-> cmd sysvar set -c -o ipdhcpc.option.lease_time "60"
sysvar: ipdhcpc.option.lease_time=60 ok
-> cmd sysvar get ipdhcpc.option.lease_time 
sysvar: ipdhcpc.option.lease_time=60
-> cmd sysvar set -c -o ipdhcpc.option.requested_options "1,6,28,42"
sysvar: ipdhcpc.option.requested_options=1,6,28,42 ok
-> cmd sysvar get ipdhcpc.option.requested_options
sysvar: ipdhcpc.option.requested_options=1,6,28,42
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd ipd kill ipdhcpc
ipd: kill ipdhcpc ok
-> cmd ipd start ipdhcpc
ipd: start ipdhcpc ok
-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 up
-> exit
Au revoir!
Connection closed by foreign host.

Starting Active Validation for DHCP Client for
all 2 DUT interface(s)

  DHCP Client topology # 2
  ---------------------------------------

  +----------------+                          +----------------+
  |                |<AIface-0>      <DIface-0>|                |
  |             N0 +--------------------------+ N0             |
  |                |                          |                |
  |             N1 +--------------------------+ N1             |
  | <SERVER-1>     |<AIface-1>      <DIface-1>|           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  tentative  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:1 mcast:1 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:90

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2336  lo0    0    
128.224.166.0/23                vxTarget                      UC       2192  gei2   0    
vxTarget                        vxTarget                      UH       7357  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       266643lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: ipnet.inet.AddressConflictDetect=1 ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1
gei1	Link type:Ethernet  HWaddr 00:15:17:c8:90:29
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9029%gei1  prefixlen 64  tentative  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1300  metric:1  VR:0  ifindex:24
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:1 mcast:1 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:90

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2336  lo0    0    
128.224.166.0/23                vxTarget                      UC       2192  gei2   0    
vxTarget                        vxTarget                      UH       7357  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       266643lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Causing the DUT DHCP Client to transit its state to SELECTING state
through <DIface-0>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> FF:FF:FF:FF:FF:FF < 00:15:17:C8:90:28 IP 255.255.255.255 < 0.0.0.0 UDP dhcp server<-dhcp client DHCP DHCPDISCOVER Message


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e00:15:17:C8:90:28 < 00:1B:21:7D:57:BA IP 50.0.0.2 < 50.0.0.1 UDP dhcp client<-dhcp server DHCP DHCPOFFER Message


Booting up DHCP client on the DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Causing the DUT DHCP Client to transit its state to SELECTING
state through <DIface-1>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-1>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei1 -dhcp
-> cmd ifconfig gei1 dhcp
-> FF:FF:FF:FF:FF:FF < 00:15:17:C8:90:29 IP 255.255.255.255 < 0.0.0.0 UDP dhcp server<-dhcp client DHCP DHCPDISCOVER Message


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e00:15:17:C8:90:29 < 00:1B:21:7D:57:BB IP 51.0.0.2 < 51.0.0.1 UDP dhcp client<-dhcp server DHCP DHCPOFFER Message


Active validation of DHCP Client was completed successfully
for all the interfaces provided in the configuration file
Continuing with tests .....

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei1 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

This test suite tests statements from:
ANVL Test Suite DHCP Client
RFC 2131:  'Dynamic Host Configuration Protocol'
R. Droms, Bucknell University, March 1997

ANVL Test Suite Required Setup:
This suite expects to be running against a node which has at least one
interface for which it can obtain IPv4 address dynamically using DHCP
(A DHCP Client implementation is expected to be present in the DUT
which will actually obtain the IP address using DHCP


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> DHCP-CLIENT-1.1
TEST_DESCRIPTION
A DHCP Client Listens on UDP port 68
TEST_REFERENCE
Setup Verification
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:1 mcast:0 errors:0 dropped:1
	TX packets:9 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:322  TX bytes:1806

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2344  lo0    0    
128.224.166.0/23                vxTarget                      UC       2197  gei2   0    
vxTarget                        vxTarget                      UH       7500  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       273476lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x655A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3720654071 (0xDDC4ACF7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0003 (3)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DB4 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x5911 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3720654071 (0xDDC4ACF7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8F3A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3720654071 (0xDDC4ACF7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-1.1: Passed

>> DHCP-CLIENT-2.1
TEST_DESCRIPTION
A DHCP client must be prepared to receive multiple responses
to a request for configuration parameters
(Note: If the 'xid' of an arriving DHCPOFFER message does not match the
'xid' of the most recent DHCPDISCOVER message, the DHCPOFFER message
must be silently discarded.)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 1.6 Page 7 'Design Goals'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'xid' field to <extractedXID>
- ANVL: DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT
        through <DIface-0> containing :
        - 'xid' field set to (extractedXID+1)
- ANVL:DHCP Server <SERVER-2> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - 'xid' field set to extractedXID
- ANVL:DHCP Server <SERVER-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 54 (Server Identifier Option)
          - Length field set to 4
          - Value set to <SERVER2-IP-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


  DHCP Client topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <SERVER-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <SERVER-2>     |
  +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:2 mcast:0 errors:0 dropped:2
	TX packets:12 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:644  TX bytes:2832

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2352  lo0    0    
128.224.166.0/23                vxTarget                      UC       2199  gei2   0    
vxTarget                        vxTarget                      UH       7573  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       276622lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC762 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 515770870 (0x1EBE09F6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'xid' field (0x1EBE09F6) to <extractedXID>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'xid' field set to (extractedXID+1) (0x1EBE09F7) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0004 (4)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DB2 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.3
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xBB16 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 515770871 (0x1EBE09F7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-2> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'xid' field set to extractedXID (0x1EBE09F6) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 02:02:00:00:00:04
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0005 (5)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAC (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.7
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xBA0E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 515770870 (0x1EBE09F6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.7
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF13C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 515770870 (0x1EBE09F6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.7
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-2> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Server Identifier (54) Length : 4 Value : 54.0.0.2 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-2.1: Passed

>> DHCP-CLIENT-2.2
TEST_DESCRIPTION
A DHCP client must be prepared to receive DHCP messages with an
 'options'
field of at least length 312 octets.  This requirement implies that a
 DHCP
client must be prepared to receive a message of up to 576 octets
TEST_REFERENCE
RFC 2131 Section 2 Page 10 'Protocol Summary'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:4 mcast:0 errors:0 dropped:4
	TX packets:15 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1288  TX bytes:3858

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2360  lo0    0    
128.224.166.0/23                vxTarget                      UC       2202  gei2   0    
vxTarget                        vxTarget                      UH       7644  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       278790lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x27D2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2700748618 (0xA0FA274A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>
e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576 (576) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0006 (6)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0CA5 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x1971 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2700748618 (0xA0FA274A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x51B2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2700748618 (0xA0FA274A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-2.2: Passed

>> DHCP-CLIENT-2.3
TEST_DESCRIPTION
The remaining bits of the flags field are reserved for future use.  
They MUST be set to zero by clients and ignored by servers and relay
 agents
TEST_REFERENCE
RFC 2131 Section 2 Page 11 'Protocol Summary'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Bits 2 to 16 of 'flags' field  is set to  0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:5 mcast:0 errors:0 dropped:5
	TX packets:18 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1878  TX bytes:4884

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2368  lo0    0    
128.224.166.0/23                vxTarget                      UC       2204  gei2   0    
vxTarget                        vxTarget                      UH       7718  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       283538lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB3EB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3534055813 (0xD2A56985)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>
exit

Received DHCPDISCOVER Message correctly contains:
- Bits 2 to 16 of 'flags' field correctly set to 000000000000000

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-2.3: Passed

>> DHCP-CLIENT-4.1
TEST_DESCRIPTION
The first four octets of the 'options' field of the DHCP message
contain the (decimal) values 99, 130, 83 and 99, respectively (this
is the same magic cookie as is defined in RFC 1497)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - First four octets of DHCP Options is set to
           <DHCP-MAGIC-COOKIE>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:5 mcast:0 errors:0 dropped:5
	TX packets:19 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1878  TX bytes:5226

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2376  lo0    0    
128.224.166.0/23                vxTarget                      UC       2206  gei2   0    
vxTarget                        vxTarget                      UH       7790  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       286956lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xDCA3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 32575874 (0x01F11182)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

First four octets of DHCP Options in received DHCPDISCOVER Message is correctly set to 99 130 83 99

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.1: Passed

>> DHCP-CLIENT-4.2
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPDISCOVER Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:5 mcast:0 errors:0 dropped:5
	TX packets:20 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1878  TX bytes:5568

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2384  lo0    0    
128.224.166.0/23                vxTarget                      UC       2207  gei2   0    
vxTarget                        vxTarget                      UH       7850  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       290182lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBC45 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3425855390 (0xCC32679E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>
exit

Message Option in received DHCPDISCOVER Message correctly contains Option Message Type (53) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.2: Passed

>> DHCP-CLIENT-4.3
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPREQUEST Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REQUESTING
-  DUT: Transit finite state to REQUESTING
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:5 mcast:0 errors:0 dropped:5
	TX packets:21 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1878  TX bytes:5910

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2392  lo0    0    
128.224.166.0/23                vxTarget                      UC       2207  gei2   0    
vxTarget                        vxTarget                      UH       7932  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       293980lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x20BC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3713724927 (0xDD5AF1FF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0007 (7)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DB0 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x1473 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3713724927 (0xDD5AF1FF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4A9C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3713724927 (0xDD5AF1FF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to REQUESTING state

Message Option in received DHCPREQUEST Message correctly contains Option Message Type (53) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.3: Passed

>> DHCP-CLIENT-4.4
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPRELEASE Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPRELEASE Message
- ANVL: Verify that received DHCPRELEASE Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:6 mcast:0 errors:0 dropped:6
	TX packets:24 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:2200  TX bytes:6936

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2400  lo0    0    
128.224.166.0/23                vxTarget                      UC       2208  gei2   0    
vxTarget                        vxTarget                      UH       8006  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       297794lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB4F4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4079568888 (0xF32947F8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0008 (8)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAF (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA8AB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4079568888 (0xF32947F8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xDED4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4079568888 (0xF32947F8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0009 (9)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAE (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA5AB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4079568888 (0xF32947F8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPRELEASE Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhcp

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x99A1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4079568888 (0xF32947F8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPRELEASE Message from <DIface-0>

Message Option in received DHCPRELEASE Message correctly contains Option Message Type (53) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
-> e
-> cmd sysvar set -co ipdhcpc.if.gei0.information_onlyxit
Au revoir!
Connection closed by foreign host.
 "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.4: Passed

>> DHCP-CLIENT-4.5
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPDECLINE Message)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ARP Request Message
- ANVL: Verify that received ARP Request Message contains:
        - ARP Target IP Address field is set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Sends ARP Response Message to DUT
       through <DIface-0> containing :
        - ARP Sender MAC Address field set to <MAC-UNUSED-ADDRESS>
        - ARP Sender IP Address field set to
           <SERVER1-IP-POOL-0-0>(*INVALID*)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDECLINE Message
- ANVL: Verify that received DHCPDECLINE Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:8 mcast:0 errors:0 dropped:8
	TX packets:27 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:2844  TX bytes:7962

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2408  lo0    0    
128.224.166.0/23                vxTarget                      UC       2213  gei2   0    
vxTarget                        vxTarget                      UH       8090  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       301642lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x123B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1814131130 (0x6C2171BA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000A (10)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAD (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x05F2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1814131130 (0x6C2171BA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3C1B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1814131130 (0x6C2171BA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000B (11)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAC (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x02F2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1814131130 (0x6C2171BA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 30.000 seconds) for ARP Request Message on <DIface-0>
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 0.0.0.0
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Server <SERVER-1> received expected ARP Request Message from <DIface-0>

ARP Target IP Address field in received ARP Request is correctly set to 54.0.0.2

DHCP Server <SERVER-1> sending ARP Response Message to DUT through <DIface-0> containing :
  - ARP Sender MAC Address field set to     <MAC-UNUSED-ADDRESS> (02:02:00:00:00:03) 
  - ARP Sender IP Address field set to     <SERVER1-IP-POOL-0-0>(*INVALID*) (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 02:02:00:00:00:03
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPDECLINE Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xFDE5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1814131130 (0x6C2171BA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 4 (DHCPDECLINE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDECLINE Message from <DIface-0>

Message Option in received DHCPDECLINE Message correctly contains Option Message Type (53) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.5: Passed

>> DHCP-CLIENT-4.6
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPINFORM Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <SERVER1-IP-POOL-0-0> with mask
        <SERVER1-IP-POOL-NETMASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to send DHCPINFORM Message through
        <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
- ANVL: Verify that received DHCPINFORM Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:11 mcast:0 errors:0 dropped:10
	TX packets:31 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3548  TX bytes:9030

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2416  lo0    0    
128.224.166.0/23                vxTarget                      UC       2220  gei2   0    
vxTarget                        vxTarget                      UH       8167  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       305064lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 54.0.0.2 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to send DHCPINFORM Message through <DIface-0>
to address 54.0.0.1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd sysvar set -co ipdhcpc.server "54.0.0.1" 
sysvar: ipdhcpc.server=54.0.0.1 ok
-> cmd sysvar get ipdhcpc.server
sysvar: ipdhcpc.server=54.0.0.1
-> cmd ipd reconfigure ipdhcpc 
ipd: reconfigure ipdhcpc ok
-> cmd ifconfig gei0 dhcp 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xFB3B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2573343664 (0x99621BB0)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

Message Option in received DHCPINFORM Message correctly contains Option Message Type (53) 

Deleting IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet delete 54.0.0.2 up
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.6: Passed

>> DHCP-CLIENT-5.1
TEST_DESCRIPTION
The client broadcasts a DHCPDISCOVER message on its local physical
 subnet
TEST_REFERENCE
RFC 2131 Section 3.1 Page 13 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Destination IP Address field is set to
           <IP-BROADCAST-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:11 mcast:0 errors:0 dropped:10
	TX packets:34 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3548  TX bytes:9456

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2440  lo0    0    
128.224.166.0/23                vxTarget                      UC       2223  gei2   0    
vxTarget                        vxTarget                      UH       8290  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       310430lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF706 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2776978314 (0xA585538A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Destination IP Address field in received DHCPDISCOVER Message is correctly set to 255.255.255.255

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.1: Passed

>> DHCP-CLIENT-5.2
TEST_DESCRIPTION
The DHCPDISCOVER message MAY include options that suggest values for the
network address and lease duration
(Note: This test checks that DUT may suggest a value for lease time)
TEST_REFERENCE
RFC 2131 Section 3.1 Page 13 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 51 (IP Address Lease Time
        Option)
        with value 60 for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to 60
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:11 mcast:0 errors:0 dropped:10
	TX packets:35 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3548  TX bytes:9798

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2448  lo0    0    
128.224.166.0/23                vxTarget                      UC       2224  gei2   0    
vxTarget                        vxTarget                      UH       8382  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       314656lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option IP Address Lease Time with value
60 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 51 60

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.lease_time "60"
sysvar: ipdhcpc.option.lease_time=60 ok
-> cmd sysvar get ipdhcpc.option.lease_time
sysvar: ipdhcpc.option.lease_time=60
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xCC56 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 221189777 (0x0D2F1691)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Message Option in received DHCPDISCOVER Message correctly contains Option IP Address Lease Time (51) Length : 4 Value : 60 seconds (1 minute ) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.2: Passed

>> DHCP-CLIENT-5.3
TEST_DESCRIPTION
The client broadcasts a DHCPREQUEST message that MUST include the
 'server 
identifier' option to indicate which server it has selected
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 54 (Server Identifier Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:11 mcast:0 errors:0 dropped:10
	TX packets:36 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3548  TX bytes:10140 (10 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2456  lo0    0    
128.224.166.0/23                vxTarget                      UC       2225  gei2   0    
vxTarget                        vxTarget                      UH       8472  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       318700lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE1FD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4169667984 (0xF8881590)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000C (12)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAB (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xD5B4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4169667984 (0xF8881590)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0BDE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4169667984 (0xF8881590)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Server Identifier (54) Length : 4 Value : 54.0.0.1 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.3: Passed

>> DHCP-CLIENT-5.4
TEST_DESCRIPTION
the DHCPREQUEST message MUST use the same value in the DHCP message
header's 'secs' field ... as the original DHCPDISCOVER message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'secs' field to <extractedSeconds>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'secs' field is set to extractedSeconds
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:12 mcast:0 errors:0 dropped:11
	TX packets:39 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3870  TX bytes:11166 (11 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2464  lo0    0    
128.224.166.0/23                vxTarget                      UC       2226  gei2   0    
vxTarget                        vxTarget                      UH       8541  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       321322lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xDA2B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2909628541 (0xAD6D687D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'secs' field (0) to <extractedSeconds>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000D (13)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAA (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xCDE2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2909628541 (0xAD6D687D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x040C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2909628541 (0xAD6D687D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'secs' field in received DHCPREQUEST Message is correctly set to 0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.4: Passed

>> DHCP-CLIENT-5.5
TEST_DESCRIPTION
the DHCPREQUEST message MUST ... be sent to the same IP broadcast
 address
as the original DHCPDISCOVER message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Destination IP Address field is set to
           <IP-BROADCAST-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to
           <IP-BROADCAST-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:13 mcast:0 errors:0 dropped:12
	TX packets:42 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:4192  TX bytes:12192 (12 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2472  lo0    0    
128.224.166.0/23                vxTarget                      UC       2228  gei2   0    
vxTarget                        vxTarget                      UH       8617  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       325840lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE7B0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1052363180 (0x3EB9C9AC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Destination IP Address field in received DHCPDISCOVER Message is correctly set to 255.255.255.255

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000E (14)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA9 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xDB67 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1052363180 (0x3EB9C9AC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1191 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1052363180 (0x3EB9C9AC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 255.255.255.255

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.5: Passed

>> DHCP-CLIENT-5.6
TEST_DESCRIPTION
The client times out and retransmits the DHCPDISCOVER message if
the client receives no DHCPOFFER messages
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:14 mcast:0 errors:0 dropped:13
	TX packets:45 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:4514  TX bytes:13218 (13 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2480  lo0    0    
128.224.166.0/23                vxTarget                      UC       2231  gei2   0    
vxTarget                        vxTarget                      UH       8690  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       329530lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x530C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1646934752 (0x622A3AE0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5308 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1646934752 (0x622A3AE0)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.6: Passed

>> DHCP-CLIENT-5.8
TEST_DESCRIPTION
If the client detects that the address is already in use (e.g., through
the use of ARP), the client MUST send a DHCPDECLINE message to the
 server
and restarts the configuration process
(Note: In this test we check that the DUT does restart the configuration
       process after sending the DHCPDECLINE Message)
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Client <STATIC-CLIENT-1> Listens (upto
       <ParamListenTime>) on <DIface-0>
-  DUT: Sends ARP Request Message
- ANVL: Verify that received ARP Request Message contains:
        - ARP Target IP Address field is set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Client <STATIC-CLIENT-1> Sends ARP Response Message to
       DUT through <DIface-0> containing :
        - ARP Sender MAC Address field set to <MAC-UNUSED-ADDRESS>
        - ARP Target MAC Address field set to <DIface-0-MAC-ADDRESS>
        - ARP Sender IP Address field set to <SERVER1-IP-POOL-0-0>
        - ARP Target IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDECLINE Message
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-4


  DHCP Client topology # 4
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <SERVER-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
  <STATIC-CLIENT-1>             |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  |                |
  +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:14 mcast:0 errors:0 dropped:13
	TX packets:47 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:4514  TX bytes:13902 (13 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2488  lo0    0    
128.224.166.0/23                vxTarget                      UC       2232  gei2   0    
vxTarget                        vxTarget                      UH       8762  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       333180lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB733 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4020390208 (0xEFA24940)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000F (15)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA8 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xAAEA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4020390208 (0xEFA24940)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE113 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4020390208 (0xEFA24940)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0010 (16)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA7 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA7EA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4020390208 (0xEFA24940)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 30.000 seconds) for ARP Request Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 0.0.0.0
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Client <STATIC-CLIENT-1> received expected ARP Request Message from <DIface-0>

ARP Target IP Address field in received ARP Request is correctly set to 54.0.0.2

DHCP Client <STATIC-CLIENT-1> sending ARP Response Message to DUT through <DIface-0> containing :
  - ARP Sender MAC Address field set to     <MAC-UNUSED-ADDRESS> (02:02:00:00:00:03) 
  - ARP Target MAC Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - ARP Sender IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 
  - ARP Target IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:05
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 02:02:00:00:00:03
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA2DE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4020390208 (0xEFA24940)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 4 (DHCPDECLINE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDECLINE Message from <DIface-0>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x07E6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4204916090 (0xFAA1ED7A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.8: Passed

>> DHCP-CLIENT-5.9
TEST_DESCRIPTION
The client SHOULD wait a minimum of ten seconds before restarting
the configuration process to avoid excessive network traffic in case
of looping
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Client <STATIC-CLIENT-1> Listens (upto
       <ParamListenTime>) on <DIface-0>
-  DUT: Sends ARP Request Message
- ANVL: Verify that received ARP Request Message contains:
        - ARP Target IP Address field is set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Client <STATIC-CLIENT-1> Sends ARP Response Message to
       DUT through <DIface-0> containing :
        - ARP Sender MAC Address field set to <MAC-UNUSED-ADDRESS>
        - ARP Target MAC Address field set to <DIface-0-MAC-ADDRESS>
        - ARP Sender IP Address field set to <SERVER1-IP-POOL-0-0>
        - ARP Target IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDECLINE Message
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that the time interval between
        reception of last DHCPDECLINE Message and reception of last
         DHCPDISCOVER Message
         is greater than 
        (10  -  <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-4


  DHCP Client topology # 4
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <SERVER-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
  <STATIC-CLIENT-1>             |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  |                |
  +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:17 mcast:0 errors:0 dropped:15
	TX packets:52 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:5218  TX bytes:15312 (15 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2496  lo0    0    
128.224.166.0/23                vxTarget                      UC       2241  gei2   0    
vxTarget                        vxTarget                      UH       8834  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       336858lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4514 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2827420283 (0xA887027B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0011 (17)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA6 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x38CB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2827420283 (0xA887027B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6EF4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2827420283 (0xA887027B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0012 (18)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA5 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x35CB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2827420283 (0xA887027B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 30.000 seconds) for ARP Request Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 0.0.0.0
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Client <STATIC-CLIENT-1> received expected ARP Request Message from <DIface-0>

ARP Target IP Address field in received ARP Request is correctly set to 54.0.0.2

DHCP Client <STATIC-CLIENT-1> sending ARP Response Message to DUT through <DIface-0> containing :
  - ARP Sender MAC Address field set to     <MAC-UNUSED-ADDRESS> (02:02:00:00:00:03) 
  - ARP Target MAC Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - ARP Sender IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 
  - ARP Target IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:06
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 02:02:00:00:00:03
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x30BF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2827420283 (0xA887027B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 4 (DHCPDECLINE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDECLINE Message from <DIface-0>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xDA26 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2880137776 (0xABAB6A30)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Time interval (10.767 sec) between
reception of last DHCPDECLINE Message and reception of last DHCPDISCOVER Message 
is correctly  is greater than 
(10  -  <ParamToleranceTime>) second (greater than 0.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.9: Passed

>> DHCP-CLIENT-5.10
TEST_DESCRIPTION
If the client receives a DHCPNAK message, the client restarts the
configuration process
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPNAK Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:20 mcast:0 errors:0 dropped:17
	TX packets:57 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:5922  TX bytes:16722 (16 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2504  lo0    0    
128.224.166.0/23                vxTarget                      UC       2248  gei2   0    
vxTarget                        vxTarget                      UH       8906  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       340272lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0BB4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1475251316 (0x57EE8C74)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exi
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0013 (19)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA4 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xFF6A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1475251316 (0x57EE8C74)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3594 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1475251316 (0x57EE8C74)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0014 (20)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA3 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xFC6A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1475251316 (0x57EE8C74)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
t
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x2998 (10648)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xE40A (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x679A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1475251316 (0x57EE8C74)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPNAK Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x0015 (21)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x43C2 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 258 
UDP: Checksum         = 0x3AA7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1475251316 (0x57EE8C74)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3A20 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 479211852 (0x1C90314C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.10: Passed

>> DHCP-CLIENT-5.11
TEST_DESCRIPTION
The client times out and retransmits the DHCPREQUEST message if the
client receives neither a DHCPACK or a DHCPNAK message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: Initialize server1 to offer IP Address Lease Time
         of <HIGH-LEASE-TIME> seconds to the DUT
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto ((<REMOTE-CLIENT1-T2> -
       <REMOTE-CLIENT1-T1>) + <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends 2 DHCPREQUEST Messages
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:24 mcast:0 errors:0 dropped:19
	TX packets:67 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:6918  TX bytes:18342 (18 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2512  lo0    0    
128.224.166.0/23                vxTarget                      UC       2267  gei2   0    
vxTarget                        vxTarget                      UH       8977  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       343842lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Initializing server1 to offer IP Address Lease Time
of <HIGH-LEASE-TIME> seconds to the DUT

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x868F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3945692760 (0xEB2E7E58)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0016 (22)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA1 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xF943 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3945692760 (0xEB2E7E58)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xAF61 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3945692760 (0xEB2E7E58)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0017 (23)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA0 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xF643 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3945692760 (0xEB2E7E58)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 155.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 151.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x4A04 (18948)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xC39E (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE167 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3945692760 (0xEB2E7E58)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x386A (14442)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xD538 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE167 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3945692760 (0xEB2E7E58)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected 2 DHCPREQUEST Messages from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.11: Passed

>> DHCP-CLIENT-5.12
TEST_DESCRIPTION
The client SHOULD notify the user that the initialization process has
failed and is restarting
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Server <SERVER-1> Listens (upto
       (<REMOTE-CLIENT1-LEASE-TIME> + <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that the DUT has correctly logged that
        initialization process has failed and is restarting
        for 
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:27 mcast:0 errors:0 dropped:21
	TX packets:78 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:7622  TX bytes:20304 (20 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2520  lo0    0    
128.224.166.0/23                vxTarget                      UC       2301  gei2   0    
vxTarget                        vxTarget                      UH       9052  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       347464lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x380C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 512399744 (0x1E8A9980)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0018 (24)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2BC3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 512399744 (0x1E8A9980)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x61EC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 512399744 (0x1E8A9980)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0019 (25)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x28C3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 512399744 (0x1E8A9980)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 100.000 seconds) for DHCPDISCOVER Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xDB0B (56075)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3297 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x93F2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 512399744 (0x1E8A9980)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC9F3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 512399744 (0x1E8A9980)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD756 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4217091401 (0xFB5BB549)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

 Verifying that the DUT has correctly logged that
initialization process has failed and is restarting
for 
Verifying DUT has logged the event of restarting DHCP Client
for <DIface-0> in case of failure to reacquire IP Address
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-restart-log-check-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> 
 DUT has correctly logged that initialization process
has failed and is restarting for 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.12: Passed

>> DHCP-CLIENT-5.13
TEST_DESCRIPTION
The client may choose to relinquish its lease on a network address
by sending a DHCPRELEASE message to the server
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPRELEASE Message
- ANVL: Wait till <ParamProcessTime> for DUT to actually stop using
        the released address
- ANVL:DHCP Server <SERVER-1> Sends ICMP Echo Message to DUT through
       <DIface-0> containing :
        - Destination Harware Address field set to
           <DIface-0-MAC-ADDRESS>
        - Destination IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Reply Message
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:30 mcast:0 errors:0 dropped:23
	TX packets:89 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:8326  TX bytes:22266 (22 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2528  lo0    0    
128.224.166.0/23                vxTarget                      UC       2322  gei2   0    
vxTarget                        vxTarget                      UH       9133  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       351180lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x24D9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4202680509 (0xFA7FD0BD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exi
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001A (26)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x1890 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4202680509 (0xFA7FD0BD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4EB9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4202680509 (0xFA7FD0BD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001B (27)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x1590 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4202680509 (0xFA7FD0BD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPRELEASE Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
t
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> c
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0986 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4202680509 (0xFA7FD0BD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPRELEASE Message from <DIface-0>

Waiting (up to 2.000 seconds) for DUT to actually stop using the released address
md ifconfig gei0 -dhcp
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> sending ICMP Echo Message to DUT through <DIface-0> containing :
  - Destination Harware Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - Destination IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x001C (28)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0EB3 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6B73 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x4141 (16705)
ICMP: Sequence Number  = 0x4141 (16705)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for no ICMP Echo Reply Message on <DIface-0>

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Reply Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.13: Passed

>> DHCP-CLIENT-5.14
TEST_DESCRIPTION
The client identifies the lease to be released with its 'client
 identifier',
or 'chaddr' and network address in the DHCPRELEASE message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Extracts the content of 'chaddr' field to <extractedChaddr>
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPRELEASE Message
- ANVL: Verify that received DHCPRELEASE Message contains:
        - 'chaddr' field is set to extractedChaddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:33 mcast:0 errors:0 dropped:26
	TX packets:92 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:9030  TX bytes:23292 (23 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2536  lo0    0    
128.224.166.0/23                vxTarget                      UC       2330  gei2   0    
vxTarget                        vxTarget                      UH       9221  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       355068lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF9AB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 424664347 (0x194FDD1B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001D (29)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xED62 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 424664347 (0x194FDD1B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x238C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 424664347 (0x194FDD1B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001E (30)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D99 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xEA62 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 424664347 (0x194FDD1B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Extracted the content of 'chaddr' field (00:15:17:C8:90:28) to <extractedChaddr>

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPRELEASE Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhc
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xDE58 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 424664347 (0x194FDD1B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPRELEASE Message from <DIface-0>

'chaddr' field in received DHCPRELEASE Message is correctly set to 00:15:17:C8:90:28

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
p
-> e
-> cmd sysvar set -co ipdhcxit
Au revoir!
Connection closed by foreign host.
pc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.14: Passed

>> DHCP-CLIENT-5.15
TEST_DESCRIPTION
If the client used a 'client identifier' when it obtained the lease, it
MUST use the same 'client identifier' in the DHCPRELEASE message
If the client supplies a 'client identifier', the client MUST use the
same 'client identifier' in all subsequent messages
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
RFC 2131 Section 4.2 Page 26 'DHCP server administrative controls'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 61 (Client-identifier Option)
        with value "CONFORMANCE-DUT-0" for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to SELECTING
-  DUT: Transit finite state to SELECTING
- ANVL: Extracts the content of 61 (Client-identifier Option) to
        <extractedClientID>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPRELEASE Message
- ANVL: Verify that received DHCPRELEASE Message contains:
        - Message Option containing extractedClientID
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:35 mcast:0 errors:0 dropped:28
	TX packets:96 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:9674  TX bytes:24360 (24 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2544  lo0    0    
128.224.166.0/23                vxTarget                      UC       2335  gei2   0    
vxTarget                        vxTarget                      UH       9308  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       358700lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option Client-identifier with value
"CONFORMANCE-DUT-0" on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 61 "CONFORMANCE-DUT-0"

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.client_identifier ""CONFORMANCE-DUT-0""
sysvar: ipdhcpc.option.client_identifier=CONFORMANCE-DUT-0 ok
-> cmd sysvar get ipdhcpc.option.client_identifier
sysvar: ipdhcpc.option.client_identifier=CONFORMANCE-DUT-0
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8859 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3620777164 (0xD7D0ACCC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001F (31)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D98 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x5F30 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3620777164 (0xD7D0ACCC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to SELECTING state

Extracted the content of 61 (Client-identifier Option) (
Client-identifier (61) Length : 18 Value : 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30) to <extractedClientID>

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6685 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3620777164 (0xD7D0ACCC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0020 (32)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D97 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x5C30 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3620777164 (0xD7D0ACCC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPRELEASE Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhcp

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC7AB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3620777164 (0xD7D0ACCC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPRELEASE Message from <DIface-0>

Message Option in received DHCPRELEASE Message correctly contains Option Client-identifier (61) Length : 18 Value : 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
-> e
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disxit
Au revoir!
Connection closed by foreign host.
able"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.15: Passed

>> DHCP-CLIENT-6.1
TEST_DESCRIPTION
If the client receives neither a DHCPACK or a DHCPNAK message after
employing the retransmission algorithm, the client reverts to INIT state
and restarts the initialization process
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: Initialize server1 to offer IP Address Lease Time
         of <HIGH-LEASE-TIME> seconds to the DUT
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till <ParamProcessTime> for DUT to stabilize in BOUND
        state
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends 2 DHCPREQUEST Messages
- ANVL:DHCP Server <SERVER-1> Listens (upto (130 + 10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
(Note: We have derived 130 seconds keeping in mind the total retransmission
        time in RFC 2131 Section 4.1 Page 24)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:37 mcast:0 errors:0 dropped:30
	TX packets:99 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:10318 (10 k)  TX bytes:25386 (25 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2552  lo0    0    
128.224.166.0/23                vxTarget                      UC       2339  gei2   0    
vxTarget                        vxTarget                      UH       9383  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       361648lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Initializing server1 to offer IP Address Lease Time
of <HIGH-LEASE-TIME> seconds to the DUT

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC606 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2427893305 (0x90B6B639)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exi
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0021 (33)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D96 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x1BDB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2427893305 (0x90B6B639)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9631 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2427893305 (0x90B6B639)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0022 (34)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D95 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x18DB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2427893305 (0x90B6B639)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 2.000 seconds) for DUT to stabilize in BOUND state
t
Au revoir!
Connection closed by foreign host.

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9B9D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2427893305 (0x90B6B639)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9B99 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2427893305 (0x90B6B639)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected 2 DHCPREQUEST Messages from <DIface-0>

Listening (up to 160.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9B91 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2427893305 (0x90B6B639)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9B81 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2427893305 (0x90B6B639)
DHCP: secs                      = 28
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9B61 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2427893305 (0x90B6B639)
DHCP: secs                      = 60
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE58E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1687657063 (0x64979A67)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.1: Passed

>> DHCP-CLIENT-6.2
TEST_DESCRIPTION
If a client remembers and wishes to reuse a previously allocated
network address, a client may choose to omit some of the steps
described in the previous section
TEST_REFERENCE
RFC 2131 Section 3.2 Page 17
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till <ParamProcessTime> for DUT to stabilize in BOUND
        state
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:39 mcast:0 errors:0 dropped:32
	TX packets:120 mcast:12 errors:0
	collisions:0 unsupported proto:0
	RX bytes:10962 (10 k)  TX bytes:28992 (28 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2560  lo0    0    
128.224.166.0/23                vxTarget                      UC       2364  gei2   0    
vxTarget                        vxTarget                      UH       9503  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       365374lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x703F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2355499089 (0x8C661051)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0023 (35)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D94 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x4716 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2355499089 (0x8C661051)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4E6B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2355499089 (0x8C661051)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0024 (36)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D93 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x4416 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2355499089 (0x8C661051)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 2.000 seconds) for DUT to stabilize in BOUND state
xit
Au revoir!
Connection closed by foreign host.

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x53D7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2355499089 (0x8C661051)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.2: Passed

>> DHCP-CLIENT-6.4
TEST_DESCRIPTION
If a client remembers and wishes to reuse a previously allocated
network address, ... .The message includes the client's network address
in the 'requested IP address' option
TEST_REFERENCE
RFC 2131 Section 3.2 Page 18
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:41 mcast:0 errors:0 dropped:34
	TX packets:137 mcast:19 errors:0
	collisions:0 unsupported proto:0
	RX bytes:11606 (11 k)  TX bytes:30930 (30 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2568  lo0    0    
128.224.166.0/23                vxTarget                      UC       2372  gei2   0    
vxTarget                        vxTarget                      UH       9593  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       370074lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEFB6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 434045793 (0x19DF0361)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0025 (37)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D92 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xC68D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 434045793 (0x19DF0361)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xCDE2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 434045793 (0x19DF0361)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0026 (38)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D91 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xC38D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 434045793 (0x19DF0361)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD34E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 434045793 (0x19DF0361)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Requested IP Address (50) Length : 4 Value : 54.0.0.2 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.4: Passed

>> DHCP-CLIENT-6.5
TEST_DESCRIPTION
As the client has not received its network address, it MUST NOT fill in
the 'ciaddr' field
TEST_REFERENCE
RFC 2131 Section 3.2 Page 18
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:43 mcast:0 errors:0 dropped:36
	TX packets:153 mcast:26 errors:0
	collisions:0 unsupported proto:0
	RX bytes:12250 (12 k)  TX bytes:32826 (32 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2576  lo0    0    
128.224.166.0/23                vxTarget                      UC       2383  gei2   0    
vxTarget                        vxTarget                      UH       9681  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       373950lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xFB7F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3505733761 (0xD0F54081)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0027 (39)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D90 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xD256 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3505733761 (0xD0F54081)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD9AB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3505733761 (0xD0F54081)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0028 (40)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xCF56 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3505733761 (0xD0F54081)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xDF17 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3505733761 (0xD0F54081)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'ciaddr' field in received DHCPREQUEST Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.5: Passed

>> DHCP-CLIENT-6.6
TEST_DESCRIPTION
If the client used a 'client identifier' to obtain its
address, the client MUST use the same 'client identifier' in the
If the client supplies a 'client identifier', the client MUST use the
same 'client identifier' in all subsequent messages
DHCPREQUEST message
TEST_REFERENCE
RFC 2131 Section 3.2 Page 18
'Client-server interaction - reusing a previously allocated network
 address'
RFC 2131 Section 4.2 Page 26 'DHCP server administrative controls'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 61 (Client-identifier Option)
        with value "CONFORMANCE-DUT-0" for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Extracts the content of 61 (Client-identifier Option) to
        <extractedClientID>
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing extractedClientID
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:45 mcast:0 errors:0 dropped:38
	TX packets:169 mcast:33 errors:0
	collisions:0 unsupported proto:0
	RX bytes:12894 (12 k)  TX bytes:34722 (34 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2584  lo0    0    
128.224.166.0/23                vxTarget                      UC       2397  gei2   0    
vxTarget                        vxTarget                      UH       9768  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       376702lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option Client-identifier with value
"CONFORMANCE-DUT-0" on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 61 "CONFORMANCE-DUT-0"

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.client_identifier ""CONFORMANCE-DUT-0""
sysvar: ipdhcpc.option.client_identifier=CONFORMANCE-DUT-0 ok
-> cmd sysvar get ipdhcpc.option.client_identifier
sysvar: ipdhcpc.option.client_identifier=CONFORMANCE-DUT-0
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3992 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 806855501 (0x3017A34D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0029 (41)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x1069 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 806855501 (0x3017A34D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x17BE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 806855501 (0x3017A34D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002A (42)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0D69 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 806855501 (0x3017A34D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Extracted the content of 61 (Client-identifier Option) (
Client-identifier (61) Length : 18 Value : 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30) to <extractedClientID>

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1D2A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 806855501 (0x3017A34D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Client-identifier (61) Length : 18 Value : 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.6: Passed

>> DHCP-CLIENT-6.8
TEST_DESCRIPTION
If the client receives a DHCPNAK message, it cannot reuse its
remembered network address.  It must instead request a new
address by restarting the configuration process, this time
using the (non-abbreviated) procedure described in section 3.1
TEST_REFERENCE
RFC 2131 Section 3.2 Page 19
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPNAK Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:47 mcast:0 errors:0 dropped:40
	TX packets:185 mcast:40 errors:0
	collisions:0 unsupported proto:0
	RX bytes:13538 (13 k)  TX bytes:36618 (36 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2592  lo0    0    
128.224.166.0/23                vxTarget                      UC       2406  gei2   0    
vxTarget                        vxTarget                      UH       9877  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       381628lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4B9C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 273395983 (0x104BB10F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002B (43)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2273 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 273395983 (0x104BB10F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x29C8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 273395983 (0x104BB10F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002C (44)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x1F73 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 273395983 (0x104BB10F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2F34 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 273395983 (0x104BB10F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPNAK Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x002D (45)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x43AA (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 258 
UDP: Checksum         = 0x5DAF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 273395983 (0x104BB10F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0D77 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2721202917 (0xA23242E5)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.8: Passed

>> DHCP-CLIENT-7.1
TEST_DESCRIPTION
If a client has obtained a network address through some other means
(e.g., manual configuration), it may use a DHCPINFORM request message
to obtain other local configuration parameters
TEST_REFERENCE
RFC 2131 Section 3.4 Page 20
'Obtaining parameters with externally configured network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <IP-UNUSED-ADDRESS> with mask
        <IP-UNUSED-NET-MASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:50 mcast:0 errors:0 dropped:42
	TX packets:201 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:14474 (14 k)  TX bytes:38814 (38 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2600  lo0    0    
128.224.166.0/23                vxTarget                      UC       2417  gei2   0    
vxTarget                        vxTarget                      UH       9965  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       385256lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 56.0.0.1 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 56.0.0.1 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 56.0.0.1 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x01A5 (Correct)
IP: Source Address         = 56.0.0.1
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x815C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3565649983 (0xD487803F)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 56.0.0.1
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

Deleting IP Address 56.0.0.1 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 56.0.0.1 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet delete 56.0.0.1 up
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-7.1: Passed

>> DHCP-CLIENT-8.1
TEST_DESCRIPTION
First, most of the parameters have defaults defined in the Host
Requirements RFCs; if the client receives no parameters from the server
that override the defaults, a client uses those default values
(Note: This test checks that if default value is not overridden,
       DUT uses the default value for Time To Live as per RFC1770
       'IANA Numbering')
TEST_REFERENCE
RFC 2131 Section 3.5 Page 21 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till <ParamProcessTime> for DUT to perform necessary
        verification of offered IP address
- ANVL:DHCP Server <SERVER-1> Sends ICMP Echo Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Reply Message
- ANVL: Verify that received ICMP Echo Reply Message contains:
        - Time to Live field is set to 64
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:50 mcast:0 errors:0 dropped:42
	TX packets:207 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:14474 (14 k)  TX bytes:39366 (39 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2616  lo0    0    
128.224.166.0/23                vxTarget                      UC       2423  gei2   0    
vxTarget                        vxTarget                      UH       10082 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       390542lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8A77 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2011433627 (0x77E40A9B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002E (46)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D89 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x614E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2011433627 (0x77E40A9B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x68A3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2011433627 (0x77E40A9B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002F (47)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D88 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x5E4E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2011433627 (0x77E40A9B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 2.000 seconds) for DUT to perform necessary verification of offered IP address
xit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> sending ICMP Echo Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0030 (48)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0E9F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6B73 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x4141 (16705)
ICMP: Sequence Number  = 0x4141 (16705)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for ICMP Echo Reply Message on <DIface-0>

! DHCP Server <SERVER-1> did not receive expected ICMP Echo Reply Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-8.1: !INCONCLUSIVE!

>> DHCP-CLIENT-8.2
TEST_DESCRIPTION
First, most of the parameters have defaults defined in the Host
Requirements RFCs; if the client receives no parameters from the server
that override the defaults, a client uses those default values
(Note: This test checks that if default value is overridden,
       DUT uses the overridden value for Time To Live)
TEST_REFERENCE
RFC 2131 Section 3.5 Page 21 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to <ParamLeaseTime>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to <ParamLeaseTime>
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:53 mcast:0 errors:0 dropped:44
	TX packets:215 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15178 (15 k)  TX bytes:40302 (40 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2624  lo0    0    
128.224.166.0/23                vxTarget                      UC       2431  gei2   0    
vxTarget                        vxTarget                      UH       10156 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       394024lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEBCD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 387123734 (0x17130A16)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_IP_ADDRESS_LEASE_TIME (IP Address Lease Time) 
  - Length field set to 4 (4) 
  - Value set to <ParamLeaseTime> (80 seconds (1 minute 20 seconds)) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0031 (49)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D86 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xE383 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 387123734 (0x17130A16)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC9F9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 387123734 (0x17130A16)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option IP Address Lease Time (51) Length : 4 Value : 80 seconds (1 minute 20 seconds) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-8.2: Passed

>> DHCP-CLIENT-8.3
TEST_DESCRIPTION
If the client includes a list of parameters in a DHCPDISCOVER
message, it MUST include that list in any subsequent DHCPREQUEST
messages.
TEST_REFERENCE
RFC 2131 Section 3.5 Page 21 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 55 (Parameter Request List Option)
        to <extractedParamReq>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing extractedParamReq
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:54 mcast:0 errors:0 dropped:45
	TX packets:218 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15500 (15 k)  TX bytes:41328 (41 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2632  lo0    0    
128.224.166.0/23                vxTarget                      UC       2434  gei2   0    
vxTarget                        vxTarget                      UH       10226 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       396216lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x495A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 602644401 (0x23EB9FB1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 55 (Parameter Request List Option) (
Parameter Request List (55) Length : 4 Value : 
  1 = Subnet Mask
  6 = Domain Name Server
 28 = Broadcast Address
 42 = Network Time Protocol Servers
) to <extractedParamReq>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0032 (50)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D85 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2031 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 602644401 (0x23EB9FB1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2786 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 602644401 (0x23EB9FB1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Parameter Request List (55) Length : 4 Value : 
  1 = Subnet Mask
  6 = Domain Name Server
 28 = Broadcast Address
 42 = Network Time Protocol Servers
 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-8.3: Passed

>> DHCP-CLIENT-8.4
TEST_DESCRIPTION
The client SHOULD include the 'maximum DHCP message size' option to
let the server know how large the server may make its DHCP messages
TEST_REFERENCE
RFC 2131 Section 3.5 Page 21 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 57 (Maximum DHCP Size Option)
        with value 600 for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - Type field set to 57 (Maximum DHCP Size Option)
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:55 mcast:0 errors:0 dropped:46
	TX packets:221 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15822 (15 k)  TX bytes:42354 (42 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2640  lo0    0    
128.224.166.0/23                vxTarget                      UC       2436  gei2   0    
vxTarget                        vxTarget                      UH       10301 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       401124lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option Maximum DHCP Size with value
600 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 57 600

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.max_message_size "600"
sysvar: ipdhcpc.option.max_message_size=600 ok
-> cmd sysvar get ipdhcpc.option.max_message_size
sysvar: ipdhcpc.option.max_message_size=600
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE9B7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2176950653 (0x81C1A17D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Message Option in received DHCPDISCOVER Message correctly contains Option Maximum DHCP Size (57) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-8.4: Passed

>> DHCP-CLIENT-8.5
TEST_DESCRIPTION
In addition, the client may suggest values for the network address
and lease time in the DHCPDISCOVER message.  The client may ... include
the 'IP address lease time' option to suggest the lease time it would
like
TEST_REFERENCE
RFC 2131 Section 3.5 Page 21 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 51 (IP Address Lease Time
        Option)
        with value 60 for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to 60
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:55 mcast:0 errors:0 dropped:46
	TX packets:222 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15822 (15 k)  TX bytes:42696 (42 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2648  lo0    0    
128.224.166.0/23                vxTarget                      UC       2438  gei2   0    
vxTarget                        vxTarget                      UH       10393 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       405356lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option IP Address Lease Time with value
60 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 51 60

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.lease_time "60"
sysvar: ipdhcpc.option.lease_time=60 ok
-> cmd sysvar get ipdhcpc.option.lease_time
sysvar: ipdhcpc.option.lease_time=60
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x059B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2454680844 (0x924F750C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Message Option in received DHCPDISCOVER Message correctly contains Option IP Address Lease Time (51) Length : 4 Value : 60 seconds (1 minute ) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-8.5: Passed

>> DHCP-CLIENT-9.1
TEST_DESCRIPTION
A client with multiple network interfaces must use DHCP through each
interface independently to obtain configuration information
parameters for those separate interfaces
TEST_REFERENCE
RFC 2131 Section 3.6 Page 22 
'Use of DHCP in clients with multiple interfaces'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP Client on <DIface-1>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'chaddr' field to <extractedChaddr>
- ANVL: Externally cause DUT to bring up <DIface-1>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-1>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - 'chaddr' field is not set to extractedChaddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


  DHCP Client topology # 2
  ---------------------------------------

  +----------------+                          +----------------+
  |                |<AIface-0>      <DIface-0>|                |
  |             N0 +--------------------------+ N0             |
  |                |                          |                |
  |             N1 +--------------------------+ N1             |
  | <SERVER-1>     |<AIface-1>      <DIface-1>|           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:55 mcast:0 errors:0 dropped:46
	TX packets:223 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15822 (15 k)  TX bytes:43038 (43 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2656  lo0    0    
128.224.166.0/23                vxTarget                      UC       2439  gei2   0    
vxTarget                        vxTarget                      UH       10484 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       409232lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1
gei1	Link type:Ethernet  HWaddr 00:15:17:c8:90:29
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9029%gei1  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1300  metric:1  VR:0  ifindex:24
	RX packets:1 mcast:0 errors:0 dropped:1
	TX packets:8 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:322  TX bytes:1464

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2656  lo0    0    
128.224.166.0/23                vxTarget                      UC       2439  gei2   0    
vxTarget                        vxTarget                      UH       10484 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       409232lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB534 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 196824071 (0x0BBB4C07)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'chaddr' field (00:15:17:C8:90:28) to <extractedChaddr>

Booting up DHCP client on the DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-1>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei1 -dhcp
-> cmd ifconfig gei1 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6C6C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1167547122 (0x45975AF2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:29
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-1>

'chaddr' field in received DHCPDISCOVER Message is correctly set to 00:15:17:C8:90:29 (not set to 00:15:17:C8:90:28)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei1 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-9.1: Passed

>> DHCP-CLIENT-10.1
TEST_DESCRIPTION
A client SHOULD use DHCP to reacquire or verify its IP address and
network parameters whenever the local network parameters may have
changed; e.g., at system boot time
TEST_REFERENCE
RFC 2131 Section 3.7 Page 22 'When clients should use DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-2> Cause DUT to transit its state
        to REQUESTING
-  DUT: Transit finite state to REQUESTING
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 50 (Requested IP Address Option)
          - Length field is not set to 4
          - Value is not set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-3


  DHCP Client topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <SERVER-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <SERVER-2>     |
  +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:55 mcast:0 errors:0 dropped:46
	TX packets:225 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15822 (15 k)  TX bytes:43722 (43 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2672  lo0    0    
128.224.166.0/23                vxTarget                      UC       2439  gei2   0    
vxTarget                        vxTarget                      UH       10626 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       416216lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6F6B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 277056776 (0x10838D08)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0033 (51)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D83 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.3
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x4640 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 277056776 (0x10838D08)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4C97 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 277056776 (0x10838D08)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.3
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0034 (52)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D82 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.3
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x4340 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 277056776 (0x10838D08)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhcp
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD02B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2901381083 (0xACEF8FDB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-2> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 02:02:00:00:00:07
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0035 (53)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D7C (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.7
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA5F7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2901381083 (0xACEF8FDB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.7
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA857 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2901381083 (0xACEF8FDB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.7
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to REQUESTING state

Message Option in received DHCPREQUEST Message correctly contains Option Requested IP Address (50) Length : 4 Value : 54.0.0.7 
(not containing option Requested IP Address (50) Length : 4 Value : 54.0.0.3 )

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-10.1: Passed

>> DHCP-CLIENT-11.1
TEST_DESCRIPTION
The last option must always be the 'end' option
TEST_REFERENCE
RFC 2131 Section 4.1 Page 22-23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - 255 (End Option) at position Last
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:58 mcast:0 errors:0 dropped:49
	TX packets:231 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:16788 (16 k)  TX bytes:45774 (45 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2680  lo0    0    
128.224.166.0/23                vxTarget                      UC       2445  gei2   0    
vxTarget                        vxTarget                      UH       10732 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       419846lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x70B0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2137332961 (0x7F651CE1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Message Option in received DHCPDISCOVER Message is correctly set as  End Option (255) in position 5  

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.1: Passed

>> DHCP-CLIENT-11.2
TEST_DESCRIPTION
DHCP clients MUST use the IP address provided in the 'server identifier'
option for any unicast requests to the DHCP server
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to <SERVER1-IP-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:58 mcast:0 errors:0 dropped:49
	TX packets:232 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:16788 (16 k)  TX bytes:46116 (46 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2688  lo0    0    
128.224.166.0/23                vxTarget                      UC       2446  gei2   0    
vxTarget                        vxTarget                      UH       10805 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       423540lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC695 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 130432667 (0x07C63E9B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0036 (54)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D81 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9D6C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 130432667 (0x07C63E9B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA4C1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 130432667 (0x07C63E9B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0037 (55)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D80 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9A6C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 130432667 (0x07C63E9B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xFC4A (64586)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x1158 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0E90 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 130432667 (0x07C63E9B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 54.0.0.1

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.2: Passed

>> DHCP-CLIENT-11.3
TEST_DESCRIPTION
DHCP messages broadcast by a client prior to that client obtaining
its IP address must have the source address field in the IP header
set to 0
(Note: This test verifies source IP address field of DHCPDISCOVER
 Message)
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Source IP Address field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:61 mcast:0 errors:0 dropped:51
	TX packets:242 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:17492 (17 k)  TX bytes:47736 (47 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2696  lo0    0    
128.224.166.0/23                vxTarget                      UC       2457  gei2   0    
vxTarget                        vxTarget                      UH       10875 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       425814lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x06DE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4174253386 (0xF8CE0D4A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Source IP Address field in received DHCPDISCOVER Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.3: Passed

>> DHCP-CLIENT-11.4
TEST_DESCRIPTION
DHCP messages broadcast by a client prior to that client obtaining
its IP address must have the source address field in the IP header
set to 0
(Note: This test verifies source IP address field of DHCPREQUEST
 Message)
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REQUESTING
-  DUT: Transit finite state to REQUESTING
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Source IP Address field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:61 mcast:0 errors:0 dropped:51
	TX packets:243 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:17492 (17 k)  TX bytes:48078 (48 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2704  lo0    0    
128.224.166.0/23                vxTarget                      UC       2458  gei2   0    
vxTarget                        vxTarget                      UH       10950 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       430692lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8D0F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4292116498 (0xFFD48012)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0038 (56)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D7F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x63E6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4292116498 (0xFFD48012)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6B3B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4292116498 (0xFFD48012)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to REQUESTING state

Source IP Address field in received DHCPREQUEST Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.4: Passed

>> DHCP-CLIENT-11.5
TEST_DESCRIPTION
If the options in a DHCP message extend into the 'sname' and 'file'
fields, the 'option overload' option MUST appear in the 'options'
field, with value 1, 2 or 3
(Note: Here we verify that DUT correctly parses 'sname' field when
       Option Overload is present and set to 'sname contains options')
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:62 mcast:0 errors:0 dropped:52
	TX packets:246 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:17814 (17 k)  TX bytes:49104 (49 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2712  lo0    0    
128.224.166.0/23                vxTarget                      UC       2460  gei2   0    
vxTarget                        vxTarget                      UH       11023 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       434086lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x158E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1872070611 (0x6F9587D3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0039 (57)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C72 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x249D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1872070611 (0x6F9587D3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF3B9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1872070611 (0x6F9587D3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003A (58)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C71 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x249A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1872070611 (0x6F9587D3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2720  lo0    0    
128.224.166.0/23                vxTarget                      UC       2462  gei2   0    
vxTarget                        vxTarget                      UH       11066 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       436394lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x9C9C (40092)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7016 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x1D6F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x47E8 (18408)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.5: Passed

>> DHCP-CLIENT-11.6
TEST_DESCRIPTION
If the options in a DHCP message extend into the 'sname' and 'file'
fields, the 'option overload' option MUST appear in the 'options'
field, with value 1, 2 or 3
(Note: Here we verify that DUT correctly parses 'file' field when
       Option Overload is present and set to 'file contains options')
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:65 mcast:0 errors:0 dropped:54
	TX packets:256 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:19054 (19 k)  TX bytes:50468 (50 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2728  lo0    0    
128.224.166.0/23                vxTarget                      UC       2467  gei2   0    
vxTarget                        vxTarget                      UH       11136 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       439726lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9282 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1846938718 (0x6E160C5E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003B (59)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C70 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xA291 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1846938718 (0x6E160C5E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x70AE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1846938718 (0x6E160C5E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003C (60)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xA28E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1846938718 (0x6E160C5E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2728  lo0    0    
128.224.166.0/23                vxTarget                      UC       2469  gei2   0    
vxTarget                        vxTarget                      UH       11165 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       441414lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x5131 (20785)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xBB81 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x765D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0xEEF9 (61177)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.6: Passed

>> DHCP-CLIENT-11.8
TEST_DESCRIPTION
If the options in a DHCP message extend into the 'sname' and 'file'
fields, the 'option overload' option MUST appear in the 'options'
field, with value 1, 2 or 3
(Note: Here we verify that DUT correctly does not parse 'file' field 
       as Options when Option Overload is not present)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)(*INVALID*)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)(*INVALID*)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:68 mcast:0 errors:0 dropped:56
	TX packets:265 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:20294 (20 k)  TX bytes:51790 (51 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2736  lo0    0    
128.224.166.0/23                vxTarget                      UC       2475  gei2   0    
vxTarget                        vxTarget                      UH       11236 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       444288lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF83B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3146012982 (0xBB845936)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003D (61)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x084B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3146012982 (0xBB845936)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD667 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3146012982 (0xBB845936)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003E (62)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x0848 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3146012982 (0xBB845936)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2736  lo0    0    
128.224.166.0/23                vxTarget                      UC       2477  gei2   0    
vxTarget                        vxTarget                      UH       11265 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       446578lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x430F (17167)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xC9A3 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xB763 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0xADF3 (44531)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:71 mcast:0 errors:0 dropped:58
	TX packets:274 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:21534 (21 k)  TX bytes:53112 (53 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2744  lo0    0    
128.224.166.0/23                vxTarget                      UC       2482  gei2   0    
vxTarget                        vxTarget                      UH       11337 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       450110lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB67D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2921834577 (0xAE27A851)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003F (63)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x5336 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2921834577 (0xAE27A851)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = 6
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x94A9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2921834577 (0xAE27A851)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0040 (64)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x5036 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2921834577 (0xAE27A851)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = 6
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2744  lo0    0    
128.224.166.0/23                vxTarget                      UC       2484  gei2   0    
vxTarget                        vxTarget                      UH       11365 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       451898lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.8: Passed

>> DHCP-CLIENT-11.9
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated
by the 'options overload' option) MUST begin with the first octet of
the field
(Note: In this test we verify that the DUT correctly does not imbibe
       the Option present in 'sname' field when 1st octet is not the
       start of the option)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:73 mcast:0 errors:0 dropped:60
	TX packets:282 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:22714 (22 k)  TX bytes:54048 (54 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2744  lo0    0    
128.224.166.0/23                vxTarget                      UC       2494  gei2   0    
vxTarget                        vxTarget                      UH       11420 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       454914lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x08F8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4028896218 (0xF02413DA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0041 (65)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x1807 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4028896218 (0xF02413DA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE723 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4028896218 (0xF02413DA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0042 (66)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C69 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x1804 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4028896218 (0xF02413DA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2752  lo0    0    
128.224.166.0/23                vxTarget                      UC       2497  gei2   0    
vxTarget                        vxTarget                      UH       11464 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       457362lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x7DCC (32204)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x8EE6 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x83FA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0xE15C (57692)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:76 mcast:0 errors:0 dropped:62
	TX packets:292 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:23954 (23 k)  TX bytes:55412 (55 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2760  lo0    0    
128.224.166.0/23                vxTarget                      UC       2505  gei2   0    
vxTarget                        vxTarget                      UH       11536 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       460392lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8EE5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3679691453 (0xDB53A2BD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_PAD_OPTION(*INVALID*)     (Pad Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0043 (67)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C68 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xCFC2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3679691453 (0xDB53A2BD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 0 (Pad Option) ---
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6D11 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3679691453 (0xDB53A2BD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_PAD_OPTION(*INVALID*)     (Pad Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0044 (68)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C67 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xCFBF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3679691453 (0xDB53A2BD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 0 (Pad Option) ---
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2760  lo0    0    
128.224.166.0/23                vxTarget                      UC       2507  gei2   0    
vxTarget                        vxTarget                      UH       11564 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       462598lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.9: Passed

>> DHCP-CLIENT-11.10
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated ...
MUST be terminated by an 'end' option
(Note: In this test we verify that the DUT correctly does not imbibe
       the Option present in 'sname' field in absence of 'end' option)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:78 mcast:0 errors:0 dropped:64
	TX packets:300 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:25134 (25 k)  TX bytes:56348 (56 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2760  lo0    0    
128.224.166.0/23                vxTarget                      UC       2514  gei2   0    
vxTarget                        vxTarget                      UH       11618 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       465610lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA146 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1311448453 (0x4E2B1D85)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0045 (69)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C66 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xB055 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1311448453 (0x4E2B1D85)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7F72 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1311448453 (0x4E2B1D85)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0046 (70)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C65 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xB052 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1311448453 (0x4E2B1D85)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2768  lo0    0    
128.224.166.0/23                vxTarget                      UC       2517  gei2   0    
vxTarget                        vxTarget                      UH       11664 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       468074lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xF133 (61747)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1B7F (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xADE9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0xB76D (46957)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:81 mcast:0 errors:0 dropped:66
	TX packets:310 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:26374 (26 k)  TX bytes:57712 (57 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2776  lo0    0    
128.224.166.0/23                vxTarget                      UC       2521  gei2   0    
vxTarget                        vxTarget                      UH       11736 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       470980lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address      e   = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x273F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3335462632 (0xC6CF1EE8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0047 (71)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C64 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x354F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3335462632 (0xC6CF1EE8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x056B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3335462632 (0xC6CF1EE8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0048 (72)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C63 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x354C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3335462632 (0xC6CF1EE8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2776  lo0    0    
128.224.166.0/23                vxTarget                      UC       2524  gei2   0    
vxTarget                        vxTarget                      UH       11764 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       473158lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.10: Passed

>> DHCP-CLIENT-11.11
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated ...
MUST be terminated by an 'end' option
(Note: In this test we verify that the DUT correctly does not imbibe
       the Option present in 'file' field in absence of 'end' option)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:83 mcast:0 errors:0 dropped:68
	TX packets:318 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:27554 (27 k)  TX bytes:58648 (58 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2776  lo0    0    
128.224.166.0/23                vxTarget                      UC       2530  gei2   0    
vxTarget                        vxTarget                      UH       11817 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       476222lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2E1D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2958569089 (0xB0582E81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0049 (73)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C62 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x3E2C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2958569089 (0xB0582E81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0C49 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2958569089 (0xB0582E81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x004A (74)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C61 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x3E29 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2958569089 (0xB0582E81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2784  lo0    0    
128.224.166.0/23                vxTarget                      UC       2532  gei2   0    
vxTarget                        vxTarget                      UH       11862 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       478778lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x4D8F (19855)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xBF23 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x88BA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0xDC9C (56476)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:86 mcast:0 errors:0 dropped:70
	TX packets:328 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:28794 (28 k)  TX bytes:60012 (60 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2792  lo0    0    
128.224.166.0/23                vxTarget                      UC       2537  gei2   0    
vxTarget                        vxTarget                      UH       11933 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       481728lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x63B3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2852192066 (0xAA00FF42)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x004B (75)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C60 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x72C3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2852192066 (0xAA00FF42)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x41DF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2852192066 (0xAA00FF42)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x004C (76)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C5F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x72C0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2852192066 (0xAA00FF42)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2792  lo0    0    
128.224.166.0/23                vxTarget                      UC       2539  gei2   0    
vxTarget                        vxTarget                      UH       11961 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       484114lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.11: Passed

>> DHCP-CLIENT-11.12
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated
 ...)
and MUST be followed by 'pad' options to fill the remainder of the field
(Note: This test is done using the 'sname' field only)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:88 mcast:0 errors:0 dropped:72
	TX packets:336 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:29974 (29 k)  TX bytes:60948 (60 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2792  lo0    0    
128.224.166.0/23                vxTarget                      UC       2544  gei2   0    
vxTarget                        vxTarget                      UH       12016 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       486754lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x192E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3062119748 (0xB6843D44)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 311 bytes
IP: Identification         = 0x004D (77)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D67 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 291 
UDP: Checksum         = 0x2A4F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3062119748 (0xB6843D44)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF759 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3062119748 (0xB6843D44)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 311 bytes
IP: Identification         = 0x004E (78)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D66 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 291 
UDP: Checksum         = 0x2A4C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3062119748 (0xB6843D44)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2800  lo0    0    
128.224.166.0/23                vxTarget                      UC       2546  gei2   0    
vxTarget                        vxTarget                      UH       12060 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       489574lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xA452 (42066)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x6860 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x10AF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x54A8 (21672)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:91 mcast:0 errors:0 dropped:74
	TX packets:346 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:30684 (30 k)  TX bytes:62312 (62 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2808  lo0    0    
128.224.166.0/23                vxTarget                      UC       2551  gei2   0    
vxTarget                        vxTarget                      UH       12130 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       492612lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8700 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 355365064 (0x152E70C8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_PAD_OPTION(*INVALID*)     (Pad Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION(*INVALID*)     (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 311 bytes
IP: Identification         = 0x004F (79)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D65 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 291 
UDP: Checksum         = 0x9920 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 355365064 (0x152E70C8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: --- Option 0 (Pad Option) ---
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x652C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 355365064 (0x152E70C8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_PAD_OPTION(*INVALID*)     (Pad Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION(*INVALID*)     (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 311 bytes
IP: Identification         = 0x0050 (80)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D64 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 291 
UDP: Checksum         = 0x991D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 355365064 (0x152E70C8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: --- Option 0 (Pad Option) ---
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2808  lo0    0    
128.224.166.0/23                vxTarget                      UC       2553  gei2   0    
vxTarget                        vxTarget                      UH       12159 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       494838lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.12: Passed

>> DHCP-CLIENT-11.13
TEST_DESCRIPTION
The retransmission delay SHOULD be doubled with subsequent
retransmissions up to a maximum of 64 seconds
TEST_REFERENCE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto (64 + 32 + 16 + 8 + 4 +
       2 + 1 + <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends  DHCPDISCOVER Message(s)
- ANVL: Verify that the time interval between
        reception of last two DHCPDISCOVER Messages
         is less than 
        (64  +  <ParamToleranceTime>) second
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:93 mcast:0 errors:0 dropped:76
	TX packets:354 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:31334 (31 k)  TX bytes:63248 (63 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2816  lo0    0    
128.224.166.0/23                vxTarget                      UC       2560  gei2   0    
vxTarget                        vxTarget                      UH       12234 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       498520lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 147.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD7FA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1470750034 (0x57A9DD52)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD7F6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1470750034 (0x57A9DD52)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD7EE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1470750034 (0x57A9DD52)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD7DE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1470750034 (0x57A9DD52)
DHCP: secs                      = 28
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD7BE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1470750034 (0x57A9DD52)
DHCP: secs                      = 60
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected  DHCPDISCOVER Messages from <DIface-0>

Time interval (32.068 sec) between
reception of last two DHCPDISCOVER Messages 
is correctly  is less than 
(64  +  <ParamToleranceTime>) second (less than 84.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.13: Passed

>> DHCP-CLIENT-11.14
TEST_DESCRIPTION
The client MUST adopt a retransmission strategy that incorporates a
randomized exponential backoff algorithm to determine the delay
between retransmissions
TEST_REFERENCE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Listen (for upto (3 *
        (<ParamFirstRetransmissionInterval> + <ParamToleranceTime>)) seconds)
        on <DIface-0>
-  DUT: Send multiple DHCPDISCOVER Messages
- ANVL: Verify that the time interval between
        reception of 3rd last DHCPDISCOVER Message and second last
         DHCPDISCOVER Message
         is within the range of 
        (<ParamFirstRetransmissionInterval>  -  1) to
        (<ParamFirstRetransmissionInterval>  +  1seconds
- ANVL: Verify that the time interval between
        reception of last two DHCPDISCOVER Messages
         is within the range of 
        ((2*<ParamFirstRetransmissionInterval>)  -  1) to
        ((2*<ParamFirstRetransmissionInterval>)  +  1seconds
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:93 mcast:0 errors:0 dropped:76
	TX packets:359 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:31334 (31 k)  TX bytes:64958 (64 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2816  lo0    0    
128.224.166.0/23                vxTarget                      UC       2576  gei2   0    
vxTarget                        vxTarget                      UH       12277 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       500996lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 72.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x299E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1178836245 (0x46439D15)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x299A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1178836245 (0x46439D15)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2992 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1178836245 (0x46439D15)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER
 Messages from <DIface-0>

Time interval (4.054 sec) between
reception of 3dr last DHCPDISCOVER Message and second last
 DHCPDISCOVER Message 
is correctly  is within the range of 
(<ParamFirstRetransmissionInterval>  - 1) to
(<ParamFirstRetransmissionInterval>  + 1) seconds (3.000 to 5.000 sec)

Time interval (7.984 sec) between
reception of last two DHCPDISCOVER Messages 
is correctly  is within the range of 
((2*<ParamFirstRetransmissionInterval>) - 1) to
((2*<ParamFirstRetransmissionInterval>) + 1) seconds (7.000 to 9.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.14: Passed

>> DHCP-CLIENT-11.15
TEST_DESCRIPTION
For example, a client may choose a different, random initial 'xid'
each time the client is rebooted,
TEST_REFERENCE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Extracts the content of 'xid' field to <extractedXID>
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - 'xid' field is not set to extractedXID
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:93 mcast:0 errors:0 dropped:76
	TX packets:362 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:31334 (31 k)  TX bytes:65984 (65 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2824  lo0    0    
128.224.166.0/23                vxTarget                      UC       2578  gei2   0    
vxTarget                        vxTarget                      UH       12349 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       504654lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x92C2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2963130774 (0xB09DC996)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0051 (81)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D66 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6999 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2963130774 (0xB09DC996)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x70EE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2963130774 (0xB09DC996)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0052 (82)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D65 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6699 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2963130774 (0xB09DC996)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Extracted the content of 'xid' field (0xB09DC996) to <extractedXID>

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhcp
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xCB14 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4194846681 (0xFA0847D9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

'xid' field in received DHCPDISCOVER Message is correctly set to 4194846681 (0xFA0847D9) (not set to 2963130774 (0xB09DC996))

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
exit
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.15: Passed

>> DHCP-CLIENT-12.1
TEST_DESCRIPTION
Client inserts ... , 'ciaddr' MUST be zero
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REQUESTING
-  DUT: Transit finite state to REQUESTING
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:95 mcast:0 errors:0 dropped:78
	TX packets:366 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:31978 (31 k)  TX bytes:67352 (67 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2832  lo0    0    
128.224.166.0/23                vxTarget                      UC       2583  gei2   0    
vxTarget                        vxTarget                      UH       12465 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       508932lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address      e   = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBC25 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1238370049 (0x49D00701)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0053 (83)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D64 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x92FC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1238370049 (0x49D00701)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9A51 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1238370049 (0x49D00701)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to REQUESTING state

'ciaddr' field in received DHCPREQUEST Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.1: Passed

>> DHCP-CLIENT-12.2
TEST_DESCRIPTION
requested IP address' MUST be filled in with the yiaddr value from the
chosen DHCPOFFER.
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - 'yiaddr' field set to <SERVER1-IP-POOL-0-1>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-POOL-0-1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:96 mcast:0 errors:0 dropped:79
	TX packets:369 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:32300 (32 k)  TX bytes:68378 (68 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2840  lo0    0    
128.224.166.0/23                vxTarget                      UC       2584  gei2   0    
vxTarget                        vxTarget                      UH       12534 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       512338lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4E81 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1095728422 (0x414F7D26)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'yiaddr' field set to <SERVER1-IP-POOL-0-1> (54.0.0.3) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0054 (84)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D63 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2557 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1095728422 (0x414F7D26)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2BAD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1095728422 (0x414F7D26)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.3
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Requested IP Address (50) Length : 4 Value : 54.0.0.3 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.2: Passed

>> DHCP-CLIENT-12.3
TEST_DESCRIPTION
o DHCPREQUEST generated during INIT-REBOOT state:
  'server identifier' MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to reboot <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 54 (Server Identifier Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:97 mcast:0 errors:0 dropped:80
	TX packets:372 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:32622 (32 k)  TX bytes:69404 (69 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2848  lo0    0    
128.224.166.0/23                vxTarget                      UC       2586  gei2   0    
vxTarget                        vxTarget                      UH       12609 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       515972lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3438 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1909417711 (0x71CF66EF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0055 (85)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D62 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0B0F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1909417711 (0x71CF66EF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1264 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1909417711 (0x71CF66EF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0056 (86)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D61 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x080F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1909417711 (0x71CF66EF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Rebooting DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reboot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down 
-> cmd ifconfig gei0 up 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x17D0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1909417711 (0x71CF66EF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Server Identifier (54) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.3: Passed

>> DHCP-CLIENT-12.4
TEST_DESCRIPTION
o DHCPREQUEST generated during INIT-REBOOT state:
  'requested IP address' option MUST be filled in with client's notion
  of its previously assigned address.
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to reboot <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:99 mcast:0 errors:0 dropped:82
	TX packets:388 mcast:54 errors:0
	collisions:0 unsupported proto:0
	RX bytes:33266 (33 k)  TX bytes:71300 (71 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2856  lo0    0    
128.224.166.0/23                vxTarget                      UC       2596  gei2   0    
vxTarget                        vxTarget                      UH       12697 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       519576lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD1E2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 319563784 (0x130C2808)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0057 (87)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D60 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA8B9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 319563784 (0x130C2808)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB00E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 319563784 (0x130C2808)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0058 (88)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA5B9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 319563784 (0x130C2808)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Rebooting DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reboot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down 
-> cmd ifconfig gei0 up 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB57A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 319563784 (0x130C2808)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Requested IP Address (50) Length : 4 Value : 54.0.0.2 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.4: Passed

>> DHCP-CLIENT-12.5
TEST_DESCRIPTION
o DHCPREQUEST generated during INIT-REBOOT state:
  'ciaddr' MUST be zero
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to reboot <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:101 mcast:0 errors:0 dropped:84
	TX packets:404 mcast:61 errors:0
	collisions:0 unsupported proto:0
	RX bytes:33910 (33 k)  TX bytes:73196 (73 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2864  lo0    0    
128.224.166.0/23                vxTarget                      UC       2605  gei2   0    
vxTarget                        vxTarget                      UH       12788 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       523236lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x525F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1944274612 (0x73E346B4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0059 (89)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2936 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1944274612 (0x73E346B4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x308B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1944274612 (0x73E346B4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005A (90)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2636 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1944274612 (0x73E346B4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Rebooting DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reboot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down 
-> cmd ifconfig gei0 up 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x35F7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1944274612 (0x73E346B4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'ciaddr' field in received DHCPREQUEST Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.5: Passed

>> DHCP-CLIENT-12.6
TEST_DESCRIPTION
o DHCPREQUEST generated during RENEWING state:
  'server identifier' MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 54 (Server Identifier Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:103 mcast:0 errors:0 dropped:86
	TX packets:420 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:34554 (34 k)  TX bytes:75092 (75 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2880  lo0    0    
128.224.166.0/23                vxTarget                      UC       2614  gei2   0    
vxTarget                        vxTarget                      UH       12893 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       527382lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8AB0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2224225715 (0x8492FDB3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005B (91)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6187 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2224225715 (0x8492FDB3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x68DC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2224225715 (0x8492FDB3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005C (92)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x5E87 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2224225715 (0x8492FDB3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xDE2A (56874)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2F78 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD2AA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2224225715 (0x8492FDB3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Server Identifier (54) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.6: Passed

>> DHCP-CLIENT-12.7
TEST_DESCRIPTION
o DHCPREQUEST generated during RENEWING state:
  'requested IP address' option MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 50 (Requested IP Address Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:106 mcast:0 errors:0 dropped:88
	TX packets:430 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:35258 (35 k)  TX bytes:76712 (76 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2880  lo0    0    
128.224.166.0/23                vxTarget                      UC       2626  gei2   0    
vxTarget                        vxTarget                      UH       12951 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       530366lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC0FB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1006178306 (0x3BF91002)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005D (93)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x97D2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1006178306 (0x3BF91002)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9F27 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1006178306 (0x3BF91002)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005E (94)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D59 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x94D2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1006178306 (0x3BF91002)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xA64C (42572)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x6756 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x08F6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1006178306 (0x3BF91002)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Requested IP Address (50) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.7: Passed

>> DHCP-CLIENT-12.8
TEST_DESCRIPTION
o DHCPREQUEST generated during RENEWING state:
  ciaddr' MUST be filled in with client's IP address
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:109 mcast:0 errors:0 dropped:90
	TX packets:440 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:35962 (35 k)  TX bytes:78332 (78 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2888  lo0    0    
128.224.166.0/23                vxTarget                      UC       2636  gei2   0    
vxTarget                        vxTarget                      UH       13024 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       533976lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1FC8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2202954208 (0x834E69E0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005F (95)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D58 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xF69E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2202954208 (0x834E69E0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xFDF3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2202954208 (0x834E69E0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0060 (96)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D57 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xF39E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2202954208 (0x834E69E0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x8E77 (36471)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7F2B (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x67C2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2202954208 (0x834E69E0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'ciaddr' field in received DHCPREQUEST Message is correctly set to 54.0.0.2

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.8: Passed

>> DHCP-CLIENT-12.9
TEST_DESCRIPTION
o DHCPREQUEST generated during REBINDING state:
  'server identifier' MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REBINDING
-  DUT: Transit finite state to REBINDING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 54 (Server Identifier Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:112 mcast:0 errors:0 dropped:92
	TX packets:450 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:36666 (36 k)  TX bytes:79952 (79 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2896  lo0    0    
128.224.166.0/23                vxTarget                      UC       2652  gei2   0    
vxTarget                        vxTarget                      UH       13096 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       537574lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x065B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 213973467 (0x0CC0F9DB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0061 (97)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D56 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xDD31 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 213973467 (0x0CC0F9DB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE486 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 213973467 (0x0CC0F9DB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0062 (98)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D55 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xDA31 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 213973467 (0x0CC0F9DB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

Waiting (up to 30.000 seconds) for DUT Client to transit to REBINDING state
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT successfully transited to REBINDING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8456 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 213973467 (0x0CC0F9DB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Server Identifier (54) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.9: Passed

>> DHCP-CLIENT-12.10
TEST_DESCRIPTION
o DHCPREQUEST generated during REBINDING state:
  'requested IP address' option MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REBINDING
-  DUT: Transit finite state to REBINDING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 50 (Requested IP Address Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:115 mcast:0 errors:0 dropped:94
	TX packets:461 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:37370 (37 k)  TX bytes:81914 (81 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2904  lo0    0    
128.224.166.0/23                vxTarget                      UC       2665  gei2   0    
vxTarget                        vxTarget                      UH       13169 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       541160lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x456C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3209955382 (0xBF540836)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0063 (99)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D54 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x1C43 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3209955382 (0xBF540836)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2398 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3209955382 (0xBF540836)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0064 (100)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D53 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x1943 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3209955382 (0xBF540836)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

Waiting (up to 30.000 seconds) for DUT Client to transit to REBINDING state
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT successfully transited to REBINDING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC367 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3209955382 (0xBF540836)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Requested IP Address (50) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.10: Passed

>> DHCP-CLIENT-12.11
TEST_DESCRIPTION
o DHCPREQUEST generated during REBINDING state:
  'ciaddr' MUST be filled in with client's IP address
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REBINDING
-  DUT: Transit finite state to REBINDING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:118 mcast:0 errors:0 dropped:96
	TX packets:472 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:38074 (38 k)  TX bytes:83876 (83 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2912  lo0    0    
128.224.166.0/23                vxTarget                      UC       2681  gei2   0    
vxTarget                        vxTarget                      UH       13239 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       544614lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xACC3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3436352352 (0xCCD29360)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0065 (101)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D52 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x839A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3436352352 (0xCCD29360)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8AEF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3436352352 (0xCCD29360)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0066 (102)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D51 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x809A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3436352352 (0xCCD29360)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

Waiting (up to 30.000 seconds) for DUT Client to transit to REBINDING state
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT successfully transited to REBINDING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2ABF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3436352352 (0xCCD29360)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'ciaddr' field in received DHCPREQUEST Message is correctly set to 54.0.0.2

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.11: Passed

>> DHCP-CLIENT-12.12
TEST_DESCRIPTION
o DHCPREQUEST generated during REBINDING state:
  This message MUST be broadcast to the 0xffffffff IP broadcast address
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REBINDING
-  DUT: Transit finite state to REBINDING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to 0xffffffff
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:121 mcast:0 errors:0 dropped:98
	TX packets:483 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:38778 (38 k)  TX bytes:85838 (85 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2920  lo0    0    
128.224.166.0/23                vxTarget                      UC       2695  gei2   0    
vxTarget                        vxTarget                      UH       13313 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       548336lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD6A1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3697498609 (0xDC6359F1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Messaege Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0067 (103)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D50 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xAD78 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3697498609 (0xDC6359F1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB4CD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3697498609 (0xDC6359F1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0068 (104)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xAA78 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3697498609 (0xDC6359F1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

Waiting (up to 30.000 seconds) for DUT Client to transit to REBINDING state
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT successfully transited to REBINDING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x549D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3697498609 (0xDC6359F1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 255.255.255.255

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.12: Passed

>> DHCP-CLIENT-13.1
TEST_DESCRIPTION
The client SHOULD wait a random time between one and ten seconds to
desynchronize the use of DHCP at startup
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPNAK Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that the time interval between
        sending of last DHCPNAK Message and reception of last
         DHCPDISCOVER Message
         is greater than or equal to 
        (1  -  <ParamToleranceTime>) second
- ANVL: Verify that the time interval between
        sending of last DHCPNAK Message and reception of last
         DHCPDISCOVER Message
         is less than or equal to 
        (10  +  <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:124 mcast:0 errors:0 dropped:100
	TX packets:494 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:39482 (39 k)  TX bytes:87800 (87 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2928  lo0    0    
128.224.166.0/23                vxTarget                      UC       2711  gei2   0    
vxTarget                        vxTarget                      UH       13388 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       551778lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x06F8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1996263170 (0x76FC8F02)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0069 (105)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xDDCE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1996263170 (0x76FC8F02)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE523 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1996263170 (0x76FC8F02)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006A (106)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xDACE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1996263170 (0x76FC8F02)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0767 (1895)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x063C (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4EF2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1996263170 (0x76FC8F02)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPNAK Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x006B (107)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x436C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 258 
UDP: Checksum         = 0x190B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1996263170 (0x76FC8F02)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBF54 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2732888149 (0xA2E49055)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Time interval (10.833 sec) between
sending of last DHCPNAK Message and reception of last DHCPDISCOVER Message 
is correctly  is greater than or equal to 
(1  -  <ParamToleranceTime>) second (greater than or equal to 0.000 sec)

Time interval (10.833 sec) between
sending of last DHCPNAK Message and reception of last DHCPDISCOVER Message 
is correctly  is less than or equal to 
(10  +  <ParamToleranceTime>) second (less than or equal to 30.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.1: Passed

>> DHCP-CLIENT-13.2
TEST_DESCRIPTION
The client begins in INIT state and forms a DHCPDISCOVER message ...
The client sets 'ciaddr' to 0x00000000
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - 'ciaddr' field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:128 mcast:0 errors:0 dropped:102
	TX packets:504 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:40478 (40 k)  TX bytes:89420 (89 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2936  lo0    0    
128.224.166.0/23                vxTarget                      UC       2725  gei2   0    
vxTarget                        vxTarget                      UH       13460 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       555424lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC3C4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 739712283 (0x2C171D1B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

'ciaddr' field in received DHCPDISCOVER Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.2: Passed

>> DHCP-CLIENT-13.3
TEST_DESCRIPTION
The client begins in INIT state and forms a DHCPDISCOVER message ...
The client MUST include its hardware address in the 'chaddr' field
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of Source Harware Address field to
        <extractedSrcHwAddr>
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - 'chaddr' field is set to extractedSrcHwAddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:128 mcast:0 errors:0 dropped:102
	TX packets:505 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:40478 (40 k)  TX bytes:89762 (89 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2944  lo0    0    
128.224.166.0/23                vxTarget                      UC       2727  gei2   0    
vxTarget                        vxTarget                      UH       13534 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       558930lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA76C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4267206449 (0xFE586731)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of Source Harware Address field (00:15:17:C8:90:28) to <extractedSrcHwAddr>

'chaddr' field in received DHCPDISCOVER Message is correctly set to 00:15:17:C8:90:28

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.3: Passed

>> DHCP-CLIENT-13.4
TEST_DESCRIPTION
If the 'xid' of an arriving DHCPOFFER message does not match the
'xid' of the most recent DHCPDISCOVER message, the DHCPOFFER message
must be silently discarded
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'xid' field to <extractedXID>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - 'xid' field set to (extractedXID+1)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send DHCPREQUEST Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:128 mcast:0 errors:0 dropped:102
	TX packets:506 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:40478 (40 k)  TX bytes:90104 (90 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2952  lo0    0    
128.224.166.0/23                vxTarget                      UC       2728  gei2   0    
vxTarget                        vxTarget                      UH       13594 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       562012lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE93D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2905634440 (0xAD307688)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'xid' field (0xAD307688) to <extractedXID>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'xid' field set to (extractedXID+1) (0xAD307689) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006C (108)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xC013 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2905634441 (0xAD307689)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for no DHCPREQUEST Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE939 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2905634440 (0xAD307688)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE931 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2905634440 (0xAD307688)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE921 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2905634440 (0xAD307688)
DHCP: secs                      = 28
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> correctly did not receive DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.4: Passed

>> DHCP-CLIENT-13.5
TEST_DESCRIPTION
Any arriving DHCPACK messages must be silently discarded
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send DHCPREQUEST Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:129 mcast:0 errors:0 dropped:103
	TX packets:510 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:40800 (40 k)  TX bytes:91472 (91 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2960  lo0    0    
128.224.166.0/23                vxTarget                      UC       2731  gei2   0    
vxTarget                        vxTarget                      UH       13676 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       565870lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5DD1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2745174917 (0xA3A00B85)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006D (109)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x31A8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2745174917 (0xA3A00B85)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for no DHCPREQUEST Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5DCD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2745174917 (0xA3A00B85)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5DC5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2745174917 (0xA3A00B85)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5DB5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2745174917 (0xA3A00B85)
DHCP: secs                      = 28
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> correctly did not receive DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.5: Passed

>> DHCP-CLIENT-13.6
TEST_DESCRIPTION
The DHCPREQUEST message contains the same 'xid' as the DHCPOFFER
message
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 38
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'xid' field to <extractedXID>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - 'xid' field set to extractedXID
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'xid' field is set to extractedXID
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:130 mcast:0 errors:0 dropped:104
	TX packets:514 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:41122 (41 k)  TX bytes:92840 (92 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2968  lo0    0    
128.224.166.0/23                vxTarget                      UC       2734  gei2   0    
vxTarget                        vxTarget                      UH       13748 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       569472lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4C3A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2195733980 (0x82E03DDC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'xid' field (0x82E03DDC) to <extractedXID>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'xid' field set to extractedXID (0x82E03DDC) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006E (110)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D49 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2311 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2195733980 (0x82E03DDC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2A66 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2195733980 (0x82E03DDC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'xid' field in received DHCPREQUEST Message is correctly set to 2195733980 (0x82E03DDC)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.6: Passed

>> DHCP-CLIENT-13.9
TEST_DESCRIPTION
If the network address appears to be in use, the client MUST send a
DHCPDECLINE message to the server
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 39
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ARP Request Message
- ANVL: Verify that received ARP Request Message contains:
        - ARP Target IP Address field is set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Sends ARP Response Message to DUT
       through <DIface-0> containing :
        - ARP Sender MAC Address field set to <MAC-UNUSED-ADDRESS>
        - ARP Sender IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDECLINE Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:131 mcast:0 errors:0 dropped:105
	TX packets:517 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:41444 (41 k)  TX bytes:93866 (93 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2976  lo0    0    
128.224.166.0/23                vxTarget                      UC       2736  gei2   0    
vxTarget                        vxTarget                      UH       13819 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       572870lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8D62 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2684805005 (0xA006DF8D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006F (111)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D48 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6439 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2684805005 (0xA006DF8D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6B8E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2684805005 (0xA006DF8D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0070 (112)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D47 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6139 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2684805005 (0xA006DF8D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 30.000 seconds) for ARP Request Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 0.0.0.0
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Server <SERVER-1> received expected ARP Request Message from <DIface-0>

ARP Target IP Address field in received ARP Request is correctly set to 54.0.0.2

DHCP Server <SERVER-1> sending ARP Response Message to DUT through <DIface-0> containing :
  - ARP Sender MAC Address field set to     <MAC-UNUSED-ADDRESS> (02:02:00:00:00:03) 
  - ARP Sender IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 02:02:00:00:00:03
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPDECLINE Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3551 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2684805005 (0xA006DF8D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 4 (DHCPDECLINE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDECLINE Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.9: Passed

>> DHCP-CLIENT-14.1
TEST_DESCRIPTION
The client SHOULD NOT request lease time parameters
TEST_REFERENCE
RFC 2131 Section 4.4.3 Page 39
'Initialization with an externally assigned network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <SERVER1-IP-POOL-0-0> with mask
        <SERVER1-IP-POOL-NETMASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to send DHCPINFORM Message through
        <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
- ANVL: Verify that received DHCPINFORM Message contains:
        - Message Option containing:
          - Type field is not set to 55 (Parameter Request List
             Option)
          - Length field is not set to 3
          - Value is not set to 51 (IP Address Lease Time Option)
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:134 mcast:0 errors:0 dropped:107
	TX packets:521 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:42148 (42 k)  TX bytes:94934 (94 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2984  lo0    0    
128.224.166.0/23                vxTarget                      UC       2743  gei2   0    
vxTarget                        vxTarget                      UH       13892 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       576576lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 54.0.0.2 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to send DHCPINFORM Message through <DIface-0>
to address 54.0.0.1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd sysvar set -co ipdhcpc.server "54.0.0.1" 
sysvar: ipdhcpc.server=54.0.0.1 ok
-> cmd sysvar get ipdhcpc.server
sysvar: ipdhcpc.server=54.0.0.1
-> cmd ipd reconfigure ipdhcpc 
ipd: reconfigure ipdhcpc ok
-> cmd ifconfig gei0 dhcp 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x611F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2010317103 (0x77D3012F)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

Message Option in received DHCPINFORM Message correctly contains Option Parameter Request List (55) Length : 4 
(not containing option Parameter Request List (55) Length : 3 )

Deleting IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet delete 54.0.0.2 up
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-14.1: Passed

>> DHCP-CLIENT-14.2
TEST_DESCRIPTION
The client then unicasts the DHCPINFORM to the DHCP server if it
knows the server's address
TEST_REFERENCE
RFC 2131 Section 4.4.3 Page 39
'Initialization with an externally assigned network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <SERVER1-IP-POOL-0-0> with mask
        <SERVER1-IP-POOL-NETMASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to send DHCPINFORM Message through
        <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
- ANVL: Verify that received DHCPINFORM Message contains:
        - Destination IP Address field is set to <SERVER1-IP-ADDRESS>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:134 mcast:0 errors:0 dropped:107
	TX packets:525 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:42148 (42 k)  TX bytes:95402 (95 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3008  lo0    0    
128.224.166.0/23                vxTarget                      UC       2746  gei2   0    
vxTarget                        vxTarget                      UH       14035 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       582826lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 54.0.0.2 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to send DHCPINFORM Message through <DIface-0>
to address 54.0.0.1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd sysvar set -co ipdhcpc.server "54.0.0.1" 
sysvar: ipdhcpc.server=54.0.0.1 ok
-> cmd sysvar get ipdhcpc.server
sysvar: ipdhcpc.server=54.0.0.1
-> cmd ipd reconfigure ipdhcpc 
ipd: reconfigure ipdhcpc ok
-> cmd ifconfig gei0 dhcp 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3266 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3956194283 (0xEBCEBBEB)
DHCP: secs                      = 5
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

! Destination IP Address field in received DHCPINFORM Message is incorrectly set.
! Expected Value = 54.0.0.1
! Received Value = 255.255.255.255

Deleting IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet delete 54.0.0.2 up
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-14.2: !FAILED!

>> DHCP-CLIENT-14.3
TEST_DESCRIPTION
otherwise it broadcasts the message to the limited (all 1s) broadcast
 address
TEST_REFERENCE
RFC 2131 Section 4.4.3 Page 39
'Initialization with an externally assigned network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <SERVER1-IP-POOL-0-0> with mask
        <SERVER1-IP-POOL-NETMASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to send DHCPINFORM Message through
        <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
- ANVL: Verify that received DHCPINFORM Message contains:
        - Destination IP Address field is set to
           <IP-BROADCAST-ADDRESS>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:134 mcast:0 errors:0 dropped:107
	TX packets:528 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:42148 (42 k)  TX bytes:95828 (95 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3032  lo0    0    
128.224.166.0/23                vxTarget                      UC       2750  gei2   0    
vxTarget                        vxTarget                      UH       14177 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       589020lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 54.0.0.2 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to send DHCPINFORM Message through <DIface-0>
to address 0.0.0.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 0.0.0.0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd sysvar set -co ipdhcpc.server "0.0.0.0" 
sysvar: ipdhcpc.server=0.0.0.0 ok
-> cmd sysvar get ipdhcpc.server
sysvar: ipdhcpc.server=0.0.0.0
-> cmd ipd reconfigure ipdhcpc 
ipd: reconfigure ipdhcpc ok
-> cmd ifconfig gei0 dhcp 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5A71 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 472474507 (0x1C29638B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

Destination IP Address field in received DHCPINFORM Message is correctly set to 255.255.255.255

Deleting IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
-> e
-> cmd ifconfig gei0 inet delete 54.0.0.2 up
xit
Au revoir!
Connection closed by foreign host.
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-14.3: Passed

>> DHCP-CLIENT-15.1
TEST_DESCRIPTION
If the client receives no response to DHCP messages sent to the IP
address of a known DHCP server, the DHCP client reverts to using the
IP broadcast address
(Note: In this test we check this feature for DHCPINFORM Message)
TEST_REFERENCE
RFC 2131 Section 4.4.4 Page 40 'Use of broadcast and unicast'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <SERVER1-IP-POOL-0-0> with mask
        <SERVER1-IP-POOL-NETMASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to send DHCPINFORM Message through
        <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
- ANVL: Verify that received DHCPINFORM Message contains:
        - Destination IP Address field is set to <SERVER1-IP-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
- ANVL: Verify that received DHCPINFORM Message contains:
        - Destination IP Address field is set to 0xffffffff
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:134 mcast:0 errors:0 dropped:107
	TX packets:530 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:42148 (42 k)  TX bytes:96212 (96 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3056  lo0    0    
128.224.166.0/23                vxTarget                      UC       2752  gei2   0    
vxTarget                        vxTarget                      UH       14322 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       595134lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 54.0.0.2 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to send DHCPINFORM Message through <DIface-0>
to address 54.0.0.1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd sysvar set -co ipdhcpc.server "54.0.0.1" 
sysvar: ipdhcpc.server=54.0.0.1 ok
-> cmd sysvar get ipdhcpc.server
sysvar: ipdhcpc.server=54.0.0.1
-> cmd ipd reconfigure ipdhcpc 
ipd: reconfigure ipdhcpc ok
-> cmd ifconfig gei0 dhcp 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xABAE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3827780171 (0xE4274A4B)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

! Destination IP Address field in received DHCPINFORM Message is incorrectly set.
! Expected Value = 54.0.0.1
! Received Value = 255.255.255.255

Deleting IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet delete 54.0.0.2 up
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-15.1: !INCONCLUSIVE!

>> DHCP-CLIENT-16.1
TEST_DESCRIPTION
At time T1 the client moves to RENEWING state and sends (via unicast)
a DHCPREQUEST message to the server to extend its lease
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 40 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to <SERVER1-IP-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:134 mcast:0 errors:0 dropped:107
	TX packets:535 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:42148 (42 k)  TX bytes:96722 (96 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3080  lo0    0    
128.224.166.0/23                vxTarget                      UC       2757  gei2   0    
vxTarget                        vxTarget                      UH       14464 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       601620lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x65C9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2783641922 (0xA5EB0142)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0071 (113)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D46 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x3CA0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2783641922 (0xA5EB0142)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x43F5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2783641922 (0xA5EB0142)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0072 (114)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D45 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x39A0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2783641922 (0xA5EB0142)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x2F66 (12134)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xDE3C (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xADC3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2783641922 (0xA5EB0142)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 54.0.0.1

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.1: Passed

>> DHCP-CLIENT-16.2
TEST_DESCRIPTION
If no DHCPACK arrives before time T2, the client moves to REBINDING
state and sends (via broadcast) a DHCPREQUEST message to extend its
lease
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<REMOTE-CLIENT1-T2>-<ParamToleranceTime>) for DUT
        to go to a state just before T2 expires
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to 0xffffffff
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:137 mcast:0 errors:0 dropped:109
	TX packets:545 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:42852 (42 k)  TX bytes:98342 (98 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3088  lo0    0    
128.224.166.0/23                vxTarget                      UC       2772  gei2   0    
vxTarget                        vxTarget                      UH       14537 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       605302lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE0B2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 618858337 (0x24E30761)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0073 (115)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D44 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xB789 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 618858337 (0x24E30761)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBEDE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 618858337 (0x24E30761)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0074 (116)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D43 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xB489 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 618858337 (0x24E30761)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 50.000 seconds) for DUT to go to a state just before T2 expires
xit
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5EAE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 618858337 (0x24E30761)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 255.255.255.255

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.2: Passed

>> DHCP-CLIENT-16.3
TEST_DESCRIPTION
T1 defaults to (0.5 * duration_of_lease).  T2 defaults to (0.875 *
duration_of_lease).  Times T1 and T2 SHOULD be chosen with some
random "fuzz" around a fixed value, to avoid synchronization of
client reacquisition
(Note: This test verifies the value of T1)
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<REMOTE-CLIENT1-T1>-<ParamToleranceTime>) for DUT
        to go to a state just before T1 expires
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that the time interval between
        sending of last DHCPACK Message and reception of last
         DHCPREQUEST Message
         is within the range of 
        (<REMOTE-CLIENT1-T1>  -  <ParamToleranceTime>) to
        (<REMOTE-CLIENT1-T1>  +  <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:140 mcast:0 errors:0 dropped:111
	TX packets:556 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:43556 (43 k)  TX bytes:100304 (100 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3096  lo0    0    
128.224.166.0/23                vxTarget                      UC       2790  gei2   0    
vxTarget                        vxTarget                      UH       14611 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       608924lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1688 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 629854436 (0x258AD0E4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0075 (117)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D42 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xED5E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 629854436 (0x258AD0E4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF4B3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 629854436 (0x258AD0E4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0076 (118)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D41 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xEA5E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 629854436 (0x258AD0E4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 20.000 seconds) for DUT to go to a state just before T1 expires
xit
Au revoir!
Connection closed by foreign host.

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xEE54 (61012)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x1F4E (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5E82 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 629854436 (0x258AD0E4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Time interval (45.508 sec) between
sending of last DHCPACK Message and reception of last DHCPREQUEST Message 
is correctly  is within the range of 
(<REMOTE-CLIENT1-T1>  -  <ParamToleranceTime>) to
        (<REMOTE-CLIENT1-T1>  +  <ParamToleranceTime>) second (20.000 to 60.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.3: Passed

>> DHCP-CLIENT-16.4
TEST_DESCRIPTION
T1 defaults to (0.5 * duration_of_lease).  T2 defaults to (0.875 *
duration_of_lease).  Times T1 and T2 SHOULD be chosen with some
random "fuzz" around a fixed value, to avoid synchronization of
client reacquisition
(Note: This test verifies the value of T2)
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<REMOTE-CLIENT1-T2>-<ParamToleranceTime>) for DUT
        to go to a state just before T2 expires
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that the time interval between
        sending of last DHCPACK Message and reception of last
         DHCPREQUEST Message
         is within the range of 
        (<REMOTE-CLIENT1-T2>  -  <ParamToleranceTime>) to
        (<REMOTE-CLIENT1-T2>  +  <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:143 mcast:0 errors:0 dropped:113
	TX packets:566 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:44260 (44 k)  TX bytes:101924 (101 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3104  lo0    0    
128.224.166.0/23                vxTarget                      UC       2801  gei2   0    
vxTarget                        vxTarget                      UH       14681 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       611506lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBD99 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 453194842 (0x1B03345A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0077 (119)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D40 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9470 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 453194842 (0x1B03345A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9BC5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 453194842 (0x1B03345A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0078 (120)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9170 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 453194842 (0x1B03345A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 50.000 seconds) for DUT to go to a state just before T2 expires
xit
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3B95 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 453194842 (0x1B03345A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Time interval (77.726 sec) between
sending of last DHCPACK Message and reception of last DHCPREQUEST Message 
is correctly  is within the range of 
(<REMOTE-CLIENT1-T2>  -  <ParamToleranceTime>) to
        (<REMOTE-CLIENT1-T2>  +  <ParamToleranceTime>) second (50.000 to 90.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.4: Passed

>> DHCP-CLIENT-16.5
TEST_DESCRIPTION
In both RENEWING and REBINDING states, if the client receives no
response to its DHCPREQUEST message, the client SHOULD wait one-half
of the remaining time until T2 (in RENEWING state) and one-half of
the remaining lease time (in REBINDING state), down to a minimum of
60 seconds, before retransmitting the DHCPREQUEST message.
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: Initialize server1 to offer IP Address Lease Time
         of <HIGH-LEASE-TIME> seconds to the DUT
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto (((<REMOTE-CLIENT1-T2> -
       <REMOTE-CLIENT1-T1>) / 2) + (2 * <ParamToleranceTime>)) second) on
       <DIface-0>
-  DUT: Sends 2 DHCPREQUEST Messages
- ANVL: Verify that the time interval between
        reception of last two DHCPREQUEST Messages
         is within the range of 
        (((<REMOTE-CLIENT1-T2> - <REMOTE-CLIENT1-T1>) / 2)  - 
         <ParamToleranceTime>) to
        (((<REMOTE-CLIENT1-T2> - <REMOTE-CLIENT1-T1>) / 2)  + 
         <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:146 mcast:0 errors:0 dropped:115
	TX packets:577 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:44964 (44 k)  TX bytes:103886 (103 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3112  lo0    0    
128.224.166.0/23                vxTarget                      UC       2816  gei2   0    
vxTarget                        vxTarget                      UH       14757 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       616072lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Initializing server1 to offer IP Address Lease Time
of <HIGH-LEASE-TIME> seconds to the DUT

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBA5A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4001915923 (0xEE886413)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0079 (121)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x102F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4001915923 (0xEE886413)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8A85 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4001915923 (0xEE886413)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007A (122)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0D2F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4001915923 (0xEE886413)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 155.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 105.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x06A7 (1703)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x06FC (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF453 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4001915923 (0xEE886413)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x61D5 (25045)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xABCD (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF453 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4001915923 (0xEE886413)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected 2 DHCPREQUEST Messages from <DIface-0>

Time interval (65.553 sec) between
reception of last two DHCPREQUEST Messages 
is correctly  is within the range of 
(((<REMOTE-CLIENT1-T2> - <REMOTE-CLIENT1-T1>) / 2)  -     <ParamToleranceTime>) to
        (((<REMOTE-CLIENT1-T2> - <REMOTE-CLIENT1-T1>)        (((<REMOTE   / 2)  +  <ParamToleranceTime>) second (45.000 to 85.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.5: Passed

>> DHCP-CLIENT-16.7
TEST_DESCRIPTION
If the lease expires before the client receives a DHCPACK, the client
moves to INIT state, MUST immediately stop any other network
processing and requests network initialization parameters as if the
client were uninitialized
(Note: In this test we verify that the DUT stops network processing
       after lease time expires)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<ParamLeaseTime>+<ParamToleranceTime>) for the
        lease on the DUT to expire (*INVALID*)
- ANVL:DHCP Server <SERVER-1> Sends ICMP Echo Message to DUT through
       <DIface-0> containing :
        - Destination Harware Address field set to
           <DIface-0-MAC-ADDRESS>
        - Destination IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Reply Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:149 mcast:0 errors:0 dropped:117
	TX packets:588 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:45668 (45 k)  TX bytes:105848 (105 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3120  lo0    0    
128.224.166.0/23                vxTarget                      UC       2848  gei2   0    
vxTarget                        vxTarget                      UH       14828 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       619390lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xADBA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 444220610 (0x1A7A44C2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007B (123)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8491 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 444220610 (0x1A7A44C2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8BE6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 444220610 (0x1A7A44C2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007C (124)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8191 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 444220610 (0x1A7A44C2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 100.000 seconds) for the lease on the DUT to expire (*INVALID*)
xit
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Server <SERVER-1> sending ICMP Echo Message to DUT through <DIface-0> containing :
  - Destination Harware Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - Destination IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007D (125)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0E52 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6B73 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x4141 (16705)
ICMP: Sequence Number  = 0x4141 (16705)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for no ICMP Echo Reply Message on <DIface-0>

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Reply Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.7: Passed

>> DHCP-CLIENT-16.8
TEST_DESCRIPTION
If the lease expires before the client receives a DHCPACK, the client
moves to INIT state, MUST immediately stop any other network
processing and requests network initialization parameters as if the
client were uninitialized
(Note: In this test we verify that the DUT requests network
 initialization 
       parameters after lease time expires)
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<ParamLeaseTime>+<ParamToleranceTime>) for the
        lease on the DUT to expire
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:153 mcast:0 errors:0 dropped:120
	TX packets:602 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:46432 (46 k)  TX bytes:108836 (108 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3128  lo0    0    
128.224.166.0/23                vxTarget                      UC       2876  gei2   0    
vxTarget                        vxTarget                      UH       14903 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       622040lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA21B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1937635165 (0x737DF75D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007E (126)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D39 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x78F2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1937635165 (0x737DF75D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8047 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1937635165 (0x737DF75D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007F (127)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D38 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x75F2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1937635165 (0x737DF75D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 100.000 seconds) for the lease on the DUT to expire
xit
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0EA5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1462013121 (0x57248CC1)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.8: Passed

>> DHCP-CLIENT-16.10
TEST_DESCRIPTION
If the client is given a new network address, it MUST NOT continue 
using the previous network address
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<ParamLeaseTime>-<ParamToleranceTime>) for the
        lease on the DUT to almost expire
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Destination IP Address field set to
           <SERVER1-IP-POOL-0-1>(*INVALID*)
        - 'yiaddr' field set to <SERVER1-IP-POOL-0-1>
- ANVL:DHCP Server <SERVER-1> Sends ICMP Echo Message to DUT through
       <DIface-0> containing :
        - Destination Harware Address field set to
           <DIface-0-MAC-ADDRESS>
        - Destination IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Reply Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:156 mcast:0 errors:0 dropped:122
	TX packets:614 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:47136 (47 k)  TX bytes:111140 (111 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3136  lo0    0    
128.224.166.0/23                vxTarget                      UC       2894  gei2   0    
vxTarget                        vxTarget                      UH       14975 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       626398lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       4     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0A70 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 58588937 (0x037DFF09)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0080 (128)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D37 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xE146 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 58588937 (0x037DFF09)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE89B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 58588937 (0x037DFF09)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0081 (129)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D36 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xDE46 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 58588937 (0x037DFF09)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 60.000 seconds) for the lease on the DUT to almost expire
xit
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Destination IP Address field set to     <SERVER1-IP-POOL-0-1>(*INVALID*) (54.0.0.3) 
  - 'yiaddr' field set to <SERVER1-IP-POOL-0-1> (54.0.0.3) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0082 (130)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D34 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.3
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xDE44 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 58588937 (0x037DFF09)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending ICMP Echo Message to DUT through <DIface-0> containing :
  - Destination Harware Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - Destination IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0083 (131)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0E4C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6B73 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x4141 (16705)
ICMP: Sequence Number  = 0x4141 (16705)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for no ICMP Echo Reply Message on <DIface-0>

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Reply Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.10: Passed
Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/DHCPCpostsuite.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -o ipdhcpc.rfc2131_init_delay "1"
sysvar: ipdhcpc.rfc2131_init_delay=1 ok
-> cmd sysvar set -o ipdhcpc.option.lease_time "0"
sysvar: ipdhcpc.option.lease_time=0 ok
-> cmd sysvar unset ipdhcpc.option.requested_options 
sysvar: 'ipdhcpc.option.requested_options' unset ok
-> cmd sysvar unset ipdhcpc.if.gei0.information_only 
sysvar: 'ipdhcpc.if.gei0.information_only' unset ok
-> cmd sysvar unset ipdhcpc.if.gei1.information_only 
sysvar: 'ipdhcpc.if.gei1.information_only' unset ok
-> cmd ipd kill ipdhcpc
ipd: kill ipdhcpc ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          83
Number of tests passed:       80
Number of tests failed:       1
Number of tests inconclusive: 2
